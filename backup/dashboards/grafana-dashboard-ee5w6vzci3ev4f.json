{
  "meta": {
    "type": "db",
    "canSave": true,
    "canEdit": true,
    "canAdmin": true,
    "canStar": true,
    "canDelete": true,
    "slug": "soziodemographische-daten-with-tiktok",
    "url": "/d/ee5w6vzci3ev4f/soziodemographische-daten-with-tiktok",
    "expires": "0001-01-01T00:00:00Z",
    "created": "2024-12-04T10:22:43Z",
    "updated": "2024-12-04T11:00:44Z",
    "updatedBy": "chams khoury dev",
    "createdBy": "chams khoury dev",
    "version": 6,
    "hasAcl": false,
    "isFolder": false,
    "folderId": 660,
    "folderUid": "folder-F9a5Uxn4k",
    "folderTitle": "Prototypes",
    "folderUrl": "/dashboards/f/folder-F9a5Uxn4k/prototypes",
    "provisioned": false,
    "provisionedExternalId": "",
    "annotationsPermissions": {
      "dashboard": {
        "canAdd": true,
        "canEdit": true,
        "canDelete": true
      },
      "organization": {
        "canAdd": true,
        "canEdit": true,
        "canDelete": true
      }
    }
  },
  "dashboard": {
    "annotations": {
      "list": [
        {
          "builtIn": 1,
          "datasource": {
            "type": "grafana",
            "uid": "-- Grafana --"
          },
          "enable": true,
          "hide": true,
          "iconColor": "rgba(0, 211, 255, 1)",
          "name": "Annotations & Alerts",
          "target": {
            "limit": 100,
            "matchAny": false,
            "tags": [],
            "type": "dashboard"
          },
          "type": "dashboard"
        }
      ]
    },
    "description": " Anpassungen September 2024",
    "editable": true,
    "fiscalYearStartMonth": 0,
    "graphTooltip": 0,
    "id": 1579,
    "links": [],
    "panels": [
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "#f5f5f500",
              "mode": "fixed"
            },
            "displayName": "Aktive Nutzer:innen",
            "mappings": [],
            "noValue": "Nur zur ARD-internen Verwendung!",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green",
                  "value": null
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": []
        },
        "gridPos": {
          "h": 1,
          "w": 6,
          "x": 18,
          "y": 0
        },
        "id": 92,
        "options": {
          "colorMode": "background",
          "graphMode": "none",
          "justifyMode": "center",
          "orientation": "auto",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [],
            "fields": "",
            "values": false
          },
          "showPercentChange": false,
          "text": {
            "titleSize": 2,
            "valueSize": 15
          },
          "textMode": "value_and_name",
          "wideLayout": true
        },
        "pluginVersion": "11.3.1",
        "targets": [
          {
            "dataset": "Quintly",
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [
                    {
                      "name": "total_video_10s_views",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            },
            "table": "facebookInsightsOwnVideos"
          }
        ],
        "title": "",
        "transformations": [
          {
            "id": "convertFieldType",
            "options": {
              "conversions": [
                {
                  "destinationType": "number",
                  "targetField": "Videostarts"
                }
              ],
              "fields": {}
            }
          },
          {
            "id": "organize",
            "options": {
              "excludeByName": {},
              "indexByName": {},
              "renameByName": {
                "Videostarts": "∑ Videostarts"
              }
            }
          }
        ],
        "transparent": true,
        "type": "stat"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 1
        },
        "id": 142,
        "panels": [],
        "title": "Hinweis",
        "type": "row"
      },
      {
        "fieldConfig": {
          "defaults": {},
          "overrides": []
        },
        "gridPos": {
          "h": 10,
          "w": 24,
          "x": 0,
          "y": 2
        },
        "id": 144,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "# Datenbasis\n\nFacebook: Ø Pot. Reichweite pro Tag\n\nInstagram: Follower\n\nYouTube: Videostarts von angemeldeten Usern. Bei YouTube angemeldet sind die User über ihr Google-Konto. Daten über nicht eingeloggte User bei YouTube liegen nicht vor.\n\nBei den Daten zu Alter und Geschlecht handelt es sich um eigene Angaben der User. Da nicht alle User diese Angaben machen, gibt es auch einen Anteil an Personen mit Status \"Unbekannt\".\n\nAuch Personen, die nicht Fans/Follower sind, können die Inhalte der Profile sehen.\n\n# Daten im Verlauf\n\nUm die Verteilung besser lesbar zu machen und die Anteile leichter auswerten zu können, hilft ein Klick auf den Filter „Skalierung“ -> „Ja“. Die Daten in den Verlaufsdiagrammen werden dann auf 100 % skaliert.",
          "mode": "markdown"
        },
        "pluginVersion": "11.3.1",
        "title": "",
        "type": "text"
      },
      {
        "collapsed": true,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 12
        },
        "id": 55,
        "panels": [
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 1,
              "x": 0,
              "y": 13
            },
            "id": 147,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<img width=\"40\" height=\"40\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAYAAAAUg66AAAAACXBIWXMAACxKAAAsSgF3enRNAAAbA0lEQVR4nO3dXWwU57kH8Gc+9strex0bnBRI1iYhDgWEQxMdKTgH5yLk3BAcqSRqdCIcnV6Ei5Pjikp1VUuARAWREsXtuWguKnVRj1q1qYRJrkIusm5CpaopGAElYPyxCdDEwY7X9u7O7s7OnAtDSgj2zno/nved+f+uWikJj5l5/37n/VRs2yYAAA4qdwEA4F0IIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADYIIABggwACADY6dwHALzFgRAtz9nNWijYX5u2HrCxFcletNiKiQsoOZC5ZoZX8d0MdakYLK1kiIv86dVINUFJrUK6oYTqvNSrHo4eDiQr+GCAhxbZt7hqghsZfzfSZX9k78lP2FvOG3bJwutDEWU/9Nm1WX6VM+1qVc/o9yvD6X4YGOeuB2kIAuVii3+jKf2n3Zq9a3dmEtWalPZlaC3WomUBUvR5Yp8Z9q5VY9GjwI+6aoDoQQC6SGDCi5rT9ijFu7UlfsKK5a5YrPrH9a1WzbpOaCK5X39ZblLfw6eYeCCDJJfqNruw1a3/mH1Y39+dUrdRv02ZD31XjgbXqG+gdyQ0BJKHEgBHNJqzBhb8VnpHls6paQh1qpv5x7b1AVO1Dz0g+CCCJjO3LHElfsHrnPjTv465FRI1P6p/XbVJjD/4q9FPuWsAZBJDgEv1GlzFuHZ77S2G7W8Z0qs2/VjUbn9BOBderA/hEExsCSFAT+40X0ucLP589aT7IXYvMmnbqY3WbtZ+1vxH8A3ct8G0IIMGMv5rpmz9VOOCVAeVaqd+mzTZs1w5hnZFYEECCQPDUBoJILAggZggeHggiMSCAmCT6ja6FM4UYxnh4Ne3Ux+of1XoxWM0DAVRjiQEjaly2jt14O7+Duxb4l1V7fMPBh9W9WEtUWwigGhrblzky8675Y0yni8m/VjWbd+mvYx1R7SCAaiDRb3TNvm++i3EeOdRv02abntZ34bOs+hBAVXb5pfTxmXfM3YU5W+GuBZzTGhW7+Vn9xMO/rXuOuxY3QwBVCXo97oDeUHUhgKpgbF/myJe/y/8EvR530BoVe/WLvtcwNlR5CKAKSgwY0fQ5a2jmnXwndy1Qec3P+kbqtqg9mCmrHARQhST6ja7pofxJrx+P4XahDjXT0uPbiU+yykAAVQA+ubwFn2SVgwAq06Xn03EsKvSmVXt8wx1/rOvmrkNmCKAyXHgmdQVbKbytaac+tum98EPcdcgKAbQCiQEjOv2n/EWM9wDRzXGh7/s2YnC6dLgZtUSJfqML4QO3y1yyQtN/yl9M9Btd3LXIBj2gEkzsN1744te532OwGe5Ga1Tse3/o/wFOX3QOPSCHED5QTGHOVr74de73E/uNF7hrkQUCyAGEDziFECoNAqgIhA+UCiHkHAJoGQgfWCmEkDMIoCUgfKBcCKHiMAt2F4l+o+ufv8r9GeEDlaA1KvZ39vn/HfvHvg09oDskBozo9FD+JMIHKqUwZyvTQ/mTiQEjyl2LaNADusPpR+bTWGQI1RDqUDPbPmmo465DJOgB3ebCM6krCB+olswlK3ThmdQV7jpEggC66dLz6Tg2lkK1zZ40H7z0fDrOXYcoEEC0eJ4PjtSAWrnxdn7H2L7MEe46ROD5MSDMeAEHzIwt8nQPCDNewAUzY4s8HUDpc9YQBp2BS+aSFUqfs4a46+Dk2QAa25c5gtsrgNvMO/lOL48HeXIMCOM+IBIvjwd5sgc0+775LsIHRFGYs5XZ9813uevg4LkAuvxS+jiuSwbRLJwuNF1+KX2cu45a81QAJfqNrpl3zN3cdQDczcw75m6vnSvtqQDCpxeIzIufYp4JoLF9mSP49ALRLZwuNHlpVswTs2CJASM6FctfyV2zdO5aAIrxr1XN1l7fQ164Z8wTPSDjsnUM4QOyyF2zdOOydYy7jlpwfQ8o0W90XX0t+yF3HdWgRRSq79SosVujYJtKgbZ//T4Jd2qkN7ljuMuctSk1Uvj6/2cnLTImLZqLF2hhpECFpDvf4XU/CTzp9rVBru8VLJwpxLhrqKRAVKWWHh+19voo3Klxl1MTepNCke6lX9XUSIGmYnmaHspTNmHVsLLquvnuuvreeVf3gMZfzfT9839zb3LXUQnNu320ps+/bEMEomTcpOuDOZo5kecupSK+89/+H63/ZWiQu45qcXUAnf3ewleyz3xFdui0IRb6xucVFJedtGi0N0PJYZO7lLLUb9Nmt/69/h7uOqrFtW/1+KuZPpnDJxBVafMHYdocDyN8ViDQptLmeJg2fxCmQFTev7+F04Wm8Vczfdx1VItre0Ay936ad/toQyzkmkFkbuasTaO9GWk/y9zcC5L3V8MyZO79tL8ZpI1DdQifCtKbFNo4VEftbwa5S1kRN/eCXNkDkrH3o0UU2hALUUuPj7sUV5uK5Wi8z5Bu6t6tvSDX9YAm9hsvyBg+W+JhhE8NtPb6aUs8TFpErh7mwulCkxuveHZdAKXPF37OXUOpNsRCnlnTI4Jwp0brB+X7HJPx3S7GVQGU6De6ZLvbq/3NIHo+DFp7/dKNCc2eNB9023EdrgogY9w6zF1DKRYXFwa4y/CsNX0Bat4tV/jL9o4X46pB6L+tm8/Lsuk0EFWpc6Qes13MzFmbRjoXpNnC4V+rmo9fbZArNZfhmh7Q2L7MEVnCh4iwzkcQepNC7RKNB+WuWbqbzgtyTQClL1i93DU4FdmhY0+XQFp6fBTZIc/zkOldL8YVAZQYMKJzH5r3cdfh1IYY7kIUjUzPZO5D8z633KgqT+wvI5uwpNkt3Lzbh71dZZqK5Sg1YlFqpECBNpUi3Ro19/jK+qQNtKnUvNsnzXaNm+/8c9x1lMsVg9CnH5lPy3LF8uYPwvj8WqHUSIEu9qTvOmBciZXkybhJ559KlVNizYQ61My2TxrquOsol/S/ihP9Rpcs4ROIqgifFUqNFOhcd2rJ2apC0qZPnkvT9NDKezCRbl2anfOZS1bIDWuC5PjbXkb2mrWfuwansOBw5S72pB3t3xrtzZA5u/JevUzPSKZ3fynSB1DmH1Y3dw1OtfbK83KLpJSjVgtJm2bK6AXJ9IzS5yz0gDglBoyoLBtPtYiC/V4rdPuB9M7++ZUvKgx3atJsVE2dLaySfTZM6gAyp+1XuGtwqh7hUzOlBtadZHpWMrWBu5E6gIxxaw93DU41dsvzUsuu3J6mTM9KpjZwN1IHUPqCJU33M4i1PytWaqCEO8v7u5bpWcnUBu5Gnr/pOyT6jS6Z9n5h8eHKtfT4KLzVWQgFoiq19vrL+vNkela5a5Yu83S8NA34Tvkv7V7uGrwgO2lRMm5SMl5Y/N9FrrmJ7NC/Xp0c6dYr1pg3xEJ0rju17FS8Flk8+9lrbrYFKW9QlTaAslflmX6XTXbSoi9iOZqKlX7TaHLYJBommrp5s/mtm1zX9PnLCqNwp0Zb4mEa7c1Q6uy3B5kDUZU2DtVVZKZRtlMKZG4L0m7FkGn7BRHRv33VKPyLXe1bRSt1u+v0UP4bM13hTq3iCwhPKcmK/veqSeZtGdIG0ClFrmsNttsR7hKWVOtbRGW47VWmACIi2m5LsnjpDuK+Actw6x1JHD49aNDH7fM1vcI4OWzSx+3z9OlBo2Z/ptvJ2iakDCDzK3sHdw2yy05aNNK5QJ8dyrLV8Nmh7OJxqJNyHIcqMlnbhJQBlJ+yt3DXILNk3KQznQt3HcyttdTZAp3pXKBkvHY9MDeStU1IGUDmDbuFuwZZTcVydP6p5aeza62QtOn8UymaiuW4S5GWrG1Cyml4WTagimYqlqPRlzMr+ne1iEKRbp3CnUufaZSMm5QaWVw3tJKAu1VbuQsJvUjWNiFdAMm++5dLMm6uKHxa9/qpuUd3NM19ezAl4yZNxfI0day0Xs3oy5mbCxmlezXZJQaMaPRwMMFdRymk+wQrzNnSn4Nba9lJiy72pEv6d1r3+umxiYYVH3Ma6V6can9sooFa95bWo7nYk8bA9ArI2DakCyArRZu5a5CN09MEiYjCWzXqPFNfsXU6gTaVNsRC1Hmm3vF+rkLSLjkwQc62IV0AFebth7hrkMmnBw3Hs12te/20OR6uysFp4U6NNsfDjntDqbMFrBMqkYxtQ7oAsrIk7pJiwWQnLcfrfO4/EKj6ba160+LNFfcfCDj65z87lMWnWAlkbBvSBVDuqtXGXYMsRnudDTrffyBADxys3fXEDxwMOg4hpz8DyNk2pAsgcCYZNx1tr2jd669p+NzywMGgo8+x5LCJRYouJl0AFVK2s1+dHnd9sPj0d3irRu2DtQ+fW9oHg44Gpp38LCBn25AugGQ6goNLdtJydKRGtcd8irk1JlTMzIk8xoIckLFtSBdAUJyTHkPrXr8Q1wSFOzVHn2JfYJuGKyGAXMjJ9cQPHBSnt+6klqlYdQ5JA14IIJfJTlpFj1Ft3Vve8aiVFmhTi/aCsgkLn2EuJM5bCBXhZMZIxOuHm3uK7/3CbJj7IIBcJhlfftXzrV3tomnp8RW9ErnYzwbyQQC5TLHPFBHD55ZiteETzJE27gJKgQBymWKLD8u9NbSaitVWy3OrZXVKSUp1LpC4byNUhcw9IChuux0Z4a6hFAggAGCDAPIY0S9HLOb2CwlBfgggjzFnxTmMfiVEWL0NlYMAAgA2CCAAYCNdAIU6VJxQVQaRVxOLXJsMZGwb0gWQFlb47hKWQGTH8lPZqRFxF/MVq63Yz+Z1MrYN6QIIlldsk6nIvYxitYm0gRYqQ7on6l+nTnLXILJI9/KzRIWk7ei4jlqbHsoXvTqo2M/mdTK2DekCSA1QkrsGkTlZTTwzJF4vyElNWCm9PBnbhnQBpDUoV7hrEFmgTaVAdPnHOnUsJ9TGzuykVfQK50BUxSdYETK2DemeqBqm89w1iM7JeT+fHhRnvNJJLSKeYSQaGduGdAGkNSrHuWsQ3b29xc9YnjqWE2JbQ2qkULT3Q+TsZ/I6GduGdAEUPRxMcNcgukCbSs27i/cYRnszrFszzFnb0cWDzbt9+PxyQMa2IeVTrd+mzXLXILo1fcV7DKmzBZro47t/faLP2b31Tn4Wr5O1TUgZQPoqZZq7BtFFunVHC/emjuXo04O1D6FPDxqOPr0iO3TMfjkga5uQMoB8rco57hpk4OTSPyKizw5laxpCnx406LNDzgbBnf4MXidrm5AygPR7lGHuGmQQaFPp/gPO7v/67FC26mNCt8Z8nIbP/QcCGPtxSNY2odi2nOfDnFKKLJsVzHY7wvZnj3QuOBprIVq8L35DLFTxc3dSIwUa7c2UVEfnSH1FayjFKUWuNX3b7SJXighK2l8vMu785bJxqK7olTe3pM4WaOTRBRrtzVRksWJ20qLR3gyNPOo8BLWIQhuH6sr+s71C5rYgbQAFoup17hpkEWhTS27QU8dy9HH7PI32Zla0d2x6KE+jvRn6uH3e0WDz7TYO1eHTqwQytwVppxcC69Q4ET3IXYcsIt06bfhNiEZfLu2X5dSxHE0dy319oWG4U/16VkpvUr4xZpSMm5QasSgZN4tuLF3Kht+EMOtVopttQUrSPmnfaiVGRP/FXYdMWm+uJi41hIgWd9HPnMjTzAlyPIhcqg2/CX1dIzh3sy1ISdpBaCKiv62bz+euWVKEKOcg9J2ScZMu9qRX3EupNC2i0JZ4WKgD52UZhPavVc3HrzZIu1FO6g/tuk2qdEvPRRDp1unRkXoKb+Vv8OGt2mItAoWPTGRvA1IHUHC9+jZ3DbIKtKnUOVLveJ1QNdx/IECdI/UYcC6D7G1A6ievtyhvcdcguwcOBumxiYaanrcc2aHTYxMN9MDBYM3+TLeSvQ1IPQZERHT2ewtfLZwuNHHXUYxIY0BLScZNuj6Yo5kT1TmytXm3j9b0+YWf5TJnbfrrPXPcZRQV6dZvbP4gvJq7jnJI3QMiIgp9V44pSBHO3ikm0q3TxqE6emyigdb8T6DoyYpOBKKL20Eem2igjUN1wocPkRzPiojIv075iLuGcon/NhQRWKu+QUQ93HUUI9OVyIE2ldoHg9Q+GKTs5OK6nmS8QNlJixZGCkvOnmkRheo7NQq0qRTp1ijSrWN8p4puvvtSk/4TjIjo9CPz6cwlS+ht05s/CEvx2x8WP0XPP5XiLmNZoQ41s+2TBun3q7ji11P949p73DUUI9Ih8LA8GZ6VDO+8E64IoEBU7eOuoRhDgpcaFsnwrGR4551wRQBFDwcTjU/qn3PXsZy5uBwDmyD+s2p8Uv9cxvOf78YVAUREVLdJjXHXsJwFSWZWQPxnJfq7XgpXDELfIvresM4z2HIgutTI4nlIopJ979edXNMDIiJqfEI7xV3DcqZi4t3JDt8k+jMS/R0vlasCKLheHeCuYTkrOdgLakv0ZyT6O14qVwVQ9Gjwo6ad+hh3HUvJJhYX9YGYknGTsglxZ8Cadupj0aNB6Vc/385VAUREVLdZ+xl3Dcu5Plja8aRQO6I/G9Hf7ZVw1SD0LaJvUH1sogFbFASTnbTo4/Z57jKWVL9Nm9369/p7uOuoNFe2gobt2iHuGpbj5D50qC3Rn4no7/RKubIHRCR+Lwh7w8Qh+t4vt/Z+iFzaAyIS/zdGtW8hBWdu3dYqMtHf5XK4tgdEJH4vqHm3DxfwMbvYk67aAWyV4ObeD5GLe0BE4v/mmDmRp+uD1bniBoq7PpgVOnyIxH+Hy+XqHhAR0YVnUldmT5pCX2CI+7BqbyqWW9H9aLXUtFMf2/Re+CHuOqrJ1T0gIqL6R7Ve7hqKGe8zpDkG1A1SIwUa7zO4yyhKhne3XK4PoOjR4Eer9viGuetYTiFp07nuFE3FxF4I5wZTsRyd604JcynjUlbt8Q27bdXz3bg+gIiIgg+re/1rVaH3QBSSNo2+nMGYUBVdH8zS6MsZ4cPHv1Y1gw+re7nrqAVPBFD0cDDRvEt/nbsOJyZ+ZNDFnjSm6CvInLXpYk+aJn4k/mcXEVHzLv11txw4VozrB6FvJ/q0/O0CUZU2xEJYrFimZNyk0d6M0JtMb9f4pP75lj+Hv8NdR614ogd0S9PT+i6tUZEicbMJi84/laLz3SkpDkkXTXbSovPdKTr/VEqa8NEaFbvxCW0Pdx215KkeEBHR5ZfSx7/8v7zw94jdSZZbRblV+3bXalr9n76hh39b9xx3HbXkuQAikutT7E6BqEotPT5q7fXheNebUiMFmorlaXooL01v505uX/G8FE/+Om16Wt+VuWL9uTBnK9y1lCqbsOj6L7J0/RfZr28ibezWKNimfuOIj3CnRnqTdD/ekm4/yC07aZExadFcvLDsTa2y0BoVu+lpfRd3HRw82QMiIhrblzny+Vu5fu46AO57xX/0wV+FfspdBwfPBhAR0cXd6TMz7+Q7uesA72p+1jey8UTdo9x1cPHULNid6raoPaEOVewNQeBaoQ41U7dFlW5CpJI8HUDRw8FES49vpyxT8+AeWqNit/T4dnplweFSPB1ARIt7xVa/6HuNuw7wltUv+l7zwl6vYjw9BnS7S8+n4zfezu/grgPcb9Ue33DHH+u6uesQAQLoNjKcHQRy88IZP6VAAN3h9CPz6cwlK8RdB7hPqEPNbPukAWfw3sbzY0B3avm+byNmxqDSQh1qpuX7vo3cdYgGAXQHzIxBpWHGa2kIoLuIHg1+dO8P/T9ACEG5tEbFvveH/h9gxuvuEEBLaH8j+AeEEJTjVvi0vxH8A3ctokIALQMhBCuF8HEGAVQEQghKhfBxDgHkAEIInEL4lAYB5BBCCIpB+JQOCxFLlOg3uqaH8iexWBFuF+pQMy09vp2Y7SoNAmgFEgNGdPpP+YsIISD61yJDrPMpHQKoDNg7BtjbVR6MAZVh03vhh0S/9hmqZ9Ue3zDCpzwIoDJ1/LGu+75X/EcxOO0dWqNi3/eK/yiO1CgfPsEqBIPT3oDB5spCAFVQYsCIps9ZQzjo3p2an/WN1G1RezDYXDkIoCoY25c58uXv8j+R8d4x+DatUbFXv+h7zatX51QTAqhKEv1G1+z75ruy3sAKi+q3abNNT+u78MlVHQigKrv8Uvr4zDvmbvSG5KI1Knbzs/oJr93VXmsIoBpI9Btd838tHE/GzVXctUBx4a3ajXv+Q38OvZ7qQwDV0Ni+zJGZd80f565ZOnct8G3+tarZvEt/HWM9tYMAqrHEgBE1LlvHcAWQWFbt8Q0HH1b3YoarthBATBL9RtfCmUIMWzl4Ne3Ux+of1XrxucUDAcRs/NVM3/ypwgHMltVW/TZttmG7dmj9L0OD3LV4GQJIEAii2kDwiAUBJBgEUXUgeMSEABLUxH7jhfT5ws8xRlSepp36WN1m7Wc4pVBMCCDBJfqNLmPcOjz3l8J2TN8741+rmo1PaKeC69UBDC6LDQEkkbF9mSPpC1bv3Ifmfdy1iKjxSf3zuk1qDOt45IEAklBiwIhmPrGOpM8Xerx+/EeoQ800Pa0PaRHlp1jDIx8EkOQS/UZX9pq1P3fV7vLKVo/wVu1G3Rb1o8Ba9Q18YskNAeQiiQEjak7brxjj1p70BSvqljEj/1rVrNukJoLr1bf1FuUt9HTcAwHkYol+oyv/pd2bvWp1ZxPWGlk+10IdaiYQVa8H1qlx32olhl6OeyGAPGb81Uyf+ZW9Iz9lbzFv2C3c643qt2mz+ipl2teqnNPvUYaxTsdbEEBAiQEjWpizn7NStLkwbz9kZSmSu2q1EREVUnZgpT2nUIea0cJKlojIv06dVAOU1BqUK2qYzmuNynF8SgECCADY4FoeAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGCDAAIANgggAGDz/wCkcRvbU/GdAAAAAElFTkSuQmCC\" /> ",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 11,
              "x": 1,
              "y": 13
            },
            "id": 149,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<font size=\"6\" style=\"color:rgb(214,41,118);\">Instagram Follower</font><font size=\"6\">  ${Profil} </font>",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 13,
              "x": 0,
              "y": 136
            },
            "id": 208,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<font size=\"6\">Instagram Follower Verteilung</font>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "description": "",
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "stichtag"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 2,
              "w": 3,
              "x": 0,
              "y": 138
            },
            "id": 155,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "Stichtag: ${stichtag_ig}",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "description": "berechneter Wert",
            "fieldConfig": {
              "defaults": {
                "color": {
                  "mode": "thresholds"
                },
                "mappings": [],
                "thresholds": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "red",
                      "value": 80
                    }
                  ]
                }
              },
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "average_age"
                  },
                  "properties": [
                    {
                      "id": "unit",
                      "value": "locale"
                    },
                    {
                      "id": "displayName",
                      "value": "Ø Alter"
                    },
                    {
                      "id": "decimals",
                      "value": 0
                    }
                  ]
                }
              ]
            },
            "gridPos": {
              "h": 2,
              "w": 2,
              "x": 11,
              "y": 138
            },
            "id": 139,
            "options": {
              "colorMode": "value",
              "graphMode": "area",
              "justifyMode": "center",
              "orientation": "auto",
              "percentChangeColorMode": "standard",
              "reduceOptions": {
                "calcs": [
                  "lastNotNull"
                ],
                "fields": "/.*/",
                "values": false
              },
              "showPercentChange": false,
              "text": {
                "titleSize": 16
              },
              "textMode": "value_and_name",
              "wideLayout": true
            },
            "pluginVersion": "11.3.1",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "WITH WeightedAverages AS (\n  SELECT\n    CASE SUBSTR(audienceGenderAndAge.id, STRPOS(audienceGenderAndAge.id, '-') + 1)\n      WHEN \"13-17\" THEN 15\n      WHEN \"18-24\" THEN 21\n      WHEN \"25-34\" THEN 29.5\n      WHEN \"35-44\" THEN 39.5\n      WHEN \"45-54\" THEN 49.5\n      WHEN \"55-64\" THEN 59.5\n      ELSE 69.5\n    END AS mid_age,\n    SUM(audienceGenderAndAge.followers) AS age_bucket_followers\n  FROM\n    `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n    UNNEST(audienceGenderAndAge) AS audienceGenderAndAge\n  WHERE $Condition \n  AND profileId = $instagramId \n  GROUP BY\n    audienceGenderAndAge.id\n)\n\nSELECT \n  SUM(mid_age * age_bucket_followers / (SELECT SUM(age_bucket_followers) FROM WeightedAverages)) as average_age\nFROM\n  WeightedAverages\n",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "stat"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 12,
              "x": 6,
              "y": 140
            },
            "id": 210,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Instagram Follower nach Geschlecht und Alter in Tausend</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "male_total_followers"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "female_total_followers"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "unknown_total_followers"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Unbekannt"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Gesamt"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "ageBucket"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 15,
              "w": 24,
              "x": 0,
              "y": 142
            },
            "id": 186,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "code",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const formatNumberGerman = (number) => {\n  return Math.round(number).toLocaleString('de-DE'); // Formats number to German locale\n};\n\nconst FONTSIZE = 12;\nconst BARWIDTH = 32;\n\nconst colorMapping = {\n  \"male\": \"#1F60C4\",\n  \"female\": \"rgb(196, 22, 42)\",\n  \"unknown\": \"#FFD700\",\n  \"total\": \"rgb(180, 180, 180)\"  // Color for Gesamt\n};\n\nconst seriesData = context.panel.data.series.map((s) => {\n  const ageBuckets = s.fields.find((f) => f.name === 'ageBucket').values.buffer || s.fields.find((f) => f.name === 'ageBucket').values;\n  const totalFollowers = s.fields.find((f) => f.name === 'Gesamt').values.buffer || s.fields.find((f) => f.name === 'Gesamt').values;\n  const maleFollowers = s.fields.find((f) => f.name === 'male_total_followers').values.buffer || s.fields.find((f) => f.name === 'male_total_followers').values;\n  const femaleFollowers = s.fields.find((f) => f.name === 'female_total_followers').values.buffer || s.fields.find((f) => f.name === 'female_total_followers').values;\n  const unknownFollowers = s.fields.find((f) => f.name === 'unknown_total_followers').values.buffer || s.fields.find((f) => f.name === 'unknown_total_followers').values;\n\n  return ageBuckets.map((age, i) => ({\n    ageBucket: age,\n    male: maleFollowers[i],\n    female: femaleFollowers[i],\n    unknown: unknownFollowers[i],\n    total: totalFollowers[i]\n  }));\n})[0];  // Extract the first series (for simplicity in this example)\n\n// Convert the seriesData to be compatible with the column chart\nconst categories = seriesData.map(d => d.ageBucket);\n\nconst totalSeries = categories.map((_, i) => seriesData[i].total);\nconst maleSeries = categories.map((_, i) => seriesData[i].male);\nconst femaleSeries = categories.map((_, i) => seriesData[i].female);\nconst unknownSeries = categories.map((_, i) => seriesData[i].unknown);\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: {\n      type: 'shadow',\n    },\n    formatter: (params) => {\n      let tooltipContent = `${params[0].name}<br/>`;\n      params.forEach((item) => {\n        tooltipContent += `<b>${item.seriesName}:</b> ${formatNumberGerman(item.value)}<br/>`;\n      });\n      return tooltipContent;\n    },\n    textStyle: {\n      fontWeight: 'bold', fontSize: FONTSIZE\n    }\n  },\n  legend: {\n    data: ['Gesamt', 'Männlich', 'Weiblich', 'Unbekannt'],\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n    top: 'bottom'\n  },\n  toolbox: {\n    show: false,\n    feature: {\n      saveAsImage: {},\n    },\n  },\n  grid: {\n    left: '3%',  // Adjust this value to move the chart more to the left\n    right: '3%', // Adjust space on the right side if necessary\n    top: '3%',\n    bottom: '10%',\n    containLabel: true\n  },\n  xAxis: {\n    type: 'category',\n    data: categories.reverse(),  // Reverse for young to old sorting\n    axisLine: {\n      lineStyle: {\n        color: 'rgba(128, 128, 128, .9)',\n      },\n    },\n    axisLabel: {\n      rotate: 45,  // Rotate for better readability\n      show: true\n    },\n    axisTick: {\n      show: false,  // Hide axis ticks\n    }\n  },\n  yAxis: {\n    type: 'value',\n    axisLine: {\n      show: false,  // Hide the y-axis line\n    },\n    axisLabel: {\n      show: true,  // Show y-axis labels (numbers)\n      formatter: function (value) {\n        return value.toLocaleString('de-DE');\n      }\n    },\n    axisTick: {\n      show: false,  // Hide axis ticks\n    }\n  },\n  series: [\n    {\n      name: 'Gesamt',\n      type: 'bar',\n      data: totalSeries.reverse(),  // Reverse for correct order within age groups\n      itemStyle: {\n        color: colorMapping['total'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: 'rgb(180, 180, 180)',\n          fontWeight: 'bold', fontSize: FONTSIZE\n        }\n      }\n    },\n    {\n      name: 'Männlich',\n      type: 'bar',\n      data: maleSeries.reverse(),  // Reverse for correct order within age groups\n      itemStyle: {\n        color: colorMapping['male'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: '#1F60C4',\n          fontWeight: 'bold', fontSize: FONTSIZE,\n        }\n      }\n    },\n    {\n      name: 'Weiblich',\n      type: 'bar',\n      data: femaleSeries.reverse(),  // Reverse for correct order within age groups\n      itemStyle: {\n        color: colorMapping['female'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: 'rgb(196, 22, 42)',\n          fontWeight: 'bold', fontSize: FONTSIZE\n        }\n      }\n    },\n    {\n      name: 'Unbekannt',\n      type: 'bar',\n      data: unknownSeries.reverse(),  // Reverse for correct order within age groups\n      itemStyle: {\n        color: colorMapping['unknown'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: '#FFD700',\n          fontWeight: 'bold', fontSize: FONTSIZE\n        }\n      }\n    }\n  ]\n};\n",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "WITH UniqueData AS (\n    SELECT DISTINCT\n      audienceGenderAndAge.id AS id,\n      audienceGenderAndAge.name AS name,\n      audienceGenderAndAge.followers AS followers,\n      last_update,\n      profileId\n    FROM\n      `Quintly.instagramInsights`,\n      UNNEST(audienceGenderAndAge) AS audienceGenderAndAge\n    WHERE time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n  UNNEST(audienceGenderAndAge) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.followers IS NOT NULL AND profileId = $instagramId)\n)\n\nSELECT\n  SUBSTR(UniqueData.id, STRPOS(UniqueData.id, '-') + 1) AS ageBucket,\n  ROUND(SUM(UniqueData.followers)/1000,1) as Gesamt,\n  ROUND(SUM(CASE WHEN CONTAINS_SUBSTR(UniqueData.name,'male') AND NOT CONTAINS_SUBSTR(UniqueData.name,'female') THEN UniqueData.followers ELSE 0 END)/1000,1) AS male_total_followers,\n  ROUND(SUM(CASE WHEN CONTAINS_SUBSTR(UniqueData.name,'female') THEN UniqueData.followers ELSE 0 END)/1000,1) AS female_total_followers,\n  ROUND(SUM(CASE WHEN CONTAINS_SUBSTR(UniqueData.name,'unknown') THEN UniqueData.followers ELSE 0 END)/1000,1) AS unknown_total_followers\nFROM UniqueData\nWHERE last_update = (SELECT MAX(last_update) from `ndr-code-bi-dashboard.Quintly.instagramInsights` WHERE time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n  UNNEST(audienceGenderAndAge) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.followers IS NOT NULL AND profileId = $instagramId) and profileId = $instagramId)\nAND UniqueData.profileId = $instagramId\nGROUP BY ageBucket\nORDER BY CAST(LEFT(ageBucket,2) AS INT) DESC\n",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transformations": [
              {
                "id": "organize",
                "options": {
                  "excludeByName": {
                    "ageBucket": false
                  },
                  "includeByName": {},
                  "indexByName": {},
                  "renameByName": {
                    "ageBucket": ""
                  }
                }
              }
            ],
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 8,
              "x": 0,
              "y": 157
            },
            "id": 211,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Instagram Follower nach Alter (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 8,
              "x": 8,
              "y": 157
            },
            "id": 212,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Instagram Follower nach Geschlecht (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 8,
              "x": 16,
              "y": 157
            },
            "id": 213,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Instagram Follower nach Geschlecht ohne Unbekannt (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "35-44"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "45-54"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "55-64"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "25-34"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "65+"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "18-24"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "13-17"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 11,
              "w": 8,
              "x": 0,
              "y": 159
            },
            "id": 187,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "visual",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.map((s) => {\n  const sData = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n  const sTime = s.fields.find((f) => f.type === 'time').values.buffer || s.fields.find((f) => f.type === 'time').values;\n  \n  return {\n    name: s.refId,\n    type: 'line',\n    showSymbol: false,\n    areaStyle: {\n      opacity: 0.1,\n    },\n    lineStyle: {\n      width: 1,\n    },\n    data: sData.map((d, i) => [sTime[i], d.toFixed(2)]),\n  };\n});\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startValue = params.batch[0]?.startValue;\n  const endValue = params.batch[0]?.endValue;\n  locationService.partial({ from: startValue, to: endValue });\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n  },\n  legend: {\n    left: '0',\n    bottom: '0',\n    data: context.panel.data.series.map((s) => s.refId),\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  toolbox: {\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 24,\n    containLabel: true,\n  },\n  series,\n};",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "const colorMapping = {\n  \"13-17\": \"#b877d9\",\n  \"18-24\": \"#37872d\",\n  \"25-34\": \"#ff780a\",\n  \"35-44\": \"#f2495c\",\n  \"45-54\": \"#8ab8ff\",\n  \"55-64\": \"#73bf69\",\n  \"65+\": \"#f2cc0c\"\n};\n\n// Helper function to format numbers to German format\nfunction formatNumberGerman(value) {\n  return Math.round(value).toLocaleString('de-DE');\n}\n\n// Retrieve data from the context\nconst seriesData = context.panel.data.series.map((s) => {\n  const categories = s.fields.find((f) => f.name === 'ageBucket').values.buffer || s.fields.find((f) => f.name === 'ageBucket').values;\n  const percentages = s.fields.find((f) => f.name === 'relative_percentage').values.buffer || s.fields.find((f) => f.name === 'relative_percentage').values;\n\n  return categories.map((category, i) => ({\n    name: category,\n    value: percentages[i],\n    itemStyle: {\n      color: colorMapping[category] || '#cccccc'  // Default to grey if no match\n    }\n  }));\n})[0];  // Since it's a pie chart, we take the first series.\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'item',\n    formatter: (params) => {\n      return `<b>${params.name}</b><br/>${formatNumberGerman(params.value)} (${formatNumberGerman(params.percent)}%)`;\n    },\n    textStyle: {\n      fontWeight: 'bold',\n      fontSize: 14,  // Increase font size for tooltip text\n    }\n  },\n  legend: {\n    orient: 'vertical',  // Arrange the legend items vertically\n    left: 'right',       // Position the legend on the right side\n    top: 'center',       // Center the legend vertically\n    formatter: (name) => {\n      const item = seriesData.find(d => d.name === name);\n      return `${name}`;  // Just the name without values or percentages\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  series: [\n    {\n      name: 'Instagram Followers by Age',\n      type: 'pie',\n      radius: ['0%', '70%'],  // Creates a donut shape\n      data: seriesData,\n      label: {\n        show: true,\n        formatter: (params) => `${formatNumberGerman(params.percent)}%`,   // Display only the rounded percentage\n        position: 'inside',  // Position the label inside the donut slices\n        textStyle: {\n         // color: '#fff',     // White color for better contrast\n          fontWeight: 'bold',\n        }\n      },\n      labelLine: {\n        show: false  // Hides the line connecting labels to slices since the labels are inside\n      },\n      emphasis: {\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)',\n        },\n      },\n    },\n  ],\n};\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "WITH UniqueData AS (\n    SELECT DISTINCT\n      audienceGenderAndAge.id AS id,\n      audienceGenderAndAge.name AS name,\n      audienceGenderAndAge.followers AS followers,\n      last_update,\n      profileId\n    FROM\n      `Quintly.instagramInsights`,\n      UNNEST(audienceGenderAndAge) AS audienceGenderAndAge\n    WHERE time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n  UNNEST(audienceGenderAndAge) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.followers IS NOT NULL AND profileId = $instagramId)\n)\n\n, TotalFollowers AS (\n  SELECT\n    SUM(followers) as total_followers\n  FROM UniqueData\n  WHERE last_update = (SELECT MAX(last_update) from `ndr-code-bi-dashboard.Quintly.instagramInsights` WHERE time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n  UNNEST(audienceGenderAndAge) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.followers IS NOT NULL AND profileId = $instagramId) and profileId = $instagramId)\n  AND profileId = $instagramId\n)\n\nSELECT\n  ageBucket,\n  Gesamt*100 / 1 AS relative_percentage\nFROM (\n  SELECT\n    SUBSTR(id, STRPOS(id, '-') + 1) AS ageBucket,\n    SUM(followers) as Gesamt\n  FROM UniqueData\n  WHERE last_update = (SELECT MAX(last_update) from `ndr-code-bi-dashboard.Quintly.instagramInsights` WHERE time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n  UNNEST(audienceGenderAndAge) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.followers IS NOT NULL AND profileId = $instagramId) and profileId = $instagramId)\n  AND profileId = $instagramId\n  GROUP BY ageBucket\n) subquery\nCROSS JOIN TotalFollowers\nORDER BY ageBucket;\n",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Unbekannt "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich "
                  },
                  "properties": []
                },
                {
                  "__systemRef": "hideSeriesFrom",
                  "matcher": {
                    "id": "byNames",
                    "options": {
                      "mode": "exclude",
                      "names": [
                        "percentage",
                        "Female ",
                        "Male "
                      ],
                      "prefix": "All except:",
                      "readOnly": true
                    }
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 11,
              "w": 8,
              "x": 8,
              "y": 159
            },
            "id": 209,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "visual",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.map((s) => {\n  const sData = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n  const sTime = s.fields.find((f) => f.type === 'time').values.buffer || s.fields.find((f) => f.type === 'time').values;\n  \n  return {\n    name: s.refId,\n    type: 'line',\n    showSymbol: false,\n    areaStyle: {\n      opacity: 0.1,\n    },\n    lineStyle: {\n      width: 1,\n    },\n    data: sData.map((d, i) => [sTime[i], d.toFixed(2)]),\n  };\n});\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startValue = params.batch[0]?.startValue;\n  const endValue = params.batch[0]?.endValue;\n  locationService.partial({ from: startValue, to: endValue });\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n  },\n  legend: {\n    left: '0',\n    bottom: '0',\n    data: context.panel.data.series.map((s) => s.refId),\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  toolbox: {\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 24,\n    containLabel: true,\n  },\n  series,\n};",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "const colorMapping = {\n  \"Männlich\": \"#1F60C4\",\n  \"Weiblich\": \"rgb(196, 22, 42)\",\n  \"Unbekannt\": \"#FFD700\"  // Assuming 'dark-red' as rgb(196, 22, 42) \n};\n\n// Helper function to format numbers to German format\nfunction formatNumberGerman(value) {\n  return Math.round(value).toLocaleString('de-DE');\n}\n\n// Retrieve data from the context\nconst seriesData = context.panel.data.series.map((s) => {\n  const categories = s.fields.find((f) => f.name === 'gender').values.buffer || s.fields.find((f) => f.name === 'gender').values;\n  const percentages = s.fields.find((f) => f.name === 'percentage').values.buffer || s.fields.find((f) => f.name === 'percentage').values;\n\n  return categories.map((category, i) => ({\n    name: category,\n    value: percentages[i],\n    itemStyle: {\n      color: colorMapping[category] || '#cccccc'  // Default to grey if no match\n    }\n  }));\n})[0];  // Since it's a pie chart, we take the first series.\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'item',\n    formatter: (params) => {\n      return `<b>${params.name}</b><br/>${formatNumberGerman(params.value)} (${formatNumberGerman(params.percent)}%)`;\n    },\n    textStyle: {\n      fontWeight: 'bold',\n      fontSize: 14,  // Increase font size for tooltip text\n    }\n  },\n  legend: {\n    orient: 'vertical',  // Arrange the legend items vertically\n    left: 'right',       // Position the legend on the right side\n    top: 'center',       // Center the legend vertically\n    formatter: (name) => {\n      return `${name}`;  // Just the name without values or percentages\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n      fontSize: 12  // Increase font size for legend labels\n    }\n  },\n  series: [\n    {\n      name: 'Instagram Followers by Gender',\n      type: 'pie',\n      radius: ['0%', '70%'],  // Creates a donut shape\n      data: seriesData,\n      label: {\n        show: true,\n        formatter: (params) => `${formatNumberGerman(params.percent)}%`,   // Display only the rounded percentage\n        position: 'inside',  // Position the label inside the donut slices\n        textStyle: {\n          //color: '#fff',     // White color for better contrast\n          fontWeight: 'bold',\n        }\n      },\n      labelLine: {\n        show: false  // Hides the line connecting labels to slices since the labels are inside\n      },\n      emphasis: {\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)',\n        },\n      },\n    },\n  ],\n};\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "WITH UniqueData AS (\n    SELECT DISTINCT\n      audienceGenderAndAge.id AS id,\n      audienceGenderAndAge.name AS name,\n      audienceGenderAndAge.followers AS followers,\n      last_update,\n      profileId\n    FROM\n      `Quintly.instagramInsights`,\n      UNNEST(audienceGenderAndAge) AS audienceGenderAndAge\n    WHERE time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n  UNNEST(audienceGenderAndAge) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.followers IS NOT NULL AND profileId = $instagramId)\n)\n\nSELECT\n  CASE \n    WHEN CONTAINS_SUBSTR(name,'male') AND NOT CONTAINS_SUBSTR(name,'female') THEN 'Männlich'\n    WHEN CONTAINS_SUBSTR(name,'female') THEN 'Weiblich'\n    WHEN CONTAINS_SUBSTR(name,'unknown') THEN 'Unbekannt'\n  END AS gender,\n  SUM(followers) / 1 as percentage --(SELECT SUM(followers) FROM UniqueData WHERE last_update = (SELECT MAX(last_update) from `ndr-code-bi-dashboard.Quintly.instagramInsights` WHERE $FollowerCondition and profileId = $instagramId  AND NOT CONTAINS_SUBSTR(name,'unknown') ) AND profileId = $instagramId) AS percentage\nFROM UniqueData\nWHERE last_update = (SELECT MAX(last_update) from `ndr-code-bi-dashboard.Quintly.instagramInsights` WHERE time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n  UNNEST(audienceGenderAndAge) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.followers IS NOT NULL AND profileId = $instagramId) and profileId = $instagramId)\nAND profileId = $instagramId\nGROUP BY gender;\n",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Unbekannt "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich "
                  },
                  "properties": []
                },
                {
                  "__systemRef": "hideSeriesFrom",
                  "matcher": {
                    "id": "byNames",
                    "options": {
                      "mode": "exclude",
                      "names": [
                        "percentage",
                        "Female ",
                        "Male "
                      ],
                      "prefix": "All except:",
                      "readOnly": true
                    }
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 11,
              "w": 8,
              "x": 16,
              "y": 159
            },
            "id": 189,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "visual",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.map((s) => {\n  const sData = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n  const sTime = s.fields.find((f) => f.type === 'time').values.buffer || s.fields.find((f) => f.type === 'time').values;\n  \n  return {\n    name: s.refId,\n    type: 'line',\n    showSymbol: false,\n    areaStyle: {\n      opacity: 0.1,\n    },\n    lineStyle: {\n      width: 1,\n    },\n    data: sData.map((d, i) => [sTime[i], d.toFixed(2)]),\n  };\n});\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startValue = params.batch[0]?.startValue;\n  const endValue = params.batch[0]?.endValue;\n  locationService.partial({ from: startValue, to: endValue });\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n  },\n  legend: {\n    left: '0',\n    bottom: '0',\n    data: context.panel.data.series.map((s) => s.refId),\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  toolbox: {\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 24,\n    containLabel: true,\n  },\n  series,\n};",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "const colorMapping = {\n  \"Männlich\": \"#1F60C4\",\n  \"Weiblich\": \"rgb(196, 22, 42) \"  // Assuming 'dark-red' as rgb(196, 22, 42) \n};\n\n// Helper function to format numbers to German format\nfunction formatNumberGerman(value) {\n  return Math.round(value).toLocaleString('de-DE');\n}\n\n// Retrieve data from the context\nconst seriesData = context.panel.data.series.map((s) => {\n  const categories = s.fields.find((f) => f.name === 'gender').values.buffer || s.fields.find((f) => f.name === 'gender').values;\n  const percentages = s.fields.find((f) => f.name === 'percentage').values.buffer || s.fields.find((f) => f.name === 'percentage').values;\n\n  return categories.map((category, i) => ({\n    name: category,\n    value: percentages[i],\n    itemStyle: {\n      color: colorMapping[category] || '#cccccc'  // Default to grey if no match\n    }\n  }));\n})[0];  // Since it's a pie chart, we take the first series.\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'item',\n    formatter: (params) => {\n      return `<b>${params.name}</b><br/>${formatNumberGerman(params.value)} (${formatNumberGerman(params.percent)}%)`;\n    },\n    textStyle: {\n      fontWeight: 'bold',\n      fontSize: 14,  // Increase font size for tooltip text\n    }\n  },\n  legend: {\n    orient: 'vertical',  // Arrange the legend items vertically\n    left: 'right',       // Position the legend on the right side\n    top: 'center',       // Center the legend vertically\n    formatter: (name) => {\n      return `${name}`;  // Just the name without values or percentages\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n      fontSize: 12  // Increase font size for legend labels\n    }\n  },\n  series: [\n    {\n      name: 'Instagram Followers by Gender',\n      type: 'pie',\n      radius: ['0%', '70%'],  // Creates a donut shape\n      data: seriesData,\n      label: {\n        show: true,\n        formatter: (params) => `${formatNumberGerman(params.percent)}%`,   // Display only the rounded percentage\n        position: 'inside',  // Position the label inside the donut slices\n        textStyle: {\n          //color: '#fff',     // White color for better contrast\n          fontWeight: 'bold',\n        }\n      },\n      labelLine: {\n        show: false  // Hides the line connecting labels to slices since the labels are inside\n      },\n      emphasis: {\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)',\n        },\n      },\n    },\n  ],\n};\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "WITH UniqueData AS (\n    SELECT DISTINCT\n      audienceGenderAndAge.id AS id,\n      audienceGenderAndAge.name AS name,\n      audienceGenderAndAge.followers AS followers,\n      last_update,\n      profileId\n    FROM\n      `Quintly.instagramInsights`,\n      UNNEST(audienceGenderAndAge) AS audienceGenderAndAge\n    WHERE time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n  UNNEST(audienceGenderAndAge) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.followers IS NOT NULL AND profileId = $instagramId)\n)\n\nSELECT\n  CASE \n    WHEN CONTAINS_SUBSTR(name,'male') AND NOT CONTAINS_SUBSTR(name,'female') THEN 'Männlich'\n    WHEN CONTAINS_SUBSTR(name,'female') THEN 'Weiblich'\n  END AS gender,\n  SUM(followers) / 1 as percentage --(SELECT SUM(followers) FROM UniqueData WHERE last_update = (SELECT MAX(last_update) from `ndr-code-bi-dashboard.Quintly.instagramInsights` WHERE $FollowerCondition and profileId = $instagramId  AND NOT CONTAINS_SUBSTR(name,'unknown') ) AND profileId = $instagramId) AS percentage\nFROM UniqueData\nWHERE last_update = (SELECT MAX(last_update) from `ndr-code-bi-dashboard.Quintly.instagramInsights` WHERE time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.instagramInsights`,\n  UNNEST(audienceGenderAndAge) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.followers IS NOT NULL AND profileId = $instagramId) and profileId = $instagramId)\nAND profileId = $instagramId\nAND NOT CONTAINS_SUBSTR(name,'unknown') -- Diese Bedingung ignoriert den \"Unbekannt\" Anteil\nGROUP BY gender;\n",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          }
        ],
        "title": "Instagram Follower | $Row_Name",
        "type": "row"
      },
      {
        "collapsed": true,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 13
        },
        "id": 123,
        "panels": [
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 1,
              "x": 0,
              "y": 14
            },
            "id": 151,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<img width=\"45\" height=\"45\" src=\"data:image/png;base64,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\" /> ",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 23,
              "x": 1,
              "y": 14
            },
            "id": 153,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<font size=\"6\" style=\"color:rgb(255, 0, 0);\">YouTube</font><font size=\"6\">  ${Profil} </font>",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 12,
              "x": 0,
              "y": 16
            },
            "id": 214,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<font size=\"6\">YouTube Views Verteilung im Zeitraum</font>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "description": "",
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "nutzungszeitraum"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 0,
              "y": 18
            },
            "id": 156,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "Zeitraum: ${nutzungszeitraum_yt}",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "description": "",
            "fieldConfig": {
              "defaults": {
                "color": {
                  "mode": "thresholds"
                },
                "displayName": "Summe der betrachteten Views:",
                "mappings": [],
                "thresholds": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-red",
                      "value": null
                    },
                    {
                      "color": "text",
                      "value": 100000
                    }
                  ]
                },
                "unit": "locale"
              },
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 4,
              "x": 6,
              "y": 18
            },
            "id": 157,
            "options": {
              "colorMode": "value",
              "graphMode": "none",
              "justifyMode": "auto",
              "orientation": "auto",
              "percentChangeColorMode": "standard",
              "reduceOptions": {
                "calcs": [
                  "lastNotNull"
                ],
                "fields": "",
                "values": false
              },
              "showPercentChange": false,
              "text": {
                "titleSize": 16
              },
              "textMode": "auto",
              "wideLayout": true
            },
            "pluginVersion": "11.3.1",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT SUM(Gesamt)\r\n\r\nFROM\r\n(SELECT ageBucket, (male_total_followers + female_total_followers + unknown_total_followers) as Gesamt, male_total_followers , female_total_followers , unknown_total_followers FROM( SELECT\r\n  SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')) AS ageBucket,\r\n  SUM(CASE WHEN NOT(CONTAINS_SUBSTR(audienceGenderAndAge.gender,'female')) AND CONTAINS_SUBSTR(audienceGenderAndAge.gender,'male')  THEN audienceGenderAndAge.value ELSE 0 END) AS male_total_followers,\r\n  SUM(CASE WHEN CONTAINS_SUBSTR(audienceGenderAndAge.gender,'female')THEN audienceGenderAndAge.value ELSE 0 END) AS female_total_followers,\r\n  SUM(CASE WHEN CONTAINS_SUBSTR(audienceGenderAndAge.gender,'genderUserSpecified') THEN audienceGenderAndAge.value ELSE 0 END) AS unknown_total_followers\r\n\r\nFROM\r\n  `ndr-code-bi-dashboard.Quintly.youtubeAnalytics`,\r\n  UNNEST(viewsByAgeAndGender) AS audienceGenderAndAge\r\nWHERE\r\n  $Condition \r\n  AND profileId = $youtubeId \r\nGROUP BY\r\n  ageBucket\r\n  ORDER BY ageBucket)\r\n)\r\n\r\n",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "stat"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "description": "berechneter Wert",
            "fieldConfig": {
              "defaults": {
                "color": {
                  "mode": "thresholds"
                },
                "mappings": [],
                "thresholds": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "red",
                      "value": 80
                    }
                  ]
                }
              },
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "average_age"
                  },
                  "properties": [
                    {
                      "id": "unit",
                      "value": "locale"
                    },
                    {
                      "id": "displayName",
                      "value": "Ø Alter"
                    },
                    {
                      "id": "decimals",
                      "value": 0
                    }
                  ]
                }
              ]
            },
            "gridPos": {
              "h": 2,
              "w": 2,
              "x": 11,
              "y": 18
            },
            "id": 140,
            "options": {
              "colorMode": "value",
              "graphMode": "area",
              "justifyMode": "center",
              "orientation": "auto",
              "percentChangeColorMode": "standard",
              "reduceOptions": {
                "calcs": [
                  "lastNotNull"
                ],
                "fields": "/.*/",
                "values": false
              },
              "showPercentChange": false,
              "text": {
                "titleSize": 16
              },
              "textMode": "value_and_name",
              "wideLayout": true
            },
            "pluginVersion": "11.3.1",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT SUM(average_per_age) as average_age\nFROM(\nSELECT\n  CASE TRIM(SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')))\n  WHEN \"13-17\" THEN 15 *  ROUND(SUM(audienceGenderAndAge.value) / SUM(SUM(audienceGenderAndAge.value)) OVER(), 2)\n  WHEN \"18-24\" THEN 21 *  ROUND(SUM(audienceGenderAndAge.value) / SUM(SUM(audienceGenderAndAge.value)) OVER(), 2)\n  WHEN \"25-34\" THEN 29.5 *  ROUND(SUM(audienceGenderAndAge.value) / SUM(SUM(audienceGenderAndAge.value)) OVER(), 2)\n  WHEN \"35-44\" THEN 39.5 *  ROUND(SUM(audienceGenderAndAge.value) / SUM(SUM(audienceGenderAndAge.value)) OVER(), 2)\n  WHEN \"45-54\" THEN 49.5 *  ROUND(SUM(audienceGenderAndAge.value) / SUM(SUM(audienceGenderAndAge.value)) OVER(), 2)\n  WHEN \"55-64\" THEN 59.5 *  ROUND(SUM(audienceGenderAndAge.value) / SUM(SUM(audienceGenderAndAge.value)) OVER(), 2)\n  ELSE 69.5 * ROUND(SUM(audienceGenderAndAge.value) / SUM(SUM(audienceGenderAndAge.value)) OVER(), 2)\n  END as average_per_age\nFROM\n  `ndr-code-bi-dashboard.Quintly.youtubeAnalytics`,\n  UNNEST(viewsByAgeAndGender) AS audienceGenderAndAge\n  WHERE $Condition  \n  AND profileId = $youtubeId \nGROUP BY\n  audienceGenderAndAge.ageGroupName\n\n)",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "stat"
          },
          {
            "description": "",
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 3,
              "w": 6,
              "x": 6,
              "y": 20
            },
            "id": 158,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "Bei Views < 100.000: Die Datenbasis der soziodemografischen Daten ist hier sehr klein. Die Daten müssen daher mit Vorsicht betrachtet werden und sollten nicht für weitere Ableitungen verwendet werden! ",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 12,
              "x": 6,
              "y": 23
            },
            "id": 215,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">YouTube Views nach Geschlecht und Alter in Tausend</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "male_total_followers"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "female_total_followers"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "unknown_total_followers"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Unbekannt"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Gesamt"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "ageBucket"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 14,
              "w": 24,
              "x": 0,
              "y": 25
            },
            "id": 190,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "visual",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.map((s) => {\n  const sData = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n  const sTime = s.fields.find((f) => f.type === 'time').values.buffer || s.fields.find((f) => f.type === 'time').values;\n  \n  return {\n    name: s.refId,\n    type: 'line',\n    showSymbol: false,\n    areaStyle: {\n      opacity: 0.1,\n    },\n    lineStyle: {\n      width: 1,\n    },\n    data: sData.map((d, i) => [sTime[i], d.toFixed(2)]),\n  };\n});\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startValue = params.batch[0]?.startValue;\n  const endValue = params.batch[0]?.endValue;\n  locationService.partial({ from: startValue, to: endValue });\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n  },\n  legend: {\n    left: '0',\n    bottom: '0',\n    data: context.panel.data.series.map((s) => s.refId),\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  toolbox: {\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 24,\n    containLabel: true,\n  },\n  series,\n};",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "const formatNumberGerman = (number) => {\n  return Math.round(number).toLocaleString('de-DE'); // Formats number to German locale\n};\n\nconst FONTSIZE = 12;\nconst BARWIDTH = 37;\n\nconst colorMapping = {\n  \"male\": \"#1F60C4\",     // Blue\n  \"female\": \"rgb(196, 22, 42)\",   // Dark Red\n  \"unknown\": \"#FFD700\",  // Gold\n  \"total\": \"rgb(180, 180, 180)\"  // Light Grey for Gesamt\n};\n\n// Data processing based on the query results\nconst seriesData = context.panel.data.series.map((s) => {\n  const ageBuckets = s.fields.find((f) => f.name === 'ageBucket').values.buffer || s.fields.find((f) => f.name === 'ageBucket').values;\n  const totalFollowers = s.fields.find((f) => f.name === 'Gesamt').values.buffer || s.fields.find((f) => f.name === 'Gesamt').values;\n  const maleFollowers = s.fields.find((f) => f.name === 'male_total_followers').values.buffer || s.fields.find((f) => f.name === 'male_total_followers').values;\n  const femaleFollowers = s.fields.find((f) => f.name === 'female_total_followers').values.buffer || s.fields.find((f) => f.name === 'female_total_followers').values;\n  const unknownFollowers = s.fields.find((f) => f.name === 'unknown_total_followers').values.buffer || s.fields.find((f) => f.name === 'unknown_total_followers').values;\n\n  return ageBuckets.map((age, i) => ({\n    ageBucket: age,\n    male: maleFollowers[i],\n    female: femaleFollowers[i],\n    unknown: unknownFollowers[i],\n    total: totalFollowers[i]\n  }));\n})[0];  // Extract the first series for simplicity\n\n// Extracting the data for each category\nconst categories = seriesData.map(d => d.ageBucket);\n\nconst maleSeries = seriesData.map(d => d.male);\nconst femaleSeries = seriesData.map(d => d.female);\nconst unknownSeries = seriesData.map(d => d.unknown);\nconst totalSeries = seriesData.map(d => d.total);\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: {\n      type: 'shadow'\n    },\n    formatter: (params) => {\n      let tooltipContent = `${params[0].name}<br/>`;\n      params.forEach((item) => {\n        tooltipContent += `<b>${item.seriesName}:</b> ${formatNumberGerman(item.value)}<br/>`;\n      });\n      return tooltipContent;\n    },\n    textStyle: {\n      fontWeight: 'bold', fontSize: FONTSIZE\n    }\n  },\n  legend: {\n    data: ['Männlich', 'Weiblich', 'Unbekannt', 'Gesamt'],\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n    top: 'bottom'\n  },\n  toolbox: {\n    show: false,\n    feature: {\n      saveAsImage: {},\n    },\n  },\n  grid: {\n    left: '3%',  // Adjust this value to move the chart more to the left\n    right: '3%', // Adjust space on the right side if necessary\n    top: '3%',\n    bottom: '10%',\n    containLabel: true\n  },\n  xAxis: {\n    type: 'category',\n    data: categories.reverse(),  // Reverse for sorting from young to old\n    axisLine: {\n      lineStyle: {\n        color: 'rgba(128, 128, 128, .9)',\n      },\n    },\n    axisLabel: {\n      rotate: 45,  // Rotate for better readability\n      show: true\n    },\n    axisTick: {\n      show: false,  // Hide axis ticks\n    }\n  },\n  yAxis: {\n    type: 'value',\n    axisLine: {\n      show: false,  // Hide the y-axis line\n    },\n    axisLabel: {\n      show: true,  // Show y-axis labels (numbers)\n      formatter: function (value) {\n        return value.toLocaleString('de-DE');\n      }\n    },\n    axisTick: {\n      show: false,  // Hide axis ticks\n    }\n  },\n  series: [\n    {\n      name: 'Gesamt',\n      type: 'bar',\n      data: totalSeries.reverse(),  // Reverse to match category order\n      itemStyle: {\n        color: colorMapping['total'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: 'rgb(180, 180, 180)',\n          fontWeight: 'bold', fontSize: FONTSIZE\n        }\n      }\n    },\n    {\n      name: 'Männlich',\n      type: 'bar',\n      data: maleSeries.reverse(),  // Reverse to match category order\n      itemStyle: {\n        color: colorMapping['male'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: '#1F60C4',\n          fontWeight: 'bold', fontSize: FONTSIZE,\n        }\n      }\n    },\n    {\n      name: 'Weiblich',\n      type: 'bar',\n      data: femaleSeries.reverse(),  // Reverse to match category order\n      itemStyle: {\n        color: colorMapping['female'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: 'rgb(196, 22, 42)',\n          fontWeight: 'bold', fontSize: FONTSIZE\n        }\n      }\n    },\n    {\n      name: 'Unbekannt',\n      type: 'bar',\n      data: unknownSeries.reverse(),  // Reverse to match category order\n      itemStyle: {\n        color: colorMapping['unknown'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: '#FFD700',\n          fontWeight: 'bold', fontSize: FONTSIZE\n        }\n      }\n    }\n  ]\n};\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT ageBucket, ROUND((male_total_followers + female_total_followers + unknown_total_followers)/1000,1) as Gesamt, ROUND(male_total_followers/1000,1) as male_total_followers , ROUND(female_total_followers/1000,1) as female_total_followers , ROUND(unknown_total_followers/1000,1) as unknown_total_followers FROM( SELECT\n  SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')) AS ageBucket,\n  SUM(CASE WHEN NOT(CONTAINS_SUBSTR(audienceGenderAndAge.gender,'female')) AND CONTAINS_SUBSTR(audienceGenderAndAge.gender,'male')  THEN audienceGenderAndAge.value ELSE 0 END) AS male_total_followers,\n  SUM(CASE WHEN CONTAINS_SUBSTR(audienceGenderAndAge.gender,'female')THEN audienceGenderAndAge.value ELSE 0 END) AS female_total_followers,\n  SUM(CASE WHEN CONTAINS_SUBSTR(audienceGenderAndAge.gender,'genderUserSpecified') THEN audienceGenderAndAge.value ELSE 0 END) AS unknown_total_followers\n\nFROM\n  `ndr-code-bi-dashboard.Quintly.youtubeAnalytics`,\n  UNNEST(viewsByAgeAndGender) AS audienceGenderAndAge\nWHERE\n  $Condition \n  AND profileId = $youtubeId \nGROUP BY\n  ageBucket\n  ORDER BY ageBucket)\n  ORDER BY CAST(LEFT(ageBucket,2) AS INT) DESC\n",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 7,
              "x": 0,
              "y": 99
            },
            "id": 216,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">YouTube Views nach Alter (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 7,
              "x": 7,
              "y": 99
            },
            "id": 217,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">YouTube Views nach Geschlecht (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "35-44 "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "45-54 "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "55-64 "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "25-34 "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "65+ "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "18-24 "
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "13-17 "
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 11,
              "w": 7,
              "x": 0,
              "y": 101
            },
            "id": 191,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "code",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const colorMapping = {\n  \"13-17\": \"#b877d9\",\n  \"18-24\": \"#37872d\",\n  \"25-34\": \"#ff780a\",\n  \"35-44\": \"#f2495c\",\n  \"45-54\": \"#8ab8ff\",\n  \"55-64\": \"#73bf69\",\n  \"65+\": \"#f2cc0c\"\n};\n\n// Helper function to format numbers to German format\nfunction formatNumberGerman(value) {\n  return Math.round(value).toLocaleString('de-DE');\n}\n\n// Retrieve data from the context\nconst seriesData = context.panel.data.series.map((s) => {\n  const categories = s.fields.find((f) => f.name === 'ageBucket').values.buffer || s.fields.find((f) => f.name === 'ageBucket').values;\n  const percentages = s.fields.find((f) => f.name === 'percentage').values.buffer || s.fields.find((f) => f.name === 'percentage').values;\n\n  return categories.map((category, i) => ({\n    name: category,\n    value: percentages[i],\n    itemStyle: {\n      color: colorMapping[category] || '#cccccc'  // Default to grey if no match\n    }\n  }));\n})[0];  // Since it's a pie chart, we take the first series.\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'item',\n    formatter: (params) => {\n      return `<b>${params.name}</b><br/>${formatNumberGerman(params.value)} (${formatNumberGerman(params.percent)}%)`;\n    },\n    textStyle: {\n      fontWeight: 'bold',\n      fontSize: 14,  // Increase font size for tooltip text\n    }\n  },\n  legend: {\n    orient: 'vertical',  // Arrange the legend items vertically\n    left: 'right',       // Position the legend on the right side\n    top: 'center',       // Center the legend vertically\n    formatter: (name) => {\n      const item = seriesData.find(d => d.name === name);\n      return `${name}`;  // Just the name without values or percentages\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  series: [\n    {\n      name: 'YouTube Views by Age Group',\n      type: 'pie',\n      radius: ['0%', '70%'],  // Creates a donut shape\n      data: seriesData,\n      label: {\n        show: true,\n        formatter: (params) => `${formatNumberGerman(params.percent)}%`,   // Display only the rounded percentage\n        position: 'inside',  // Position the label inside the donut slices\n        textStyle: {\n         // color: '#fff',     // White color for better contrast\n          fontWeight: 'bold',\n        }\n      },\n      labelLine: {\n        show: false  // Hides the line connecting labels to slices since the labels are inside\n      },\n      emphasis: {\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)',\n        },\n      },\n    },\n  ],\n};\n",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\n    REPLACE(SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')), \" \", \"\") AS ageBucket,\n  ROUND(SUM(audienceGenderAndAge.value)) AS percentage\nFROM\n  `ndr-code-bi-dashboard.Quintly.youtubeAnalytics`,\n  UNNEST(viewsByAgeAndGender) AS audienceGenderAndAge\n    WHERE\n  $Condition \n  AND profileId = $youtubeId \nGROUP BY\n  ageBucket\n\n  ORDER by ageBucket",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Unknow"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 11,
              "w": 7,
              "x": 7,
              "y": 101
            },
            "id": 192,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "visual",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.map((s) => {\n  const sData = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n  const sTime = s.fields.find((f) => f.type === 'time').values.buffer || s.fields.find((f) => f.type === 'time').values;\n  \n  return {\n    name: s.refId,\n    type: 'line',\n    showSymbol: false,\n    areaStyle: {\n      opacity: 0.1,\n    },\n    lineStyle: {\n      width: 1,\n    },\n    data: sData.map((d, i) => [sTime[i], d.toFixed(2)]),\n  };\n});\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startValue = params.batch[0]?.startValue;\n  const endValue = params.batch[0]?.endValue;\n  locationService.partial({ from: startValue, to: endValue });\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n  },\n  legend: {\n    left: '0',\n    bottom: '0',\n    data: context.panel.data.series.map((s) => s.refId),\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  toolbox: {\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 24,\n    containLabel: true,\n  },\n  series,\n};",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "const colorMapping = {\n  \"Männlich\": \"#1F60C4\",\n  \"Weiblich\": \"rgb(196, 22, 42) \",  // Dark red\n  \"Unbekannt\": \"#FFD700\"  // Gold\n};\n\n// Helper function to format numbers to German format\nfunction formatNumberGerman(value) {\n  return Math.round(value).toLocaleString('de-DE');\n}\n\n// Retrieve data from the context\nconst seriesData = context.panel.data.series.map((s) => {\n  const categories = s.fields.find((f) => f.name === 'gender').values.buffer || s.fields.find((f) => f.name === 'gender').values;\n  const percentages = s.fields.find((f) => f.name === 'percentage').values.buffer || s.fields.find((f) => f.name === 'percentage').values;\n\n  return categories.map((category, i) => ({\n    name: category,\n    value: percentages[i],\n    itemStyle: {\n      color: colorMapping[category] || '#cccccc'  // Default to grey if no match\n    }\n  }));\n})[0];  // Since it's a pie chart, we take the first series.\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'item',\n    formatter: (params) => {\n      return `<b>${params.name}</b><br/>${formatNumberGerman(params.value)} (${formatNumberGerman(params.percent)}%)`;\n    },\n    textStyle: {\n      fontWeight: 'bold',\n      fontSize: 14,  // Increase font size for tooltip text\n    }\n  },\n  legend: {\n    orient: 'vertical',  // Arrange the legend items vertically\n    left: 'right',       // Position the legend on the right side\n    top: 'center',       // Center the legend vertically\n    formatter: (name) => {\n      return `${name}`;  // Just the name without values or percentages\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  series: [\n    {\n      name: 'YouTube Views by Gender',\n      type: 'pie',\n      radius: ['0%', '70%'],  // Creates a donut shape\n      data: seriesData,\n      label: {\n        show: true,\n        formatter: (params) => `${formatNumberGerman(params.percent)}%`,   // Display only the rounded percentage\n        position: 'inside',  // Position the label inside the donut slices\n        textStyle: {\n          //color: '#fff',     // White color for better contrast\n          fontWeight: 'bold',\n        }\n      },\n      labelLine: {\n        show: false  // Hides the line connecting labels to slices since the labels are inside\n      },\n      emphasis: {\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)',\n        },\n      },\n    },\n  ],\n};\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\nCASE \n    WHEN gender = 'male' THEN 'Männlich'\n    WHEN gender = 'female' THEN 'Weiblich'\n    WHEN gender = 'genderUserSpecified' THEN 'Unbekannt' END as gender,\n  ROUND(SUM(audienceGenderAndAge.value)) AS percentage\nFROM\n  `ndr-code-bi-dashboard.Quintly.youtubeAnalytics`,\n  UNNEST(viewsByAgeAndGender) AS audienceGenderAndAge\n  WHERE\n  $Condition \n  AND profileId = $youtubeId \nGROUP BY\n  gender\nORDER BY\n  gender;",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 13,
              "x": 0,
              "y": 112
            },
            "id": 218,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<font size=\"6\">YouTube Views im Zeitverlauf</font>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "description": "",
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "nutzungszeitraum"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 3,
              "w": 13,
              "x": 0,
              "y": 114
            },
            "id": 219,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "Zeitraum: ${nutzungszeitraum_yt}",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 12,
              "x": 0,
              "y": 117
            },
            "id": 220,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">YouTube Views nach Alter (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 12,
              "x": 12,
              "y": 117
            },
            "id": 221,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">YouTube Views nach Geschlecht (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 16,
              "w": 12,
              "x": 0,
              "y": 119
            },
            "id": 181,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto",
                "height": 600
              },
              "editorMode": "code",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.flatMap((s) => {\n  const timeValues = s.fields.find((f) => f.name === 'Monat').values;\n  const scailing = s.fields.find((f) => f.name === 'scailing').values[0];\n  const reach_13_17 = s.fields.find((f) => f.name === 'reach_13_17_r').values;\n  const reach_18_24 = s.fields.find((f) => f.name === 'reach_18_24_r').values;\n  const reach_25_34 = s.fields.find((f) => f.name === 'reach_25_34_r').values;\n  const reach_35_44 = s.fields.find((f) => f.name === 'reach_35_44_r').values;\n  const reach_45_54 = s.fields.find((f) => f.name === 'reach_45_54_r').values;\n  const reach_55_64 = s.fields.find((f) => f.name === 'reach_55_64_r').values;\n  const reach_65 = s.fields.find((f) => f.name === 'reach_65_r').values;\n  const total = s.fields.find((f) => f.name === 'total').values;\n\n  // Prepare each series data\n  const scaledData = timeValues.map((_, index) => {\n    const totalValue = total[index];\n\n    // If scailing is \"ja\", calculate percentages, otherwise use raw values\n    const reach_13_17_value = scailing === 'Ja' && totalValue > 0 ? (reach_13_17[index] / totalValue) * 100 : reach_13_17[index];\n    const reach_18_24_value = scailing === 'Ja' && totalValue > 0 ? (reach_18_24[index] / totalValue) * 100 : reach_18_24[index];\n    const reach_25_34_value = scailing === 'Ja' && totalValue > 0 ? (reach_25_34[index] / totalValue) * 100 : reach_25_34[index];\n    const reach_35_44_value = scailing === 'Ja' && totalValue > 0 ? (reach_35_44[index] / totalValue) * 100 : reach_35_44[index];\n    const reach_45_54_value = scailing === 'Ja' && totalValue > 0 ? (reach_45_54[index] / totalValue) * 100 : reach_45_54[index];\n    const reach_55_64_value = scailing === 'Ja' && totalValue > 0 ? (reach_55_64[index] / totalValue) * 100 : reach_55_64[index];\n    const reach_65_value = scailing === 'Ja' && totalValue > 0 ? (reach_65[index] / totalValue) * 100 : reach_65[index];\n\n    const reach_13_17_percentage = (reach_13_17[index] / totalValue) * 100;\n    const reach_18_24_percentage = (reach_18_24[index] / totalValue) * 100;\n    const reach_25_34_percentage = (reach_25_34[index] / totalValue) * 100;\n    const reach_35_44_percentage = (reach_35_44[index] / totalValue) * 100;\n    const reach_45_54_percentage = (reach_45_54[index] / totalValue) * 100;\n    const reach_55_64_percentage = (reach_55_64[index] / totalValue) * 100;\n    const reach_65_percentage = (reach_65[index] / totalValue) * 100;\n\n\n    // Format percentages in German style\n    const formatGerman = (value) => new Intl.NumberFormat('de-DE', { minimumFractionDigits: 1, maximumFractionDigits: 1 }).format(value);\n\n    return {\n      time: timeValues[index],\n      reach_13_17: reach_13_17_value,\n      reach_18_24: reach_18_24_value,\n      reach_25_34: reach_25_34_value,\n      reach_35_44: reach_35_44_value,\n      reach_45_54: reach_45_54_value,\n      reach_55_64: reach_55_64_value,\n      reach_65: reach_65_value,\n\n      reach_13_17_raw: reach_13_17[index],\n      reach_18_24_raw: reach_18_24[index],\n      reach_25_34_raw: reach_25_34[index],\n      reach_35_44_raw: reach_35_44[index],\n      reach_45_54_raw: reach_45_54[index],\n      reach_55_64_raw: reach_55_64[index],\n      reach_65_raw: reach_65[index],\n\n      reach_13_17_percentage: formatGerman(reach_13_17_percentage) + '%',\n      reach_18_24_percentage: formatGerman(reach_18_24_percentage) + '%',\n      reach_25_34_percentage: formatGerman(reach_25_34_percentage) + '%',\n      reach_35_44_percentage: formatGerman(reach_35_44_percentage) + '%',\n      reach_45_54_percentage: formatGerman(reach_45_54_percentage) + '%',\n      reach_55_64_percentage: formatGerman(reach_55_64_percentage) + '%',\n      reach_65_percentage: formatGerman(reach_65_percentage) + '%'\n    };\n  });\n\n  // Build the series array\n  return [\n    {\n      name: '13-17',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(184, 119, 217)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_13_17_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_13_17, item.reach_13_17_raw])  // Include raw values\n    },\n    {\n      name: '18-24',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(55, 135, 45)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_18_24_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_18_24, item.reach_18_24_raw])  // Include raw values\n    },\n    {\n      name: '25-34',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(255, 120, 10)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_25_34_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_25_34, item.reach_25_34_raw])  // Include raw values\n    },\n    {\n      name: '35-44',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(242, 73, 92)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_35_44_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_35_44, item.reach_35_44_raw])  // Include raw values\n    },\n    {\n      name: '45-54',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(138, 184, 255)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_45_54_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_45_54, item.reach_45_54_raw])  // Include raw values\n    },\n    {\n      name: '55-64',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(115, 191, 105)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_55_64_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_55_64, item.reach_55_64_raw])  // Include raw values\n    },\n    {\n      name: '65+',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(242, 204, 12)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_65_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_65, item.reach_65_raw])  // Include raw values\n    }\n  ];\n});\n\n\nconst showYAxis = context.panel.data.series.some((s) => s.fields.find((f) => f.name === 'scailing').values[0] === 'Ja') ? false : true;\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startIndex = params.batch[0]?.startValue;\n  const endIndex = params.batch[0]?.endValue;\n\n  const timeValues = context.panel.data.series[0].fields.find((f) => f.name === 'date').values;\n\n  const startTime = new Date(timeValues[startIndex]).getTime();\n  const endTime = new Date(timeValues[endIndex]).getTime();\n\n  if (!isNaN(startTime) && !isNaN(endTime)) {\n    context.grafana.locationService.partial({ from: startTime, to: endTime });\n  } else {\n    console.error(\"Invalid start or end time:\", { startIndex, endIndex });\n  }\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: {\n      type: 'cross'\n    },\n    formatter: function (params) {\n      let tooltipText = params[0].name + '<br/>';\n      params.forEach(param => {\n        const rawValue = param.data[2]; // Get the unscaled value (third element in the array [time, scaled value, raw value])\n        // Format the raw value in German style\n        const formattedValue = new Intl.NumberFormat('de-DE').format(rawValue);\n        console.info(\"f\")\n\n        tooltipText += param.marker + param.seriesName + ': ' + formattedValue + '<br/>';\n      });\n      return tooltipText;\n    }\n  },\n  legend: {\n    orient: 'horizontal',\n    left: 'center',\n    bottom: '0%',\n    itemGap: 40,\n    textStyle: {\n      fontSize: 16\n    }\n  },\n  toolbox: {\n    show: false,\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'category',\n    axisLabel: {\n      hideOverlap: true\n    },\n  },\n  yAxis: {\n    show: showYAxis,\n    type: 'value',\n    min: '0',\n    axisLabel: {\n      formatter: function (value) {\n        return value.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\n      }\n    },\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 34,\n    containLabel: true,\n  },\n  series,\n};\n",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "height": 400,
                "name": "default"
              },
              "visualEditor": {
                "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\nEXTRACT(MONTH from time) as month,\nCASE EXTRACT(MONTH from time)\n  WHEN 1 THEN CONCAT('Jan. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 2 THEN CONCAT('Feb. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 3 THEN CONCAT('Mär. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 4 THEN CONCAT('Apr. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 5 THEN CONCAT('Mai. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 6 THEN CONCAT('Jun. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 7 THEN CONCAT('Jul. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 8 THEN CONCAT('Aug. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 9 THEN CONCAT('Sep. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 10 THEN CONCAT('Okt. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 11 THEN CONCAT('Nov. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 12 THEN CONCAT('Dez. ', SUBSTRING(\"$Jahr\",3,3))\nEND as Monat, \nSUM(CASE WHEN SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')) = '13-17 ' THEN audienceGenderAndAge.value ELSE 0 END) as reach_13_17_r,\nSUM(CASE WHEN SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')) = '18-24 ' THEN audienceGenderAndAge.value ELSE 0 END) as reach_18_24_r,\nSUM(CASE WHEN SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')) = '25-34 ' THEN audienceGenderAndAge.value ELSE 0 END) as reach_25_34_r,\nSUM(CASE WHEN SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')) = '35-44 ' THEN audienceGenderAndAge.value ELSE 0 END) as reach_35_44_r,\nSUM(CASE WHEN SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')) = '45-54 ' THEN audienceGenderAndAge.value ELSE 0 END) as reach_45_54_r,\nSUM(CASE WHEN SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')) = '55-64 ' THEN audienceGenderAndAge.value ELSE 0 END) as reach_55_64_r,\nSUM(CASE WHEN SUBSTR(audienceGenderAndAge.ageGroupName,0,  STRPOS(audienceGenderAndAge.ageGroupName, ' ')) = '65+ ' THEN audienceGenderAndAge.value ELSE 0 END) as reach_65_r,\nSUM(IFNULL(audienceGenderAndAge.value,0)) AS total,\n\"$Skalierung\" as scailing\n  FROM\n  `ndr-code-bi-dashboard.Quintly.youtubeAnalytics`,\n  UNNEST(viewsByAgeAndGender) AS audienceGenderAndAge\n    WHERE\n  $Condition \n  AND profileId = $youtubeId \n  GROUP BY Monat,month\n  ORDER BY month",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transformations": [
              {
                "id": "filterFieldsByName",
                "options": {
                  "include": {
                    "names": [
                      "Monat",
                      "total",
                      "reach_13_17_r",
                      "reach_18_24_r",
                      "reach_25_34_r",
                      "reach_35_44_r",
                      "reach_45_54_r",
                      "reach_55_64_r",
                      "reach_65_r",
                      "reach_13_17_s",
                      "reach_18_24_s",
                      "reach_25_34_s",
                      "reach_35_44_s",
                      "reach_45_54_s",
                      "reach_55_64_s",
                      "reach_65_s",
                      "scailing",
                      "scailing_addition",
                      "total_s"
                    ]
                  }
                }
              },
              {
                "id": "organize",
                "options": {
                  "excludeByName": {},
                  "indexByName": {},
                  "renameByName": {
                    "Monat": "",
                    "reach_13_17": "13-17",
                    "reach_18_24": "18-24",
                    "reach_25_34": "25-34",
                    "reach_35_44": "35-44",
                    "reach_45_54": "45-54",
                    "reach_55_64": "55-64",
                    "reach_65": "65+",
                    "views_13_17": "13-17",
                    "views_18_24": "18-24",
                    "views_25_34": "25-34",
                    "views_35_44": "35-44",
                    "views_45_54": "45-54",
                    "views_55_64": "55-64",
                    "views_65": "65+"
                  }
                }
              },
              {
                "id": "calculateField",
                "options": {
                  "mode": "binary",
                  "reduce": {
                    "reducer": "sum"
                  }
                }
              }
            ],
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 16,
              "w": 12,
              "x": 12,
              "y": 119
            },
            "id": 183,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto",
                "height": 600
              },
              "editorMode": "code",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.flatMap((s) => {\n  const timeValues = s.fields.find((f) => f.name === 'Monat').values;\n  const scailing = s.fields.find((f) => f.name === 'scailing').values[0];\n  const unknown = s.fields.find((f) => f.name === 'unknown_reach_r').values;\n  const female = s.fields.find((f) => f.name === 'female_reach_r').values;\n  const male = s.fields.find((f) => f.name === 'male_reach_r').values;\n  const total = s.fields.find((f) => f.name === 'total').values;\n\n  // Prepare each series data\n  const scaledData = timeValues.map((_, index) => {\n    const totalValue = total[index];\n\n    // If scailing is \"ja\", calculate percentages, otherwise use raw values\n    const unknownValue = scailing === 'Ja' && totalValue > 0 ? (unknown[index] / totalValue) * 100 : unknown[index];\n    const femaleValue = scailing === 'Ja' && totalValue > 0 ? (female[index] / totalValue) * 100 : female[index];\n    const maleValue = scailing === 'Ja' && totalValue > 0 ? (male[index] / totalValue) * 100 : male[index];\n\n    const unknownPercent = (unknown[index] / totalValue) * 100;\n    const femalePercent = (female[index] / totalValue) * 100;\n    const malePercent = (male[index] / totalValue) * 100;\n\n    // Format percentages in German style\n    const formatGerman = (value) => new Intl.NumberFormat('de-DE', { minimumFractionDigits: 1, maximumFractionDigits: 1 }).format(value);\n\n    return {\n      time: timeValues[index],\n      unknown: unknownValue,\n      female: femaleValue,\n      male: maleValue,\n      unknownRaw: unknown[index], // Store raw values for tooltip\n      femaleRaw: female[index],   // Store raw values for tooltip\n      maleRaw: male[index],       // Store raw values for tooltip\n      unknownPercent: formatGerman(unknownPercent) + '%',\n      femalePercent: formatGerman(femalePercent) + '%',\n      malePercent: formatGerman(malePercent) + '%',\n    };\n  });\n\n  // Build the series array\n  return [\n    {\n      name: 'Unbekannt',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: \"rgb(242, 204, 12)\" },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].unknownPercent;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.unknown, item.unknownRaw])  // Include raw values\n    },\n    {\n      name: 'Weiblich',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: \"rgb(196, 22, 42)\" },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].femalePercent;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.female, item.femaleRaw])  // Include raw values\n    },\n    {\n      name: 'Männlich',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: \"rgb(31, 96, 196)\" },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].malePercent;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.male, item.maleRaw])  // Include raw values\n    }\n  ];\n});\n\n\nconst showYAxis = context.panel.data.series.some((s) => s.fields.find((f) => f.name === 'scailing').values[0] === 'Ja') ? false : true;\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startIndex = params.batch[0]?.startValue;\n  const endIndex = params.batch[0]?.endValue;\n\n  const timeValues = context.panel.data.series[0].fields.find((f) => f.name === 'date').values;\n\n  const startTime = new Date(timeValues[startIndex]).getTime();\n  const endTime = new Date(timeValues[endIndex]).getTime();\n\n  if (!isNaN(startTime) && !isNaN(endTime)) {\n    context.grafana.locationService.partial({ from: startTime, to: endTime });\n  } else {\n    console.error(\"Invalid start or end time:\", { startIndex, endIndex });\n  }\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: {\n      type: 'cross'\n    },\n    formatter: function (params) {\n      let tooltipText = params[0].name + '<br/>';\n      params.forEach(param => {\n        const rawValue = param.data[2]; // Get the unscaled value (third element in the array [time, scaled value, raw value])\n        // Format the raw value in German style\n        const formattedValue = new Intl.NumberFormat('de-DE').format(rawValue);\n\n        tooltipText += param.marker + param.seriesName + ': ' + formattedValue + '<br/>';\n      });\n      return tooltipText;\n    }\n  },\n  legend: {\n    orient: 'horizontal',\n    left: 'center',\n    bottom: '0%',\n    itemGap: 40,\n    textStyle: {\n      fontSize: 16\n    }\n  },\n  toolbox: {\n    show: false,\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'category',\n    axisLabel: {\n      hideOverlap: true\n    },\n  },\n  yAxis: {\n    show: showYAxis,\n    type: 'value',\n    min: '0',\n    axisLabel: {\n      formatter: function (value) {\n        return value.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\n      }\n    },\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 34,\n    containLabel: true,\n  },\n  series,\n};\n",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "height": 400,
                "name": "default"
              },
              "visualEditor": {
                "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\nEXTRACT(MONTH from time) as month,\nCASE EXTRACT(MONTH from time)\n  WHEN 1 THEN CONCAT('Jan. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 2 THEN CONCAT('Feb. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 3 THEN CONCAT('Mär. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 4 THEN CONCAT('Apr. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 5 THEN CONCAT('Mai. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 6 THEN CONCAT('Jun. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 7 THEN CONCAT('Jul. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 8 THEN CONCAT('Aug. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 9 THEN CONCAT('Sep. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 10 THEN CONCAT('Okt. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 11 THEN CONCAT('Nov. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 12 THEN CONCAT('Dez. ', SUBSTRING(\"$Jahr\",3,3))\nEND as Monat, \nSUM(CASE WHEN gender = 'genderUserSpecified' THEN audienceGenderAndAge.value ELSE 0 END) as unknown_reach_r,\nSUM(CASE WHEN gender = 'female' THEN audienceGenderAndAge.value ELSE 0 END) as female_reach_r,\nSUM(CASE WHEN gender = 'male' THEN audienceGenderAndAge.value ELSE 0 END) as male_reach_r,\nSUM(audienceGenderAndAge.value) AS total,\n\"$Skalierung\" as scailing\n  FROM\n  `ndr-code-bi-dashboard.Quintly.youtubeAnalytics`,\n  UNNEST(viewsByAgeAndGender) AS audienceGenderAndAge\n    WHERE\n  $Condition \n  AND profileId = $youtubeId \n  GROUP BY Monat,month\n  ORDER BY month",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transformations": [
              {
                "id": "filterFieldsByName",
                "options": {
                  "include": {
                    "names": [
                      "Monat",
                      "total",
                      "unknown_reach_r",
                      "female_reach_r",
                      "male_reach_r",
                      "unknown_reach_s",
                      "female_reach_s",
                      "male_reach_s",
                      "scailing",
                      "scailing_addition",
                      "total_s"
                    ]
                  }
                }
              },
              {
                "id": "organize",
                "options": {
                  "excludeByName": {},
                  "indexByName": {},
                  "renameByName": {
                    "views_female": "Weiblich",
                    "views_male": "Männlich",
                    "views_userSpecified": "Unbekannt"
                  }
                }
              }
            ],
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          }
        ],
        "title": "YouTube Views | $Row_Name",
        "type": "row"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 14
        },
        "id": 224,
        "panels": [],
        "title": "TikTok Follower | $Row_Name",
        "type": "row"
      },
      {
        "fieldConfig": {
          "defaults": {},
          "overrides": []
        },
        "gridPos": {
          "h": 2,
          "w": 2,
          "x": 0,
          "y": 15
        },
        "id": 225,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "<img width=\"50\" height=\"50\" src=\"data:image/png;base64,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\" /> ",
          "mode": "markdown"
        },
        "pluginVersion": "11.3.1",
        "title": "",
        "transparent": true,
        "type": "text"
      },
      {
        "fieldConfig": {
          "defaults": {},
          "overrides": []
        },
        "gridPos": {
          "h": 2,
          "w": 22,
          "x": 2,
          "y": 15
        },
        "id": 169,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "<font size=\"6\" style=\"color:rgb(37,244,238);\">TikTok Follower</font><font size=\"6\">  ${Profil} </font>",
          "mode": "html"
        },
        "pluginVersion": "11.3.1",
        "title": "",
        "transparent": true,
        "type": "text"
      },
      {
        "fieldConfig": {
          "defaults": {},
          "overrides": []
        },
        "gridPos": {
          "h": 2,
          "w": 24,
          "x": 0,
          "y": 17
        },
        "id": 197,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "<font size=\"6\"> TikTok Follower Verteilung im Zeitraum </font>",
          "mode": "html"
        },
        "pluginVersion": "11.3.1",
        "title": "",
        "transparent": true,
        "type": "text"
      },
      {
        "description": "",
        "fieldConfig": {
          "defaults": {},
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "stichtag"
              },
              "properties": []
            }
          ]
        },
        "gridPos": {
          "h": 2,
          "w": 3,
          "x": 0,
          "y": 19
        },
        "id": 228,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "Stichtag: ${stichtag_ig}",
          "mode": "markdown"
        },
        "pluginVersion": "11.3.1",
        "title": "",
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {},
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Unknow"
              },
              "properties": []
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Weiblich"
              },
              "properties": []
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Männlich"
              },
              "properties": []
            }
          ]
        },
        "gridPos": {
          "h": 8,
          "w": 12,
          "x": 0,
          "y": 21
        },
        "id": 229,
        "options": {
          "baidu": {
            "callback": "bmapReady",
            "key": ""
          },
          "editor": {
            "format": "auto"
          },
          "editorMode": "visual",
          "gaode": {
            "key": "",
            "plugin": "AMap.Scale,AMap.ToolBar"
          },
          "getOption": "const series = context.panel.data.series.map((s) => {\n  const sData = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n  const sTime = s.fields.find((f) => f.type === 'time').values.buffer || s.fields.find((f) => f.type === 'time').values;\n  \n  return {\n    name: s.refId,\n    type: 'line',\n    showSymbol: false,\n    areaStyle: {\n      opacity: 0.1,\n    },\n    lineStyle: {\n      width: 1,\n    },\n    data: sData.map((d, i) => [sTime[i], d.toFixed(2)]),\n  };\n});\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startValue = params.batch[0]?.startValue;\n  const endValue = params.batch[0]?.endValue;\n  locationService.partial({ from: startValue, to: endValue });\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n  },\n  legend: {\n    left: '0',\n    bottom: '0',\n    data: context.panel.data.series.map((s) => s.refId),\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  toolbox: {\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 24,\n    containLabel: true,\n  },\n  series,\n};",
          "google": {
            "callback": "gmapReady",
            "key": ""
          },
          "map": "none",
          "renderer": "canvas",
          "themeEditor": {
            "config": "{}",
            "name": "default"
          },
          "visualEditor": {
            "code": "const colorMapping = {\n  \"Männlich\": \"#1F60C4\",\n  \"Weiblich\": \"rgb(196, 22, 42) \",  // Dark red\n  \"Unbekannt\": \"#FFD700\"  // Gold\n};\n\n// Helper function to format numbers to German format\nfunction formatNumberGerman(value) {\n  return Math.round(value).toLocaleString('de-DE');\n}\n\n// Retrieve data from the context\nconst seriesData = context.panel.data.series.map((s) => {\n  const categories = s.fields.find((f) => f.name === 'gender').values.buffer || s.fields.find((f) => f.name === 'gender').values;\n  const percentages = s.fields.find((f) => f.name === 'percentage').values.buffer || s.fields.find((f) => f.name === 'percentage').values;\n\n  return categories.map((category, i) => ({\n    name: category,\n    value: percentages[i],\n    itemStyle: {\n      color: colorMapping[category] || '#cccccc'  // Default to grey if no match\n    }\n  }));\n})[0];  // Since it's a pie chart, we take the first series.\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'item',\n    formatter: (params) => {\n      return `<b>${params.name}</b><br/>${formatNumberGerman(params.percent)}%`;\n    },\n    textStyle: {\n      fontWeight: 'bold',\n      fontSize: 14,  // Increase font size for tooltip text\n    }\n  },\n  legend: {\n    orient: 'vertical',  // Arrange the legend items vertically\n    left: 'right',       // Position the legend on the right side\n    top: 'center',       // Center the legend vertically\n    formatter: (name) => {\n      return `${name}`;  // Just the name without values or percentages\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  series: [\n    {\n      name: 'YouTube Views by Gender',\n      type: 'pie',\n      radius: ['0%', '70%'],  // Creates a donut shape\n      data: seriesData,\n      label: {\n        show: true,\n        formatter: (params) => `${formatNumberGerman(params.percent)}%`,   // Display only the rounded percentage\n        position: 'inside',  // Position the label inside the donut slices\n        textStyle: {\n          //color: '#fff',     // White color for better contrast\n          fontWeight: 'bold',\n        }\n      },\n      labelLine: {\n        show: false  // Hides the line connecting labels to slices since the labels are inside\n      },\n      emphasis: {\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)',\n        },\n      },\n    },\n  ],\n};\n",
            "dataset": [],
            "series": []
          }
        },
        "pluginVersion": "6.1.0",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\nCASE \n    WHEN gender = 'Male' THEN 'Männlich'\n    WHEN gender = 'Female' THEN 'Weiblich'\n    WHEN gender = 'Other' THEN 'Unbekannt' END as gender,\n  audienceGenderAndAge.value AS percentage\nFROM\n  `ndr-code-bi-dashboard.Quintly.tiktokAnalytics`,\n  UNNEST(audienceGenders) AS audienceGenderAndAge\n  WHERE\n  time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly.tiktokAnalytics`,\n  UNNEST(audienceGenders) AS audienceGenderAndAge WHERE $Condition AND audienceGenderAndAge.value IS NOT NULL AND profileId = $tiktokId)\n  AND profileId = $tiktokId \nORDER BY\n  gender;",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "",
        "transparent": true,
        "type": "volkovlabs-echarts-panel"
      },
      {
        "collapsed": true,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 29
        },
        "id": 165,
        "panels": [
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 2,
              "x": 0,
              "y": 30
            },
            "id": 171,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<img width=\"50\" height=\"50\" src=\"data:image/png;base64,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\" /> ",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 22,
              "x": 2,
              "y": 30
            },
            "id": 226,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<font size=\"6\" style=\"color:rgb(1, 101, 225);\">Facebook Ø Pot. Reichweite pro Tag</font><font size=\"6\">  ${Profil} </font>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 24,
              "x": 0,
              "y": 32
            },
            "id": 227,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<font size=\"6\"> Facebook Ø Pot. Reichweite pro Tag Verteilung im Zeitraum </font>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "description": "",
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "nutzungszeitraum"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 2,
              "w": 4,
              "x": 0,
              "y": 34
            },
            "id": 167,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "Zeitraum: ${nutzungszeitraum}",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "description": "",
            "fieldConfig": {
              "defaults": {
                "color": {
                  "mode": "thresholds"
                },
                "decimals": 0,
                "displayName": "Ø Pot. Reichweite pro Tag:",
                "mappings": [],
                "thresholds": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "dark-red",
                      "value": null
                    },
                    {
                      "color": "text",
                      "value": 10000
                    }
                  ]
                },
                "unit": "locale"
              },
              "overrides": []
            },
            "gridPos": {
              "h": 3,
              "w": 4,
              "x": 6,
              "y": 34
            },
            "id": 193,
            "options": {
              "colorMode": "value",
              "graphMode": "none",
              "justifyMode": "auto",
              "orientation": "auto",
              "percentChangeColorMode": "standard",
              "reduceOptions": {
                "calcs": [
                  "lastNotNull"
                ],
                "fields": "",
                "values": false
              },
              "showPercentChange": false,
              "text": {
                "titleSize": 16
              },
              "textMode": "auto",
              "wideLayout": true
            },
            "pluginVersion": "11.3.1",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\r\n ROUND(SUM(reach)/COUNT(DISTINCT time),3) AS total\r\nFROM\r\n  `Quintly.facebookInsightsByGenderAndAge`\r\nWHERE \r\n $Condition\r\n AND profileId = $facebookId ",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "stat"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "description": "berechneter Wert",
            "fieldConfig": {
              "defaults": {
                "color": {
                  "mode": "thresholds"
                },
                "mappings": [],
                "thresholds": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": null
                    },
                    {
                      "color": "red",
                      "value": 80
                    }
                  ]
                }
              },
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "average_age"
                  },
                  "properties": [
                    {
                      "id": "unit",
                      "value": "locale"
                    },
                    {
                      "id": "displayName",
                      "value": "Ø Alter"
                    },
                    {
                      "id": "decimals",
                      "value": 0
                    }
                  ]
                }
              ]
            },
            "gridPos": {
              "h": 2,
              "w": 2,
              "x": 11,
              "y": 34
            },
            "id": 207,
            "options": {
              "colorMode": "value",
              "graphMode": "area",
              "justifyMode": "center",
              "orientation": "auto",
              "percentChangeColorMode": "standard",
              "reduceOptions": {
                "calcs": [
                  "lastNotNull"
                ],
                "fields": "/.*/",
                "values": false
              },
              "showPercentChange": false,
              "text": {
                "titleSize": 16
              },
              "textMode": "value_and_name",
              "wideLayout": true
            },
            "pluginVersion": "11.3.1",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "WITH WeightedAverages AS (\n  SELECT\n    CASE ageBucket\n      WHEN \"13-17\" THEN 15\n      WHEN \"18-24\" THEN 21\n      WHEN \"25-34\" THEN 29.5\n      WHEN \"35-44\" THEN 39.5\n      WHEN \"45-54\" THEN 49.5\n      WHEN \"55-64\" THEN 59.5\n      ELSE 69.5\n    END AS mid_age,\n    SUM(reach) AS age_bucket_pot_reichweite\n  FROM\n    `ndr-code-bi-dashboard.Quintly.facebookInsightsByGenderAndAge`\n  WHERE $Condition \n  AND profileId = $facebookId \n  GROUP BY\n  ageBucket\n)\nSELECT \n  SUM(mid_age * age_bucket_pot_reichweite / (SELECT SUM(age_bucket_pot_reichweite) FROM WeightedAverages)) as average_age\nFROM WeightedAverages\n",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "stat"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 6,
              "w": 11,
              "x": 13,
              "y": 34
            },
            "id": 223,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"background-color:rgba(38, 113, 198);color: white; text-align:center; vertical-align: middle; padding:20px 0; margin-top:0px; font-size: 12pt;\">\n<font color=\"#FFFFFF\">Seit dem 16. September 2024 stellt Meta über die API für Facebook keine soziodemografischen Daten mehr zur Verfügung. Für alle Zeiträume nach September 2024 weist das Dashboard an dieser Stelle dementsprechend keine Daten mehr aus. Da es (bisher) keine Alternative zur Betrachtung der Soziodemografie der User bei Facebook gibt, können hier weiterhin die historischen Werte ausgewertet werden.\n</div>",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "description": "",
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 3,
              "w": 6,
              "x": 6,
              "y": 37
            },
            "id": 194,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "Bei Ø Pot. Reichweite pro Tag < 10.000: Die Datenbasis der soziodemografischen Daten ist hier sehr klein. Die Daten müssen daher mit Vorsicht betrachtet werden und sollten nicht für weitere Ableitungen verwendet werden! ",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 12,
              "x": 6,
              "y": 40
            },
            "id": 198,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Facebook Ø Pot. Reichweite pro Tag nach Geschlecht und Alter in Tausend</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "male_total_followers"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "female_total_followers"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "unknown_total_followers"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Unbekannt"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Gesamt"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "ageBucket"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 14,
              "w": 24,
              "x": 0,
              "y": 42
            },
            "id": 195,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "visual",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.map((s) => {\n  const sData = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n  const sTime = s.fields.find((f) => f.type === 'time').values.buffer || s.fields.find((f) => f.type === 'time').values;\n  \n  return {\n    name: s.refId,\n    type: 'line',\n    showSymbol: false,\n    areaStyle: {\n      opacity: 0.1,\n    },\n    lineStyle: {\n      width: 1,\n    },\n    data: sData.map((d, i) => [sTime[i], d.toFixed(2)]),\n  };\n});\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startValue = params.batch[0]?.startValue;\n  const endValue = params.batch[0]?.endValue;\n  locationService.partial({ from: startValue, to: endValue });\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n  },\n  legend: {\n    left: '0',\n    bottom: '0',\n    data: context.panel.data.series.map((s) => s.refId),\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  toolbox: {\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 24,\n    containLabel: true,\n  },\n  series,\n};",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "const formatNumberGerman = (number) => {\n  return Math.round(number).toLocaleString('de-DE'); // Formats number to German locale\n};\n\nconst FONTSIZE = 12;\nconst BARWIDTH = 37;\n\nconst colorMapping = {\n  \"male\": \"#1F60C4\",     // Blue\n  \"female\": \"rgb(196, 22, 42)\",   // Dark Red\n  \"unknown\": \"#FFD700\",  // Gold\n  \"total\": \"rgb(180, 180, 180)\"  // Light Grey for Gesamt\n};\n\n// Data processing based on the query results\nconst seriesData = context.panel.data.series.map((s) => {\n  const ageBuckets = s.fields.find((f) => f.name === 'ageBucket').values.buffer || s.fields.find((f) => f.name === 'ageBucket').values;\n  const totalFollowers = s.fields.find((f) => f.name === 'Gesamt').values.buffer || s.fields.find((f) => f.name === 'Gesamt').values;\n  const maleFollowers = s.fields.find((f) => f.name === 'male_total_reach').values.buffer || s.fields.find((f) => f.name === 'male_total_reach').values;\n  const femaleFollowers = s.fields.find((f) => f.name === 'female_total_reach').values.buffer || s.fields.find((f) => f.name === 'female_total_reach').values;\n  const unknownFollowers = s.fields.find((f) => f.name === 'unknown_total_reach').values.buffer || s.fields.find((f) => f.name === 'unknown_total_reach').values;\n\n  return ageBuckets.map((age, i) => ({\n    ageBucket: age,\n    male: maleFollowers[i],\n    female: femaleFollowers[i],\n    unknown: unknownFollowers[i],\n    total: totalFollowers[i]\n  }));\n})[0];  // Extract the first series for simplicity\n\n// Extracting the data for each category\nconst categories = seriesData.map(d => d.ageBucket);\n\nconst maleSeries = seriesData.map(d => d.male);\nconst femaleSeries = seriesData.map(d => d.female);\nconst unknownSeries = seriesData.map(d => d.unknown);\nconst totalSeries = seriesData.map(d => d.total);\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: {\n      type: 'shadow'\n    },\n    formatter: (params) => {\n      let tooltipContent = `${params[0].name}<br/>`;\n      params.forEach((item) => {\n        tooltipContent += `<b>${item.seriesName}:</b> ${formatNumberGerman(item.value)}<br/>`;\n      });\n      return tooltipContent;\n    },\n    textStyle: {\n      fontWeight: 'bold', fontSize: FONTSIZE\n    }\n  },\n  legend: {\n    data: ['Männlich', 'Weiblich', 'Unbekannt', 'Gesamt'],\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n    top: 'bottom'\n  },\n  toolbox: {\n    show:false,\n    feature: {\n      saveAsImage: {},\n    },\n  },\n  grid: {\n    left: '3%',  // Adjust this value to move the chart more to the left\n    right: '3%', // Adjust space on the right side if necessary\n    top: '3%',\n    bottom: '10%',\n    containLabel: true\n  },\n  xAxis: {\n    type: 'category',\n    data: categories.reverse(),  // Reverse for sorting from young to old\n    axisLine: {\n      lineStyle: {\n        color: 'rgba(128, 128, 128, .9)',\n      },\n    },\n    axisLabel: {\n      rotate: 45,  // Rotate for better readability\n      show: true\n    },\n    axisTick: {\n      show: false,  // Hide axis ticks\n    }\n  },\n  yAxis: {\n    type: 'value',\n    axisLine: {\n      show: false,  // Hide the y-axis line\n    },\n    axisLabel: {\n      show: true,  // Show y-axis labels (numbers)\n      formatter: function (value) {\n        return value.toLocaleString('de-DE');\n      }\n    },\n    axisTick: {\n      show: false,  // Hide axis ticks\n    }\n  },\n  series: [\n    {\n      name: 'Gesamt',\n      type: 'bar',\n      data: totalSeries.reverse(),  // Reverse to match category order\n      itemStyle: {\n        color: colorMapping['total'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: 'rgb(180, 180, 180)',\n          fontWeight: 'bold', fontSize: FONTSIZE\n        }\n      }\n    },\n    {\n      name: 'Männlich',\n      type: 'bar',\n      data: maleSeries.reverse(),  // Reverse to match category order\n      itemStyle: {\n        color: colorMapping['male'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: '#1F60C4',\n          fontWeight: 'bold', fontSize: FONTSIZE,\n        }\n      }\n    },\n    {\n      name: 'Weiblich',\n      type: 'bar',\n      data: femaleSeries.reverse(),  // Reverse to match category order\n      itemStyle: {\n        color: colorMapping['female'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: 'rgb(196, 22, 42)',\n          fontWeight: 'bold', fontSize: FONTSIZE\n        }\n      }\n    },\n    {\n      name: 'Unbekannt',\n      type: 'bar',\n      data: unknownSeries.reverse(),  // Reverse to match category order\n      itemStyle: {\n        color: colorMapping['unknown'],\n      },\n      barWidth: BARWIDTH, // Adjust bar width if needed\n      label: {\n        show: true,\n        position: 'top',  // Position labels at the top of bars\n        formatter: (params) => formatNumberGerman(params.value),\n        textStyle: {\n          color: '#FFD700',\n          fontWeight: 'bold', fontSize: FONTSIZE\n        }\n      }\n    }\n  ]\n};\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT \nageBucket,\nROUND(unknown_total_reach/1000,3) as unknown_total_reach,\nROUND(female_total_reach/1000,3) as female_total_reach,\nROUND(male_total_reach/1000,3) as male_total_reach,\nROUND(Gesamt/1000,3) as Gesamt, \nFROM (\nSELECT \nageBucket,\n SUM(CASE WHEN gender = 'Unknown' THEN reach ELSE 0 END)/COUNT(DISTINCT time) AS unknown_total_reach,\n SUM(CASE WHEN gender = 'Female' THEN reach ELSE 0 END)/COUNT(DISTINCT time) AS female_total_reach,\n SUM(CASE WHEN gender = 'Male' THEN reach ELSE 0 END)/COUNT(DISTINCT time) AS male_total_reach,\n SUM(reach)/COUNT(DISTINCT time) as Gesamt\n\nFROM\n  `Quintly.facebookInsightsByGenderAndAge`\nWHERE \n $Condition\n AND profileId = $facebookId\n GROUP BY ageBucket\n)\nORDER BY CAST(LEFT(ageBucket,2) AS INT) DESC\n",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 8,
              "x": 0,
              "y": 56
            },
            "id": 200,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Facebook Ø Pot. Reichweite pro Tag nach Alter (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 8,
              "x": 8,
              "y": 56
            },
            "id": 201,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Facebook Ø Pot. Reichweite pro Tag nach Geschlecht (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 8,
              "x": 16,
              "y": 56
            },
            "id": 202,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Facebook Ø Pot. Reichweite pro Tag nach Geschlecht ohne Unbekannt (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "13-17"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "18-24"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "65+"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "55-64"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "45-54"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "25-34"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "35-44"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "total"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 10,
              "w": 8,
              "x": 0,
              "y": 58
            },
            "id": 184,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "code",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const colorMapping = {\n  \"13-17\": \"#b877d9\",\n  \"18-24\": \"#37872d\",\n  \"25-34\": \"#ff780a\",\n  \"35-44\": \"#f2495c\",\n  \"45-54\": \"#8ab8ff\",\n  \"55-64\": \"#73bf69\",\n  \"65+\": \"#f2cc0c\"\n};\n\n// Helper function to format numbers to German format\nfunction formatNumberGerman(value) {\n  return new Intl.NumberFormat('de-DE').format(Math.round(value));\n}\n\nconst seriesData = context.panel.data.series.map((s) => {\n  const categories = s.fields.find((f) => f.name === 'ageBucket').values.buffer || s.fields.find((f) => f.name === 'ageBucket').values;\n  const values = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n\n  return categories.map((category, i) => ({\n    name: category,\n    value: values[i],\n    itemStyle: {\n      color: colorMapping[category] || '#cccccc'  // Default to grey if no match\n    }\n  }));\n})[0];  // Since it's a pie chart, we take the first series.\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'item',\n    formatter: (params) => {\n      return `<b>${params.name}</b><br/>${formatNumberGerman(params.value)} (${formatNumberGerman(params.percent)}%)`;\n    },\n    textStyle: {\n      fontWeight: 'bold',\n      fontSize: 14,  // Increase font size for tooltip text\n    }\n  },\n  legend: {\n    orient: 'vertical',  // Arrange the legend items vertically\n    left: 'right',       // Position the legend on the right side\n    top: 'center',       // Center the legend vertically\n    formatter: (name) => {\n      const item = seriesData.find(d => d.name === name);\n      return `${name}`;  // Just the name without values or percentages\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n    },\n  },\n  toolbox: {\n    show: false, \n    feature: {\n      saveAsImage: {},\n    },\n  },\n  series: [\n    {\n      name: 'Facebook Reach nach Alter',\n      type: 'pie',\n      radius: ['0%', '70%'],  // Full pie, inner radius set to 0%\n      data: seriesData,\n      label: {\n        show: true,\n        formatter: (params) => `${formatNumberGerman(params.percent)}%`,   // Display only the rounded percentage\n        position: 'inside',  // Position the label inside the donut slices\n        textStyle: {\n          //color: '#fff',     // White color for better contrast\n          fontWeight: 'bold',\n        }\n      },\n      labelLine: {\n        show: false  // Hides the line connecting labels to slices since the labels are inside\n      },\n      emphasis: {\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)',\n        },\n      },\n    },\n  ],\n};\n",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\nageBucket,\n ROUND(SUM(reach)/COUNT(DISTINCT time),3) AS total\nFROM\n  `Quintly.facebookInsightsByGenderAndAge`\nWHERE \n $Condition\n AND profileId = $facebookId \n GROUP BY ageBucket\n ORDER BY CAST(LEFT(ageBucket,2) AS INT)",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Unbekannt"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "35-44"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Gesamt"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 10,
              "w": 8,
              "x": 8,
              "y": 58
            },
            "id": 185,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "code",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const colorMapping = {\n  \"Männlich\": \"#1F60C4\",\n  \"Weiblich\": \"rgb(196, 22, 42) \",  // Assuming 'dark-red' as rgb(196, 22, 42) \n  \"Unbekannt\": \"#FFD700\"  // Assuming 'semi-dark-yellow' as #FFD700\n};\n\n// Helper function to format numbers to German format\nfunction formatNumberGerman(value) {\n  return new Intl.NumberFormat('de-DE').format(Math.round(value));\n}\n\nconst seriesData = context.panel.data.series.map((s) => {\n  const categories = s.fields.find((f) => f.name === 'gender').values.buffer || s.fields.find((f) => f.name === 'gender').values;\n  const values = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n\n  return categories.map((category, i) => ({\n    name: category,\n    value: values[i],\n    itemStyle: {\n      color: colorMapping[category] || '#cccccc'  // Default to grey if no match\n    }\n  }));\n})[0];\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'item',\n    formatter: (params) => {\n      return `<b>${params.name}</b><br/>${formatNumberGerman(params.value)} (${formatNumberGerman(params.percent)}%)`;\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n      fontWeight: 'bold',\n    }\n  },\n  legend: {\n    orient: 'vertical',\n    left: 'right',\n    top: 'center',\n    formatter: (name) => {\n      const item = seriesData.find(d => d.name === name);\n      return `${name}`;  // Display the name without values or percentages\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n      fontWeight: 'bold',\n    },\n  },\n  toolbox: {\n    show: false,\n    feature: {\n      saveAsImage: {},\n    },\n  },\n  series: [\n    {\n      name: 'Facebook Reach nach Geschlecht',\n      type: 'pie',\n      radius: ['0%', '70%'],  // Full pie, inner radius set to 0%\n      data: seriesData,\n      label: {\n        show: true,\n        formatter: (params) => `${formatNumberGerman(params.percent)}%`,   // Display only the rounded percentage\n        position: 'inside',  // Position the label inside the donut slices\n        textStyle: {\n          // color: '#fff',     // White color for better contrast\n          fontWeight: 'bold',\n        }\n      },\n      labelLine: {\n        show: false\n      },\n      emphasis: {\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)',\n        },\n      },\n    },\n  ],\n};\n",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\nCASE gender\nWHEN \"Male\" THEN \"Männlich\"\nWHEN \"Female\" THEN \"Weiblich\"\nWHEN \"Unknown\" THEN \"Unbekannt\" END as gender,\n SUM(reach)/COUNT(DISTINCT time) as Gesamt\n\nFROM\n  `Quintly.facebookInsightsByGenderAndAge`\nWHERE \n --EXTRACT(YEAR from time) = $Jahr\n $Condition\n AND profileId = $facebookId \nGROUP BY\n  gender",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Männlich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Weiblich"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Unbekannt"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "35-44"
                  },
                  "properties": []
                },
                {
                  "matcher": {
                    "id": "byName",
                    "options": "Gesamt"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 10,
              "w": 8,
              "x": 16,
              "y": 58
            },
            "id": 196,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto"
              },
              "editorMode": "code",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const colorMapping = {\n  \"Männlich\": \"#1F60C4\",\n  \"Weiblich\": \"rgb(196, 22, 42) \",  // Assuming 'dark-red' as rgb(196, 22, 42) \n  \"Unbekannt\": \"#FFD700\"  // Assuming 'semi-dark-yellow' as #FFD700\n};\n\n// Helper function to format numbers to German format\nfunction formatNumberGerman(value) {\n  return new Intl.NumberFormat('de-DE').format(Math.round(value));\n}\n\nconst seriesData = context.panel.data.series.map((s) => {\n  const categories = s.fields.find((f) => f.name === 'gender').values.buffer || s.fields.find((f) => f.name === 'gender').values;\n  const values = s.fields.find((f) => f.type === 'number').values.buffer || s.fields.find((f) => f.type === 'number').values;\n\n  return categories.map((category, i) => ({\n    name: category,\n    value: values[i],\n    itemStyle: {\n      color: colorMapping[category] || '#cccccc'  // Default to grey if no match\n    }\n  }));\n})[0];\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'item',\n    formatter: (params) => {\n      return `<b>${params.name}</b><br/>${formatNumberGerman(params.value)} (${formatNumberGerman(params.percent)}%)`;\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n      fontWeight: 'bold',\n    }\n  },\n  legend: {\n    orient: 'vertical',\n    left: 'right',\n    top: 'center',\n    formatter: (name) => {\n      const item = seriesData.find(d => d.name === name);\n      return `${name}`;  // Display the name without values or percentages\n    },\n    textStyle: {\n      color: 'rgba(128, 128, 128, .9)',\n      fontWeight: 'bold',\n    },\n  },\n  toolbox: {\n    show: false,\n    feature: {\n      saveAsImage: {},\n    },\n  },\n  series: [\n    {\n      name: 'Facebook Reach nach Geschlecht',\n      type: 'pie',\n      radius: ['0%', '70%'],  // Full pie, inner radius set to 0%\n      data: seriesData,\n      label: {\n        show: true,\n        formatter: (params) => `${formatNumberGerman(params.percent)}%`,   // Display only the rounded percentage\n        position: 'inside',  // Position the label inside the donut slices\n        textStyle: {\n          // color: '#fff',     // White color for better contrast\n          fontWeight: 'bold',\n        }\n      },\n      labelLine: {\n        show: false\n      },\n      emphasis: {\n        itemStyle: {\n          shadowBlur: 10,\n          shadowOffsetX: 0,\n          shadowColor: 'rgba(0, 0, 0, 0.5)',\n        },\n      },\n    },\n  ],\n};\n",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "name": "default"
              },
              "visualEditor": {
                "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\nCASE gender\nWHEN \"Male\" THEN \"Männlich\"\nWHEN \"Female\" THEN \"Weiblich\"\nWHEN \"Unknown\" THEN \"Unbekannt\" END as gender,\n SUM(reach)/COUNT(DISTINCT time) as Gesamt\n\nFROM\n  `Quintly.facebookInsightsByGenderAndAge`\nWHERE \n --EXTRACT(YEAR from time) = $Jahr\n $Condition\n AND profileId = $facebookId\n AND gender != \"Unknown\"\nGROUP BY\n  gender",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 13,
              "x": 0,
              "y": 68
            },
            "id": 205,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<font size=\"6\">Facebook Ø Pot. Reichweite pro Tag im Zeitverlauf</font>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "description": "",
            "fieldConfig": {
              "defaults": {},
              "overrides": [
                {
                  "matcher": {
                    "id": "byName",
                    "options": "nutzungszeitraum"
                  },
                  "properties": []
                }
              ]
            },
            "gridPos": {
              "h": 2,
              "w": 13,
              "x": 0,
              "y": 70
            },
            "id": 206,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "Zeitraum: ${nutzungszeitraum}",
              "mode": "markdown"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 12,
              "x": 0,
              "y": 72
            },
            "id": 203,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Facebook Ø Pot. Reichweite pro Tag nach Alter (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 2,
              "w": 12,
              "x": 12,
              "y": 72
            },
            "id": 204,
            "options": {
              "code": {
                "language": "plaintext",
                "showLineNumbers": false,
                "showMiniMap": false
              },
              "content": "<div style=\"text-align: center;\">\r\n  <font size=\"3\">Facebook Ø Pot. Reichweite pro Tag nach Geschlecht (Anteile in %)</font>\r\n</div>",
              "mode": "html"
            },
            "pluginVersion": "11.3.1",
            "title": "",
            "transparent": true,
            "type": "text"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 16,
              "w": 12,
              "x": 0,
              "y": 74
            },
            "id": 222,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto",
                "height": 600
              },
              "editorMode": "code",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.flatMap((s) => {\n  const timeValues = s.fields.find((f) => f.name === 'Monat').values;\n  const scailing = s.fields.find((f) => f.name === 'scailing').values[0];\n  const reach_13_17 = s.fields.find((f) => f.name === 'reach_13_17_r').values;\n  const reach_18_24 = s.fields.find((f) => f.name === 'reach_18_24_r').values;\n  const reach_25_34 = s.fields.find((f) => f.name === 'reach_25_34_r').values;\n  const reach_35_44 = s.fields.find((f) => f.name === 'reach_35_44_r').values;\n  const reach_45_54 = s.fields.find((f) => f.name === 'reach_45_54_r').values;\n  const reach_55_64 = s.fields.find((f) => f.name === 'reach_55_64_r').values;\n  const reach_65 = s.fields.find((f) => f.name === 'reach_65_r').values;\n  const total = s.fields.find((f) => f.name === 'total').values;\n\n  // Prepare each series data\n  const scaledData = timeValues.map((_, index) => {\n    const totalValue = total[index];\n\n    // If scailing is \"ja\", calculate percentages, otherwise use raw values\n    const reach_13_17_value = scailing === 'Ja' && totalValue > 0 ? (reach_13_17[index] / totalValue) * 100 : reach_13_17[index];\n    const reach_18_24_value = scailing === 'Ja' && totalValue > 0 ? (reach_18_24[index] / totalValue) * 100 : reach_18_24[index];\n    const reach_25_34_value = scailing === 'Ja' && totalValue > 0 ? (reach_25_34[index] / totalValue) * 100 : reach_25_34[index];\n    const reach_35_44_value = scailing === 'Ja' && totalValue > 0 ? (reach_35_44[index] / totalValue) * 100 : reach_35_44[index];\n    const reach_45_54_value = scailing === 'Ja' && totalValue > 0 ? (reach_45_54[index] / totalValue) * 100 : reach_45_54[index];\n    const reach_55_64_value = scailing === 'Ja' && totalValue > 0 ? (reach_55_64[index] / totalValue) * 100 : reach_55_64[index];\n    const reach_65_value = scailing === 'Ja' && totalValue > 0 ? (reach_65[index] / totalValue) * 100 : reach_65[index];\n\n    const reach_13_17_percentage = (reach_13_17[index] / totalValue) * 100;\n    const reach_18_24_percentage = (reach_18_24[index] / totalValue) * 100;\n    const reach_25_34_percentage = (reach_25_34[index] / totalValue) * 100;\n    const reach_35_44_percentage = (reach_35_44[index] / totalValue) * 100;\n    const reach_45_54_percentage = (reach_45_54[index] / totalValue) * 100;\n    const reach_55_64_percentage = (reach_55_64[index] / totalValue) * 100;\n    const reach_65_percentage = (reach_65[index] / totalValue) * 100;\n\n\n    // Format percentages in German style\n    const formatGerman = (value) => new Intl.NumberFormat('de-DE', { minimumFractionDigits: 1, maximumFractionDigits: 1 }).format(value);\n\n    return {\n      time: timeValues[index],\n      reach_13_17: reach_13_17_value,\n      reach_18_24: reach_18_24_value,\n      reach_25_34: reach_25_34_value,\n      reach_35_44: reach_35_44_value,\n      reach_45_54: reach_45_54_value,\n      reach_55_64: reach_55_64_value,\n      reach_65: reach_65_value,\n\n      reach_13_17_raw: reach_13_17[index],\n      reach_18_24_raw: reach_18_24[index],\n      reach_25_34_raw: reach_25_34[index],\n      reach_35_44_raw: reach_35_44[index],\n      reach_45_54_raw: reach_45_54[index],\n      reach_55_64_raw: reach_55_64[index],\n      reach_65_raw: reach_65[index],\n\n      reach_13_17_percentage: formatGerman(reach_13_17_percentage) + '%',\n      reach_18_24_percentage: formatGerman(reach_18_24_percentage) + '%',\n      reach_25_34_percentage: formatGerman(reach_25_34_percentage) + '%',\n      reach_35_44_percentage: formatGerman(reach_35_44_percentage) + '%',\n      reach_45_54_percentage: formatGerman(reach_45_54_percentage) + '%',\n      reach_55_64_percentage: formatGerman(reach_55_64_percentage) + '%',\n      reach_65_percentage: formatGerman(reach_65_percentage) + '%'\n    };\n  });\n\n  // Build the series array\n  return [\n    {\n      name: '13-17',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(184, 119, 217)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_13_17_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_13_17, item.reach_13_17_raw])  // Include raw values\n    },\n    {\n      name: '18-24',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(55, 135, 45)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_18_24_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_18_24, item.reach_18_24_raw])  // Include raw values\n    },\n    {\n      name: '25-34',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(255, 120, 10)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_25_34_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_25_34, item.reach_25_34_raw])  // Include raw values\n    },\n    {\n      name: '35-44',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(242, 73, 92)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_35_44_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_35_44, item.reach_35_44_raw])  // Include raw values\n    },\n    {\n      name: '45-54',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(138, 184, 255)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_45_54_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_45_54, item.reach_45_54_raw])  // Include raw values\n    },\n    {\n      name: '55-64',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(115, 191, 105)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_55_64_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_55_64, item.reach_55_64_raw])  // Include raw values\n    },\n    {\n      name: '65+',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: 'rgb(242, 204, 12)' },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].reach_65_percentage;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.reach_65, item.reach_65_raw])  // Include raw values\n    }\n  ];\n});\n\n\nconst showYAxis = context.panel.data.series.some((s) => s.fields.find((f) => f.name === 'scailing').values[0] === 'Ja') ? false : true;\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startIndex = params.batch[0]?.startValue;\n  const endIndex = params.batch[0]?.endValue;\n\n  const timeValues = context.panel.data.series[0].fields.find((f) => f.name === 'date').values;\n\n  const startTime = new Date(timeValues[startIndex]).getTime();\n  const endTime = new Date(timeValues[endIndex]).getTime();\n\n  if (!isNaN(startTime) && !isNaN(endTime)) {\n    context.grafana.locationService.partial({ from: startTime, to: endTime });\n  } else {\n    console.error(\"Invalid start or end time:\", { startIndex, endIndex });\n  }\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: {\n      type: 'cross'\n    },\n    formatter: function (params) {\n      let tooltipText = params[0].name + '<br/>';\n      params.forEach(param => {\n        const rawValue = param.data[2]; // Get the unscaled value (third element in the array [time, scaled value, raw value])\n        // Format the raw value in German style\n        const formattedValue = new Intl.NumberFormat('de-DE').format(rawValue);\n        console.info(\"f\")\n\n        tooltipText += param.marker + param.seriesName + ': ' + formattedValue + '<br/>';\n      });\n      return tooltipText;\n    }\n  },\n  legend: {\n    orient: 'horizontal',\n    left: 'center',\n    bottom: '0%',\n    itemGap: 40,\n    textStyle: {\n      fontSize: 16\n    }\n  },\n  toolbox: {\n    show: false,\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'category',\n    axisLabel: {\n      hideOverlap: true\n    },\n  },\n  yAxis: {\n    show: showYAxis,\n    type: 'value',\n    min: '0',\n    axisLabel: {\n      formatter: function (value) {\n        return value.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\n      }\n    },\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 34,\n    containLabel: true,\n  },\n  series,\n};\n",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "height": 400,
                "name": "default"
              },
              "visualEditor": {
                "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\nEXTRACT(MONTH from time) as month,\nCASE EXTRACT(MONTH from time)\n  WHEN 1 THEN CONCAT('Jan. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 2 THEN CONCAT('Feb. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 3 THEN CONCAT('Mär. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 4 THEN CONCAT('Apr. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 5 THEN CONCAT('Mai. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 6 THEN CONCAT('Jun. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 7 THEN CONCAT('Jul. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 8 THEN CONCAT('Aug. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 9 THEN CONCAT('Sep. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 10 THEN CONCAT('Okt. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 11 THEN CONCAT('Nov. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 12 THEN CONCAT('Dez. ', SUBSTRING(\"$Jahr\",3,3))\nEND as Monat, \n ROUND(SUM(CASE WHEN ageBucket = '13-17' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS reach_13_17_r,\n ROUND(SUM(CASE WHEN ageBucket = '18-24' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS reach_18_24_r,\n ROUND(SUM(CASE WHEN ageBucket = '25-34' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS reach_25_34_r,\n ROUND(SUM(CASE WHEN ageBucket = '35-44' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS reach_35_44_r,\n ROUND(SUM(CASE WHEN ageBucket = '45-54' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS reach_45_54_r,\n ROUND(SUM(CASE WHEN ageBucket = '55-64' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS reach_55_64_r,\n ROUND(SUM(CASE WHEN ageBucket = '65+' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS reach_65_r,\n ROUND(SUM(reach)/COUNT(DISTINCT time)) AS total,\n \"$Skalierung\" as scailing\nFROM\n  `Quintly.facebookInsightsByGenderAndAge`\nWHERE \n --EXTRACT(YEAR from time) = $Jahr\n $Condition\n AND profileId = $facebookId \nGROUP BY\n  Monat, month\nORDER BY \nmonth",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transformations": [
              {
                "id": "filterFieldsByName",
                "options": {
                  "include": {
                    "names": [
                      "Monat",
                      "reach_13_17_r",
                      "reach_18_24_r",
                      "reach_25_34_r",
                      "reach_35_44_r",
                      "reach_45_54_r",
                      "reach_55_64_r",
                      "reach_65_r",
                      "total",
                      "reach_13_17_s",
                      "reach_18_24_s",
                      "reach_25_34_s",
                      "reach_35_44_s",
                      "reach_45_54_s",
                      "reach_55_64_s",
                      "reach_65_s",
                      "scailing",
                      "scailing_addition",
                      "total_s"
                    ]
                  }
                }
              },
              {
                "id": "organize",
                "options": {
                  "excludeByName": {},
                  "indexByName": {},
                  "renameByName": {
                    "reach_13_17": "13-17",
                    "reach_18_24": "18-24",
                    "reach_25_34": "25-34",
                    "reach_35_44": "35-44",
                    "reach_45_54": "45-54",
                    "reach_55_64": "55-64",
                    "reach_65": "65+"
                  }
                }
              },
              {
                "id": "calculateField",
                "options": {
                  "mode": "binary",
                  "reduce": {
                    "reducer": "sum"
                  }
                }
              }
            ],
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          },
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "fieldConfig": {
              "defaults": {},
              "overrides": []
            },
            "gridPos": {
              "h": 16,
              "w": 12,
              "x": 12,
              "y": 74
            },
            "id": 175,
            "options": {
              "baidu": {
                "callback": "bmapReady",
                "key": ""
              },
              "editor": {
                "format": "auto",
                "height": 600
              },
              "editorMode": "code",
              "gaode": {
                "key": "",
                "plugin": "AMap.Scale,AMap.ToolBar"
              },
              "getOption": "const series = context.panel.data.series.flatMap((s) => {\n  const timeValues = s.fields.find((f) => f.name === 'Monat').values;\n  const scailing = s.fields.find((f) => f.name === 'scailing').values[0];\n  const unknown = s.fields.find((f) => f.name === 'unknown_reach_r').values;\n  const female = s.fields.find((f) => f.name === 'female_reach_r').values;\n  const male = s.fields.find((f) => f.name === 'male_reach_r').values;\n  const total = s.fields.find((f) => f.name === 'total').values;\n\n  // Prepare each series data\n  const scaledData = timeValues.map((_, index) => {\n    const totalValue = total[index];\n\n    // If scailing is \"ja\", calculate percentages, otherwise use raw values\n    const unknownValue = scailing === 'Ja' && totalValue > 0 ? (unknown[index] / totalValue) * 100 : unknown[index];\n    const femaleValue = scailing === 'Ja' && totalValue > 0 ? (female[index] / totalValue) * 100 : female[index];\n    const maleValue = scailing === 'Ja' && totalValue > 0 ? (male[index] / totalValue) * 100 : male[index];\n\n    const unknownPercent = (unknown[index] / totalValue) * 100;\n    const femalePercent = (female[index] / totalValue) * 100;\n    const malePercent = (male[index] / totalValue) * 100;\n\n    // Format percentages in German style\n    const formatGerman = (value) => new Intl.NumberFormat('de-DE', { minimumFractionDigits: 1, maximumFractionDigits: 1 }).format(value);\n\n    return {\n      time: timeValues[index],\n      unknown: unknownValue,\n      female: femaleValue,\n      male: maleValue,\n      unknownRaw: unknown[index], // Store raw values for tooltip\n      femaleRaw: female[index],   // Store raw values for tooltip\n      maleRaw: male[index],       // Store raw values for tooltip\n      unknownPercent: formatGerman(unknownPercent) + '%',\n      femalePercent: formatGerman(femalePercent) + '%',\n      malePercent: formatGerman(malePercent) + '%',\n    };\n  });\n\n  // Build the series array\n  return [\n    {\n      name: 'Unbekannt',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: \"rgb(242, 204, 12)\" },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].unknownPercent;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.unknown, item.unknownRaw])  // Include raw values\n    },\n    {\n      name: 'Weiblich',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: \"rgb(196, 22, 42)\" },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].femalePercent;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.female, item.femaleRaw])  // Include raw values\n    },\n    {\n      name: 'Männlich',\n      type: 'bar',\n      stack: 'total',\n      smooth: true,\n      showSymbol: false,\n      itemStyle: { color: \"rgb(31, 96, 196)\" },\n      label: {\n        show: true,\n        position: 'inside',\n        formatter: (params) => {\n          const percent = scaledData[params.dataIndex].malePercent;\n          return parseFloat(percent) > 2.5 ? percent : '';\n        }\n      },\n      data: scaledData.map(item => [item.time, item.male, item.maleRaw])  // Include raw values\n    }\n  ];\n});\n\n\nconst showYAxis = context.panel.data.series.some((s) => s.fields.find((f) => f.name === 'scailing').values[0] === 'Ja') ? false : true;\n\n/**\n * Enable Data Zoom by default\n */\nsetTimeout(() => context.panel.chart.dispatchAction({\n  type: 'takeGlobalCursor',\n  key: 'dataZoomSelect',\n  dataZoomSelectActive: true,\n}), 500);\n\n/**\n * Update Time Range on Zoom\n */\ncontext.panel.chart.on('datazoom', function (params) {\n  const startIndex = params.batch[0]?.startValue;\n  const endIndex = params.batch[0]?.endValue;\n\n  const timeValues = context.panel.data.series[0].fields.find((f) => f.name === 'date').values;\n\n  const startTime = new Date(timeValues[startIndex]).getTime();\n  const endTime = new Date(timeValues[endIndex]).getTime();\n\n  if (!isNaN(startTime) && !isNaN(endTime)) {\n    context.grafana.locationService.partial({ from: startTime, to: endTime });\n  } else {\n    console.error(\"Invalid start or end time:\", { startIndex, endIndex });\n  }\n});\n\nreturn {\n  backgroundColor: 'transparent',\n  tooltip: {\n    trigger: 'axis',\n    axisPointer: {\n      type: 'cross'\n    },\n    formatter: function (params) {\n      let tooltipText = params[0].name + '<br/>';\n      params.forEach(param => {\n        const rawValue = param.data[2]; // Get the unscaled value (third element in the array [time, scaled value, raw value])\n        // Format the raw value in German style\n        const formattedValue = new Intl.NumberFormat('de-DE').format(rawValue);\n\n        tooltipText += param.marker + param.seriesName + ': ' + formattedValue + '<br/>';\n      });\n      return tooltipText;\n    }\n  },\n  legend: {\n    orient: 'horizontal',\n    left: 'center',\n    bottom: '0%',\n    itemGap: 40,\n    textStyle: {\n      fontSize: 16\n    }\n  },\n  toolbox: {\n    show: false,\n    feature: {\n      dataZoom: {\n        yAxisIndex: 'none',\n        icon: {\n          zoom: 'path://',\n          back: 'path://',\n        },\n      },\n      saveAsImage: {},\n    }\n  },\n  xAxis: {\n    type: 'category',\n    axisLabel: {\n      hideOverlap: true\n    },\n  },\n  yAxis: {\n    show: showYAxis,\n    type: 'value',\n    min: '0',\n    axisLabel: {\n      formatter: function (value) {\n        return value.toString().replace(/\\B(?=(\\d{3})+(?!\\d))/g, '.');\n      }\n    },\n  },\n  grid: {\n    left: '2%',\n    right: '2%',\n    top: '2%',\n    bottom: 34,\n    containLabel: true,\n  },\n  series,\n};\n",
              "google": {
                "callback": "gmapReady",
                "key": ""
              },
              "map": "none",
              "renderer": "canvas",
              "themeEditor": {
                "config": "{}",
                "height": 400,
                "name": "default"
              },
              "visualEditor": {
                "code": "return {\n  dataset: context.editor.dataset,\n  series: context.editor.series,\n  xAxis: {\n    type: 'time',\n  },\n  yAxis: {\n    type: 'value',\n    min: 'dataMin',\n  },\n}\n",
                "dataset": [],
                "series": []
              }
            },
            "pluginVersion": "6.1.0",
            "targets": [
              {
                "datasource": {
                  "type": "grafana-bigquery-datasource",
                  "uid": "qUaUqEk4k"
                },
                "editorMode": "code",
                "format": 1,
                "location": "europe-west3",
                "project": "ndr-code-bi-dashboard",
                "rawQuery": true,
                "rawSql": "SELECT\nEXTRACT(MONTH from time) as month,\nCASE EXTRACT(MONTH from time)\n  WHEN 1 THEN CONCAT('Jan. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 2 THEN CONCAT('Feb. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 3 THEN CONCAT('Mär. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 4 THEN CONCAT('Apr. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 5 THEN CONCAT('Mai. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 6 THEN CONCAT('Jun. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 7 THEN CONCAT('Jul. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 8 THEN CONCAT('Aug. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 9 THEN CONCAT('Sep. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 10 THEN CONCAT('Okt. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 11 THEN CONCAT('Nov. ', SUBSTRING(\"$Jahr\",3,3))\n  WHEN 12 THEN CONCAT('Dez. ', SUBSTRING(\"$Jahr\",3,3))\nEND as Monat, \n SUM(reach) as Gesamt,\n ROUND(SUM(CASE WHEN gender = 'Unknown' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS unknown_reach_r,\n ROUND(SUM(CASE WHEN gender = 'Female' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS female_reach_r,\n ROUND(SUM(CASE WHEN gender = 'Male' THEN reach ELSE 0 END)/COUNT(DISTINCT time)) AS male_reach_r,\n ROUND(SUM(reach)/COUNT(DISTINCT time)) as total,\n \"$Skalierung\" as scailing\n\nFROM\n  `Quintly.facebookInsightsByGenderAndAge`\nWHERE \n $Condition\n AND profileId = $facebookId \nGROUP BY\n  Monat, month\nORDER BY \nmonth",
                "refId": "A",
                "sql": {
                  "columns": [
                    {
                      "parameters": [],
                      "type": "function"
                    }
                  ],
                  "groupBy": [
                    {
                      "property": {
                        "type": "string"
                      },
                      "type": "groupBy"
                    }
                  ],
                  "limit": 50
                }
              }
            ],
            "title": "",
            "transformations": [
              {
                "id": "filterFieldsByName",
                "options": {
                  "include": {
                    "names": [
                      "Monat",
                      "total",
                      "unknown_reach_r",
                      "female_reach_r",
                      "male_reach_r",
                      "unknown_reach_s",
                      "female_reach_s",
                      "male_reach_s",
                      "scailing",
                      "scailing_addition",
                      "total_s"
                    ]
                  }
                }
              }
            ],
            "transparent": true,
            "type": "volkovlabs-echarts-panel"
          }
        ],
        "title": "Facebook Ø Pot. Reichweite pro Tag | $Row_Name",
        "type": "row"
      }
    ],
    "preload": false,
    "refresh": "5m",
    "schemaVersion": 40,
    "tags": [],
    "templating": {
      "list": [
        {
          "current": {
            "text": "NDR",
            "value": "NDR"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "includeAll": false,
          "name": "LRA",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT a.LRA\r\nFROM (\r\n  SELECT DISTINCT LRA FROM `ndr-code-bi-dashboard.Quintly.profiles`\r\n) as a\r\nORDER BY (\r\n  CASE\r\n    WHEN REGEXP_CONTAINS(LOWER(\"${__user.email}\"), LOWER(a.LRA))\r\n    THEN 1\r\n    ELSE 0\r\n  END\r\n) DESC",
            "refId": "tempvar",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "type": "query"
        },
        {
          "current": {
            "text": "extra 3",
            "value": "extra 3"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "includeAll": false,
          "name": "Profil",
          "options": [],
          "query": {
            "dataset": "QuintlyTest",
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT a.profile \nFROM \n(SELECT profile FROM `ndr-code-bi-dashboard.Quintly.profiles` WHERE LRA = '$LRA' AND (facebookID > 0 OR instagramID >0 or youtubeID > 0)) as a,\n(SELECT  Profil_FB FROM `ndr-code-bi-dashboard.Quintly.default-settings` WHERE LRA = '$LRA') as b\nORDER BY( \nCASE WHEN a.profile = b.Profil_FB THEN 1\nELSE 2\nEND\n), a.profile ASC",
            "sql": {
              "columns": [
                {
                  "parameters": [
                    {
                      "name": "profile",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            },
            "table": "profileTest"
          },
          "refresh": 1,
          "regex": "",
          "type": "query"
        },
        {
          "current": {
            "text": "None",
            "value": ""
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "lastUpdate",
          "options": [],
          "query": {
            "dataset": "Quintly",
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT \r\nCASE MAX(last_update)\r\n  WHEN NULL THEN \"N/A\"\r\n  ELSE FORMAT_DATETIME(\"%d.%m.%Y | %H:%M Uhr\", DATETIME(MAX(last_update),\"Europe/Berlin\"))\r\n  END\r\nFROM `ndr-code-bi-dashboard.Quintly.facebook`\r\nWHERE profileId = $profileID  ",
            "sql": {
              "columns": [
                {
                  "parameters": [
                    {
                      "name": "last_update",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            },
            "table": "facebookInsightsOwnPosts"
          },
          "refresh": 2,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "10",
            "value": "10"
          },
          "hide": 2,
          "includeAll": false,
          "name": "filled_size_big",
          "options": [
            {
              "selected": true,
              "text": "10",
              "value": "10"
            }
          ],
          "query": "10",
          "skipUrlSync": true,
          "type": "custom"
        },
        {
          "current": {
            "text": "142697",
            "value": "142697"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "facebookId",
          "options": [],
          "query": {
            "dataset": "QuintlyTest",
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CAST(facebookID AS STRING) FROM `ndr-code-bi-dashboard.Quintly.profiles` WHERE profile = '''$Profil''' ",
            "sql": {
              "columns": [
                {
                  "parameters": [
                    {
                      "name": "facebookID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                },
                {
                  "parameters": [
                    {
                      "name": "instagramID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                },
                {
                  "parameters": [
                    {
                      "name": "youtubeID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            },
            "table": "profileTest"
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "13",
            "value": "13"
          },
          "hide": 2,
          "includeAll": false,
          "name": "filled_size",
          "options": [
            {
              "selected": true,
              "text": "13",
              "value": "13"
            }
          ],
          "query": "13",
          "skipUrlSync": true,
          "type": "custom"
        },
        {
          "current": {
            "text": "48",
            "value": "48"
          },
          "hide": 2,
          "includeAll": false,
          "name": "filled_size_headline",
          "options": [
            {
              "selected": true,
              "text": "48",
              "value": "48"
            }
          ],
          "query": "48",
          "skipUrlSync": true,
          "type": "custom"
        },
        {
          "current": {
            "text": "222944",
            "value": "222944"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "instagramId",
          "options": [],
          "query": {
            "dataset": "QuintlyTest",
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CAST(instagramId as STRING) FROM `ndr-code-bi-dashboard.Quintly.profiles` WHERE profile = '''$Profil''' ",
            "sql": {
              "columns": [
                {
                  "parameters": [
                    {
                      "name": "facebookID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                },
                {
                  "parameters": [
                    {
                      "name": "instagramID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                },
                {
                  "parameters": [
                    {
                      "name": "youtubeID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            },
            "table": "profileTest"
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "20",
            "value": "20"
          },
          "hide": 2,
          "includeAll": false,
          "name": "filled_size_headline_small",
          "options": [
            {
              "selected": true,
              "text": "20",
              "value": "20"
            }
          ],
          "query": "20",
          "skipUrlSync": true,
          "type": "custom"
        },
        {
          "current": {
            "text": "231281",
            "value": "231281"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "youtubeId",
          "options": [],
          "query": {
            "dataset": "QuintlyTest",
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CAST(youtubeId AS STRING) FROM `ndr-code-bi-dashboard.Quintly.profiles` WHERE profile = '''$Profil''' ",
            "sql": {
              "columns": [
                {
                  "parameters": [
                    {
                      "name": "facebookID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                },
                {
                  "parameters": [
                    {
                      "name": "instagramID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                },
                {
                  "parameters": [
                    {
                      "name": "youtubeID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            },
            "table": "profileTest"
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "410151",
            "value": "410151"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "tiktokId",
          "options": [],
          "query": {
            "dataset": "QuintlyTest",
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CAST(tiktokId AS STRING) FROM `ndr-code-bi-dashboard.Quintly.profiles` WHERE profile = '''$Profil''' ",
            "refId": "tempvar",
            "sql": {
              "columns": [
                {
                  "parameters": [
                    {
                      "name": "facebookID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                },
                {
                  "parameters": [
                    {
                      "name": "instagramID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                },
                {
                  "parameters": [
                    {
                      "name": "youtubeID",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            },
            "table": "profileTest"
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "2024",
            "value": "2024"
          },
          "includeAll": false,
          "name": "Jahr",
          "options": [
            {
              "selected": false,
              "text": "2022",
              "value": "2022"
            },
            {
              "selected": false,
              "text": "2023",
              "value": "2023"
            },
            {
              "selected": true,
              "text": "2024",
              "value": "2024"
            }
          ],
          "query": "2022, 2023, 2024",
          "type": "custom"
        },
        {
          "current": {
            "text": "10",
            "value": "10"
          },
          "includeAll": false,
          "name": "Zeitraum",
          "options": [
            {
              "selected": false,
              "text": "Januar",
              "value": "1"
            },
            {
              "selected": false,
              "text": "Februar",
              "value": "2"
            },
            {
              "selected": false,
              "text": "März",
              "value": "3"
            },
            {
              "selected": false,
              "text": "April",
              "value": "4"
            },
            {
              "selected": false,
              "text": "Mai",
              "value": "5"
            },
            {
              "selected": false,
              "text": "Juni",
              "value": "6"
            },
            {
              "selected": false,
              "text": "Juli",
              "value": "7"
            },
            {
              "selected": false,
              "text": "August",
              "value": "8"
            },
            {
              "selected": false,
              "text": "September",
              "value": "9"
            },
            {
              "selected": true,
              "text": "Oktober",
              "value": "10"
            },
            {
              "selected": false,
              "text": "November",
              "value": "11"
            },
            {
              "selected": false,
              "text": "Dezember",
              "value": "12"
            },
            {
              "selected": false,
              "text": "1. Quartal",
              "value": "13"
            },
            {
              "selected": false,
              "text": "2. Quartal",
              "value": "14"
            },
            {
              "selected": false,
              "text": "3. Quartal",
              "value": "15"
            },
            {
              "selected": false,
              "text": "4. Quartal",
              "value": "16"
            },
            {
              "selected": false,
              "text": "1. Halbjahr",
              "value": "17"
            },
            {
              "selected": false,
              "text": "2. Halbjahr",
              "value": "18"
            },
            {
              "selected": false,
              "text": "Jahr",
              "value": "19"
            }
          ],
          "query": "Januar : 1, Februar :  2, März : 3, April : 4, Mai : 5, Juni : 6, Juli : 7, August : 8, September : 9, Oktober : 10, November : 11, Dezember : 12,  1. Quartal : 13, 2. Quartal : 14, 3. Quartal : 15, 4. Quartal : 16, 1. Halbjahr : 17, 2. Halbjahr : 18, Jahr : 19",
          "type": "custom"
        },
        {
          "current": {
            "text": "EXTRACT(MONTH from time) = 10 AND EXTRACT(YEAR from time) = 2024",
            "value": "EXTRACT(MONTH from time) = 10 AND EXTRACT(YEAR from time) = 2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "Condition",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT \r\nCASE \r\n    WHEN $Zeitraum = 13 AND CURRENT_DATE() > DATE($Jahr, 03, 31) THEN \"EXTRACT(MONTH from time) >= 1 AND EXTRACT(MONTH from time) <= 3 AND EXTRACT(YEAR from time) = $Jahr\"\r\n    WHEN $Zeitraum = 13 THEN \"EXTRACT(DATE from time) <= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) AND EXTRACT(MONTH from time) >= 1 AND EXTRACT(MONTH from time) <= 3 AND EXTRACT(YEAR from time) = $Jahr\"\r\n    \r\n    WHEN $Zeitraum = 14 AND CURRENT_DATE() > DATE($Jahr, 06, 30) THEN \"EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 6 AND EXTRACT(YEAR from time) = $Jahr\"\r\n    WHEN $Zeitraum = 14 THEN \"EXTRACT(DATE from time) <= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) AND EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 6 AND EXTRACT(YEAR from time) = $Jahr\"\r\n\r\n    WHEN $Zeitraum = 15 AND CURRENT_DATE() > DATE($Jahr, 09, 30) THEN \"EXTRACT(MONTH from time) >= 7 AND EXTRACT(MONTH from time) <= 9 AND EXTRACT(YEAR from time) = $Jahr\"\r\n    WHEN $Zeitraum = 15 THEN \"EXTRACT(DATE from time) <= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) AND EXTRACT(MONTH from time) >= 7 AND EXTRACT(MONTH from time) <= 9 AND EXTRACT(YEAR from time) = $Jahr\"\r\n\r\n    WHEN $Zeitraum = 16 AND CURRENT_DATE() > DATE($Jahr, 12, 31) THEN \"EXTRACT(MONTH from time) >= 10 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = $Jahr\"\r\n    WHEN $Zeitraum = 16 THEN \"EXTRACT(DATE from time) <= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) AND EXTRACT(MONTH from time) >= 10 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = $Jahr\"\r\n\r\n    WHEN $Zeitraum = 17 AND CURRENT_DATE() > DATE($Jahr, 06, 30) THEN \"EXTRACT(MONTH from time) >= 1 AND EXTRACT(MONTH from time) <= 6 AND EXTRACT(YEAR from time) = $Jahr\"\r\n    WHEN $Zeitraum = 17 THEN \"EXTRACT(DATE from time) <= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) AND EXTRACT(MONTH from time) >= 1 AND EXTRACT(MONTH from time) <= 6 AND EXTRACT(YEAR from time) = $Jahr\"\r\n\r\n    WHEN $Zeitraum = 18 AND CURRENT_DATE() > DATE($Jahr, 12, 31) THEN \"EXTRACT(MONTH from time) >= 7 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = $Jahr\"\r\n    WHEN $Zeitraum = 18 THEN \"EXTRACT(DATE from time) <= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) AND EXTRACT(MONTH from time) >= 7 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = $Jahr\"\r\n\r\n    WHEN $Zeitraum = 19 AND CURRENT_DATE() > DATE($Jahr, 12, 31) THEN \"EXTRACT(MONTH from time) >= 1 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = $Jahr\"\r\n    WHEN $Zeitraum = 19 THEN \"EXTRACT(DATE from time) <= DATE_SUB(CURRENT_DATE(), INTERVAL 2 DAY) AND EXTRACT(MONTH from time) >= 1 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = $Jahr\"\r\n    ELSE \"EXTRACT(MONTH from time) = $Zeitraum AND EXTRACT(YEAR from time) = $Jahr\" \r\nEND;\r\n",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "Oktober 2024",
            "value": "Oktober 2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "Row_Name",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE $Zeitraum\r\nWHEN 1 THEN concat(\"Januar \",$Jahr)\r\nWHEN 2 THEN concat(\"Februar\",$Jahr)\r\nWHEN 3 THEN concat(\"März \", $Jahr)\r\nWHEN 4 THEN concat(\"April \", $Jahr)\r\nWHEN 5 THEN concat(\"Mai \", $Jahr)\r\nWHEN 6 THEN concat(\"Juni \", $Jahr)\r\nWHEN 7 THEN concat(\"Juli \", $Jahr)\r\nWHEN 8 THEN concat(\"August \", $Jahr)\r\nWHEN 9 THEN concat(\"September \", $Jahr)\r\nWHEN 10 THEN concat(\"Oktober \", $Jahr)\r\nWHEN 11 THEN concat(\"November \", $Jahr)\r\nWHEN 12 THEN concat(\"Dezember \", $Jahr)\r\nWHEN 13 THEN concat(\"1. Quartal \", $Jahr)\r\nWHEN 14 THEN concat(\"2. Quartal \", $Jahr)\r\nWHEN 15 THEN concat(\"3. Quartal \", $Jahr)\r\nWHEN 16 THEN concat(\"4. Quartal \", $Jahr)\r\nWHEN 17 THEN concat(\"1. Halbjahr \", $Jahr)\r\nWHEN 18 THEN concat(\"2. Halbjahr \", $Jahr)\r\nWHEN 19 THEN concat(\" \", $Jahr) END\r\n",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "2024-01-31",
            "value": "2024-01-31"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "LetzterTagJedesZeitraumes",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE $Zeitraum\r\nWHEN 1 THEN CAST(Date($Jahr,1,31) AS STRING)\r\nWHEN 2 THEN CAST(LAST_DAY(DATE($Jahr,2,1),MONTH) AS STRING)\r\nWHEN 3 THEN CAST(Date($Jahr,1,31) AS STRING)\r\nWHEN 4 THEN CAST(Date($Jahr,1,30) AS STRING)\r\nWHEN 5 THEN CAST(Date($Jahr,1,31) AS STRING)\r\nWHEN 6 THEN CAST(Date($Jahr,1,30) AS STRING)\r\nWHEN 7 THEN CAST(Date($Jahr,1,31) AS STRING)\r\nWHEN 8 THEN CAST(Date($Jahr,1,31) AS STRING)\r\nWHEN 9 THEN CAST(Date($Jahr,1,30) AS STRING)\r\nWHEN 10 THEN CAST(Date($Jahr,1,31) AS STRING)\r\nWHEN 11 THEN CAST(Date($Jahr,1,30) AS STRING)\r\nWHEN 12 THEN CAST(Date($Jahr,1,31) AS STRING)\r\nWHEN 13 THEN CAST(Date($Jahr,3,31) AS STRING)\r\nWHEN 14 THEN CAST(Date($Jahr,6,30) AS STRING)\r\nWHEN 15 THEN CAST(Date($Jahr,9,30) AS STRING)\r\nWHEN 16 THEN CAST(Date($Jahr,12,31) AS STRING)\r\nWHEN 17 THEN CAST(Date($Jahr,6,30) AS STRING)\r\nWHEN 18 THEN CAST(Date($Jahr,12,31) AS STRING)\r\nWHEN 19 THEN CAST(Date($Jahr,12,31) AS STRING) END\r\n",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "EXTRACT(DATE from time) = LAST_DAY(DATE(2024,10,01))",
            "value": "EXTRACT(DATE from time) = LAST_DAY(DATE(2024,10,01))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "FollowerCondition",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT \r\nCASE \r\n    -- 1.Quartal\r\n    WHEN $Zeitraum = 13 AND CURRENT_DATE() > LAST_DAY(DATE($Jahr,03,01)) THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,03,01))\"\r\n    WHEN $Zeitraum = 13 AND CURRENT_DATE() >= DATE($Jahr,03,05) THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n    WHEN $Zeitraum = 13 THEN \"EXTRACT(DATE from time) =  LAST_DAY(DATE($Jahr,03,01))\"\r\n\r\n    -- 2.Quartal\r\n    WHEN $Zeitraum = 14 AND CURRENT_DATE() > LAST_DAY(DATE($Jahr,06,01)) THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,06,01))\"\r\n    WHEN $Zeitraum = 14 AND CURRENT_DATE() >= DATE($Jahr,04,05) THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n    WHEN $Zeitraum = 14 THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,06,01))\"\r\n\r\n    -- 3.Quartal\r\n    WHEN $Zeitraum = 15 AND CURRENT_DATE() > LAST_DAY(DATE($Jahr,09,01)) THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,09,01))\"\r\n    WHEN $Zeitraum = 15 AND CURRENT_DATE() >= DATE($Jahr,07,05) THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n    WHEN $Zeitraum = 15 THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,12,01))\"\r\n\r\n    -- 4.Quartal\r\n    WHEN $Zeitraum = 16 AND CURRENT_DATE() > LAST_DAY(DATE($Jahr,12,01)) THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,12,01))\"\r\n    WHEN $Zeitraum = 16 AND CURRENT_DATE() >= DATE($Jahr,10,05) THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n    WHEN $Zeitraum = 16 THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,12,01))\"\r\n\r\n    --1.Halbjahr\r\n    WHEN $Zeitraum = 17 AND CURRENT_DATE() > LAST_DAY(DATE($Jahr,06,01)) THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,06,01))\"\r\n    WHEN $Zeitraum = 17 AND CURRENT_DATE() < DATE($Jahr,06,06) THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n    WHEN $Zeitraum = 17 THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n\r\n    -- 2.Halbjahr\r\n    WHEN $Zeitraum = 18 AND CURRENT_DATE() > LAST_DAY(DATE($Jahr,12,01)) THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,12,01))\"\r\n    WHEN $Zeitraum = 18 AND CURRENT_DATE() >= DATE($Jahr,6,05) THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n    WHEN $Zeitraum = 18 THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,12,01))\"\r\n\r\n    -- Jahr\r\n    WHEN $Zeitraum = 19 AND $Jahr >= EXTRACT(YEAR from CURRENT_DATE()) AND CURRENT_DATE() > DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY) THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n    WHEN $Zeitraum = 19 AND $Jahr >= EXTRACT(YEAR from CURRENT_DATE()) THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n    WHEN $Zeitraum = 19 AND $Jahr <= EXTRACT(YEAR from CURRENT_DATE()) THEN \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,12,01))\"\r\n\r\n    -- All other months\r\n    ELSE \r\n        CASE\r\n            WHEN CURRENT_DATE() <= LAST_DAY(DATE($Jahr,$Zeitraum,01)) AND CURRENT_DATE() >= DATE($Jahr,$Zeitraum,05) THEN \"EXTRACT(DATE from time) = DATE_SUB(CURRENT_DATE(), INTERVAL 4 DAY)\"\r\n            ELSE \"EXTRACT(DATE from time) = LAST_DAY(DATE($Jahr,$Zeitraum,01))\"\r\n        END\r\nEND;\r\n",
            "refId": "tempvar",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "7233251",
            "value": "7233251"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "youtubeViews",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CAST(SUM(views) AS STRING)\n\nFROM\n  `ndr-code-bi-dashboard.Quintly.youtubeAnalytics`\nWHERE\n  $Condition \n  AND profileId = $youtubeId \n\n",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "type": "query"
        },
        {
          "current": {
            "text": "Nein",
            "value": "Nein"
          },
          "includeAll": false,
          "name": "Skalierung",
          "options": [
            {
              "selected": true,
              "text": "Nein",
              "value": "Nein"
            },
            {
              "selected": false,
              "text": "Ja",
              "value": "Ja"
            }
          ],
          "query": "Nein, Ja",
          "type": "custom"
        },
        {
          "current": {
            "text": "01.10.2024-31.10.2024",
            "value": "01.10.2024-31.10.2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "nutzungszeitraum",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH last_day_of_zeitraum AS (\r\nSELECT CASE $Zeitraum\r\nWHEN 1 THEN Date($Jahr,1,31)\r\nWHEN 2 THEN LAST_DAY(DATE($Jahr,2,1),MONTH)\r\nWHEN 3 THEN Date($Jahr,3,31)\r\nWHEN 4 THEN Date($Jahr,4,30)\r\nWHEN 5 THEN Date($Jahr,5,31)\r\nWHEN 6 THEN Date($Jahr,6,30)\r\nWHEN 7 THEN Date($Jahr,7,31)\r\nWHEN 8 THEN Date($Jahr,8,31)\r\nWHEN 9 THEN Date($Jahr,9,30)\r\nWHEN 10 THEN Date($Jahr,10,31)\r\nWHEN 11 THEN Date($Jahr,11,30)\r\nWHEN 12 THEN Date($Jahr,12,31)\r\nWHEN 13 THEN Date($Jahr,3,31)\r\nWHEN 14 THEN Date($Jahr,6,30)\r\nWHEN 15 THEN Date($Jahr,9,30)\r\nWHEN 16 THEN Date($Jahr,12,31)\r\nWHEN 17 THEN Date($Jahr,6,30)\r\nWHEN 18 THEN Date($Jahr,12,31)\r\nWHEN 19 THEN Date($Jahr,12,31) END AS lastdayofzeitraum\r\n), first_day_of_zeitraum AS (\r\nSELECT CASE $Zeitraum\r\nWHEN 1 THEN Date($Jahr,1,1)\r\nWHEN 2 THEN LAST_DAY(DATE($Jahr,2,1),MONTH)\r\nWHEN 3 THEN Date($Jahr,3,1)\r\nWHEN 4 THEN Date($Jahr,4,1)\r\nWHEN 5 THEN Date($Jahr,5,1)\r\nWHEN 6 THEN Date($Jahr,6,1)\r\nWHEN 7 THEN Date($Jahr,7,1)\r\nWHEN 8 THEN Date($Jahr,8,1)\r\nWHEN 9 THEN Date($Jahr,9,1)\r\nWHEN 10 THEN Date($Jahr,10,1)\r\nWHEN 11 THEN Date($Jahr,11,1)\r\nWHEN 12 THEN Date($Jahr,12,1)\r\nWHEN 13 THEN Date($Jahr,1,1)\r\nWHEN 14 THEN Date($Jahr,4,1)\r\nWHEN 15 THEN Date($Jahr,7,1)\r\nWHEN 16 THEN Date($Jahr,10,1)\r\nWHEN 17 THEN Date($Jahr,1,1)\r\nWHEN 18 THEN Date($Jahr,7,1)\r\nWHEN 19 THEN Date($Jahr,1,1) END AS firstdayofzeitraum\r\n)\r\nSELECT CASE\r\nWHEN firstdayofzeitraum > CURRENT_DATE() THEN \"noch nicht abgeschlossen\"\r\nWHEN lastdayofzeitraum > CURRENT_DATE() THEN CONCAT( FORMAT_DATE('%d.%m.%Y', firstdayofzeitraum), \"-\" , FORMAT_DATE('%d.%m.%Y', DATE_SUB(CURRENT_DATE, INTERVAL 2 DAY))) \r\nELSE CONCAT( FORMAT_DATE('%d.%m.%Y', firstdayofzeitraum), \"-\" , FORMAT_DATE('%d.%m.%Y', lastdayofzeitraum)) END AS nutzungszeitraum\r\nFROM last_day_of_zeitraum, first_day_of_zeitraum",
            "refId": "tempvar",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "type": "query"
        },
        {
          "current": {
            "text": "01.10.2024-31.10.2024",
            "value": "01.10.2024-31.10.2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "nutzungszeitraum_yt",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH last_day_of_zeitraum AS (\r\nSELECT CASE $Zeitraum\r\nWHEN 1 THEN Date($Jahr,1,31)\r\nWHEN 2 THEN LAST_DAY(DATE($Jahr,2,1),MONTH)\r\nWHEN 3 THEN Date($Jahr,3,31)\r\nWHEN 4 THEN Date($Jahr,4,30)\r\nWHEN 5 THEN Date($Jahr,5,31)\r\nWHEN 6 THEN Date($Jahr,6,30)\r\nWHEN 7 THEN Date($Jahr,7,31)\r\nWHEN 8 THEN Date($Jahr,8,31)\r\nWHEN 9 THEN Date($Jahr,9,30)\r\nWHEN 10 THEN Date($Jahr,10,31)\r\nWHEN 11 THEN Date($Jahr,11,30)\r\nWHEN 12 THEN Date($Jahr,12,31)\r\nWHEN 13 THEN Date($Jahr,3,31)\r\nWHEN 14 THEN Date($Jahr,6,30)\r\nWHEN 15 THEN Date($Jahr,9,30)\r\nWHEN 16 THEN Date($Jahr,12,31)\r\nWHEN 17 THEN Date($Jahr,6,30)\r\nWHEN 18 THEN Date($Jahr,12,31)\r\nWHEN 19 THEN Date($Jahr,12,31) END AS lastdayofzeitraum\r\n), first_day_of_zeitraum AS (\r\nSELECT CASE $Zeitraum\r\nWHEN 1 THEN Date($Jahr,1,1)\r\nWHEN 2 THEN DATE($Jahr,2,1)\r\nWHEN 3 THEN Date($Jahr,3,1)\r\nWHEN 4 THEN Date($Jahr,4,1)\r\nWHEN 5 THEN Date($Jahr,5,1)\r\nWHEN 6 THEN Date($Jahr,6,1)\r\nWHEN 7 THEN Date($Jahr,7,1)\r\nWHEN 8 THEN Date($Jahr,8,1)\r\nWHEN 9 THEN Date($Jahr,9,1)\r\nWHEN 10 THEN Date($Jahr,10,1)\r\nWHEN 11 THEN Date($Jahr,11,1)\r\nWHEN 12 THEN Date($Jahr,12,1)\r\nWHEN 13 THEN Date($Jahr,1,1)\r\nWHEN 14 THEN Date($Jahr,4,1)\r\nWHEN 15 THEN Date($Jahr,7,1)\r\nWHEN 16 THEN Date($Jahr,10,1)\r\nWHEN 17 THEN Date($Jahr,1,1)\r\nWHEN 18 THEN Date($Jahr,7,1)\r\nWHEN 19 THEN Date($Jahr,1,1) END AS firstdayofzeitraum\r\n)\r\nSELECT CASE\r\nWHEN firstdayofzeitraum > CURRENT_DATE() THEN \"noch nicht abgeschlossen\"\r\nWHEN lastdayofzeitraum > CURRENT_DATE() THEN CONCAT( FORMAT_DATE('%d.%m.%Y', firstdayofzeitraum), \"-\" , FORMAT_DATE('%d.%m.%Y', DATE_SUB(CURRENT_DATE, INTERVAL 2 DAY))) \r\nELSE CONCAT( FORMAT_DATE('%d.%m.%Y', firstdayofzeitraum), \"-\" , FORMAT_DATE('%d.%m.%Y', lastdayofzeitraum)) END AS nutzungszeitraum\r\nFROM last_day_of_zeitraum, first_day_of_zeitraum",
            "refId": "tempvar",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "type": "query"
        },
        {
          "current": {
            "text": "31.10.2024",
            "value": "31.10.2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "name": "stichtag_ig",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH last_day_of_zeitraum AS (\r\nSELECT CASE $Zeitraum\r\nWHEN 1 THEN Date($Jahr,1,31)\r\nWHEN 2 THEN LAST_DAY(DATE($Jahr,2,1),MONTH)\r\nWHEN 3 THEN Date($Jahr,3,31)\r\nWHEN 4 THEN Date($Jahr,4,30)\r\nWHEN 5 THEN Date($Jahr,5,31)\r\nWHEN 6 THEN Date($Jahr,6,30)\r\nWHEN 7 THEN Date($Jahr,7,31)\r\nWHEN 8 THEN Date($Jahr,8,31)\r\nWHEN 9 THEN Date($Jahr,9,30)\r\nWHEN 10 THEN Date($Jahr,10,31)\r\nWHEN 11 THEN Date($Jahr,11,30)\r\nWHEN 12 THEN Date($Jahr,12,31)\r\nWHEN 13 THEN Date($Jahr,3,31)\r\nWHEN 14 THEN Date($Jahr,6,30)\r\nWHEN 15 THEN Date($Jahr,9,30)\r\nWHEN 16 THEN Date($Jahr,12,31)\r\nWHEN 17 THEN Date($Jahr,6,30)\r\nWHEN 18 THEN Date($Jahr,12,31)\r\nWHEN 19 THEN Date($Jahr,12,31) END AS lastdayofzeitraum\r\n), first_day_of_zeitraum AS (\r\nSELECT CASE $Zeitraum\r\nWHEN 1 THEN Date($Jahr,1,1)\r\nWHEN 2 THEN LAST_DAY(DATE($Jahr,2,1),MONTH)\r\nWHEN 3 THEN Date($Jahr,3,1)\r\nWHEN 4 THEN Date($Jahr,4,1)\r\nWHEN 5 THEN Date($Jahr,5,1)\r\nWHEN 6 THEN Date($Jahr,6,1)\r\nWHEN 7 THEN Date($Jahr,7,1)\r\nWHEN 8 THEN Date($Jahr,8,1)\r\nWHEN 9 THEN Date($Jahr,9,1)\r\nWHEN 10 THEN Date($Jahr,10,1)\r\nWHEN 11 THEN Date($Jahr,11,1)\r\nWHEN 12 THEN Date($Jahr,12,1)\r\nWHEN 13 THEN Date($Jahr,1,1)\r\nWHEN 14 THEN Date($Jahr,4,1)\r\nWHEN 15 THEN Date($Jahr,7,1)\r\nWHEN 16 THEN Date($Jahr,10,1)\r\nWHEN 17 THEN Date($Jahr,1,1)\r\nWHEN 18 THEN Date($Jahr,7,1)\r\nWHEN 19 THEN Date($Jahr,1,1) END AS firstdayofzeitraum\r\n)\r\n--SELECT * FROM last_day_of_zeitraum\r\nSELECT CASE\r\nWHEN firstdayofzeitraum > CURRENT_DATE() THEN \"noch nicht abgeschlossen\"\r\nWHEN lastdayofzeitraum > CURRENT_DATE() THEN  FORMAT_DATE('%d.%m.%Y', DATE_SUB(CURRENT_DATE, INTERVAL 4 DAY))\r\nELSE  FORMAT_DATE('%d.%m.%Y', lastdayofzeitraum) END AS stichtag\r\nFROM last_day_of_zeitraum, first_day_of_zeitraum",
            "refId": "tempvar",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "type": "query"
        }
      ]
    },
    "time": {
      "from": "now",
      "to": "now"
    },
    "timepicker": {
      "hidden": true
    },
    "timezone": "",
    "title": "Soziodemographische Daten with Tiktok",
    "uid": "ee5w6vzci3ev4f",
    "version": 6,
    "weekStart": ""
  }
}

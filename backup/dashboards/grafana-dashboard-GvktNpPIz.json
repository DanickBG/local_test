{
  "meta": {
    "type": "db",
    "canSave": true,
    "canEdit": true,
    "canAdmin": true,
    "canStar": true,
    "canDelete": true,
    "slug": "social-media-report-facebook",
    "url": "/d/GvktNpPIz/social-media-report-facebook",
    "expires": "0001-01-01T00:00:00Z",
    "created": "2024-07-29T12:41:50Z",
    "updated": "2024-09-26T11:44:10Z",
    "updatedBy": "bernd kuch dev",
    "createdBy": "Anonymous",
    "version": 14,
    "hasAcl": false,
    "isFolder": false,
    "folderId": 1534,
    "folderUid": "adyyp08i5hedcd",
    "folderTitle": "Archive_delete_30-11-2024",
    "folderUrl": "/dashboards/f/adyyp08i5hedcd/archive-delete-30-11-2024",
    "provisioned": false,
    "provisionedExternalId": "",
    "annotationsPermissions": {
      "dashboard": {
        "canAdd": true,
        "canEdit": true,
        "canDelete": true
      },
      "organization": {
        "canAdd": true,
        "canEdit": true,
        "canDelete": true
      }
    }
  },
  "dashboard": {
    "annotations": {
      "list": [
        {
          "builtIn": 1,
          "datasource": {
            "type": "grafana",
            "uid": "-- Grafana --"
          },
          "enable": true,
          "hide": true,
          "iconColor": "rgba(0, 211, 255, 1)",
          "name": "Annotations & Alerts",
          "target": {
            "limit": 100,
            "matchAny": false,
            "tags": [],
            "type": "dashboard"
          },
          "type": "dashboard"
        }
      ]
    },
    "editable": true,
    "fiscalYearStartMonth": 0,
    "graphTooltip": 0,
    "id": 1252,
    "links": [],
    "liveNow": false,
    "panels": [
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 5,
          "w": 24,
          "x": 0,
          "y": 0
        },
        "id": 113,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "<div style=\"background-color:rgba(38, 113, 198);color: white; text-align:center; vertical-align: middle; padding:20px 0; margin-top:0px; font-size: 15pt;\">\n<font color=\"#FFFFFF\">Dashboard-Anpassungen aufgrund von Änderungen bei Facebook: Aktive Nutzer und Interaktionen werden bis einschließlich März 2024 auf Page Ebene ausgewiesen, ab April 2024 wurden sie ersetzt durch die Werte auf Post Ebene.<br>\n</div>",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 4,
          "w": 16,
          "x": 0,
          "y": 5
        },
        "id": 107,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "# 📊 Hinweis\n\n- Durch nachträgliche Importe und Speicherung der Daten kann es im Vergleich mit anderen Stichtags-Erhebungen (z.B. den Berichten der Medienforschungen) Abweichungen bei den Daten geben",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "#f5f5f500",
              "mode": "fixed"
            },
            "displayName": "Aktive Nutzer:innen",
            "mappings": [],
            "noValue": "Nur zur ARD-internen Verwendung!",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green",
                  "value": null
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": []
        },
        "gridPos": {
          "h": 2,
          "w": 4,
          "x": 16,
          "y": 5
        },
        "id": 103,
        "options": {
          "colorMode": "background",
          "graphMode": "none",
          "justifyMode": "center",
          "orientation": "auto",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [],
            "fields": "",
            "values": false
          },
          "showPercentChange": false,
          "text": {
            "titleSize": 2,
            "valueSize": 15
          },
          "textMode": "value_and_name",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "dataset": "Quintly",
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [
                    {
                      "name": "total_video_10s_views",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            },
            "table": "facebookInsightsOwnVideos"
          }
        ],
        "transformations": [
          {
            "id": "convertFieldType",
            "options": {
              "conversions": [
                {
                  "destinationType": "number",
                  "targetField": "Videostarts"
                }
              ],
              "fields": {}
            }
          },
          {
            "id": "organize",
            "options": {
              "excludeByName": {},
              "indexByName": {},
              "renameByName": {
                "Videostarts": "∑ Videostarts"
              }
            }
          }
        ],
        "transparent": true,
        "type": "stat"
      },
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 2,
          "w": 4,
          "x": 20,
          "y": 5
        },
        "id": 51,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "Letzter Datenstand: </br>\n${stichtagmonat}\n\n",
          "mode": "html"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 2,
          "w": 10,
          "x": 0,
          "y": 9
        },
        "id": 58,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "# Facebook Report | ${Month} ${Jahr}\n\n",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 11
        },
        "id": 10,
        "panels": [],
        "title": "Entwicklung: Potenzielle Reichweite",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "palette-classic"
            },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "auto",
              "fillOpacity": 80,
              "gradientMode": "hue",
              "hideFrom": {
                "legend": false,
                "tooltip": false,
                "viz": false
              },
              "lineWidth": 1,
              "scaleDistribution": {
                "type": "linear"
              },
              "thresholdsStyle": {
                "mode": "off"
              }
            },
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green",
                  "value": null
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "month_year"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "time: MMM YY"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRBigband"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#FF6600",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRKultur"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#861C18",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRHamburg"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#9A1D2C",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRFernsehen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#034081",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Visite"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#F34307",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NeuesausBuettenwarder"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#909CC1",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRaufmLand"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#7AB86B",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Panorama"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#52B0ED",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRRadiophilharmonie"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#3AB0C1",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRElbphilharmonieOrchester"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#5BB9AB",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Schorse"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#C14C07",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InasNacht"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#BFBFBF",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "RuterausderSpassbeginnt"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#588FC0",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "WirsinddieFreeses"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#BD2C57",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRTalkShow"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#9D8760",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "DASimNDRFernsehen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#B7281E",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Sesamstrasse"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#EBD608",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRMecklenburgVorpommern"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#007282",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRSport"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#1453A1",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRInfo"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0075BD",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRNiedersachsen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#F27D00",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ZAPPDasMedienmagazin"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#54403E",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDR2"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#C53527",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NJOY"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#A0B21E",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "EurovisionSongContest"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#073372",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRde"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0D1755",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRSchleswigHolstein"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#437BD0",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "extra3"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#29C347",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Rest"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#7F7F7F",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Brisant"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#ff2302",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MeineSchlagerwelt"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#c4464e",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "UnserDorfhatWochenende"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#1b4062",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "BIWAKTV"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#cdaf7d",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Tierischtierisch"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#18b44f",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ECHT"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "b12b40",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "SputnikSpringbreak"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#d78f36",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRselbstbestimmt"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#dd7709",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSatkula"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#6fb218",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InallerFreundschaft"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#adbfaf",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "DasGipfeltreffen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#2b2a29",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSerbja"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#6aa412",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRInvestigativ"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#fb073a",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "DerstarkeOsten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0286db",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ElefantTigerCo"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#e4b320",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRJUMP"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#02e49a",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Riverboat"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#6c1e6a",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRGarten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#e9ffea",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Spasszone"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#3142d0",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "WissenschafftFakten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#1fa9ad",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRTHUERINGEN"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0061ae",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDR"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0061ae",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRKultur"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#f4ac04",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRAktuell"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#275c74",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRKlassik"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#8f1e94",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSPUTNIK"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#e74344",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "SportimOsten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#fb6e04",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MEDIEN360G"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#171c31",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSACHSEN"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#83ba35",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSACHSENANHALT"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#75b525",
                    "mode": "fixed"
                  }
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 14,
          "w": 16,
          "x": 0,
          "y": 12
        },
        "id": 59,
        "options": {
          "barRadius": 0,
          "barWidth": 0.85,
          "fullHighlight": false,
          "groupWidth": 0.7,
          "legend": {
            "calcs": [],
            "displayMode": "list",
            "placement": "bottom",
            "showLegend": true
          },
          "orientation": "auto",
          "showValue": "never",
          "stacking": "normal",
          "tooltip": {
            "mode": "multi",
            "sort": "none"
          },
          "xField": "month_year",
          "xTickLabelRotation": -45,
          "xTickLabelSpacing": 0
        },
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "DECLARE profiles STRING;\r\nSET profiles = (\"$query1\");\r\nEXECUTE IMMEDIATE format(\"\"\"WITH filter_month_profiles as (SELECT\r\n   REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(profile,'-',''),' ',''),',',''),'ä','ae'),'Ä','Ae'),'ö','oe'),'Ö','Oe'),'ü','ue'),'Ü','Ue'),'.',''),'!',''),'&',''),\"'\",\"\"),'#',''),'🍀',''),'ß','ss') as profile,\r\n   SUM(page_impressions_unique)/COUNT(distinct time) AS impressionsUnique,\r\n   CONCAT(EXTRACT(MONTH from time),'-',EXTRACT(YEAR from time)) as month_year\r\n FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` AS facebook\r\n JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles\r\n   ON facebook.profileId = profiles.facebookID\r\n WHERE profiles.LRA = \"$LRA\"\r\n  AND $Zeitraum\r\n  AND page_follows IS NOT NULL\r\n GROUP BY profile, month_year), filter_month_top_profiles as (\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique,\r\n   ROW_NUMBER() OVER (PARTITION BY month_year ORDER BY impressionsUnique DESC) AS profile_rank\r\n FROM filter_month_profiles\r\n), filter_month_top_8_profiles AS (\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique\r\n FROM filter_month_top_profiles\r\n WHERE profile IN ($query1)\r\n ), filter_month_rest AS (\r\n SELECT\r\n   month_year,\r\n   'Rest' AS profile,\r\n   SUM(impressionsUnique) AS impressionsUnique\r\n FROM filter_month_top_profiles\r\n WHERE profile NOT IN ($query1)\r\n GROUP BY month_year\r\n), filter_month_top_8_rest_profiles AS (\r\n  SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique\r\n FROM filter_month_top_8_profiles\r\n UNION ALL\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique\r\n FROM filter_month_rest\r\n ORDER BY month_year DESC, profile\r\n),privous_months_profiles AS (\r\n SELECT\r\n   CONCAT(EXTRACT(MONTH from time),'-',EXTRACT(YEAR from time)) as month_year,\r\n   REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(profile,'-',''),' ',''),',',''),'ä','ae'),'Ä','Ae'),'ö','oe'),'Ö','Oe'),'ü','ue'),'Ü','Ue'),'.',''),'!',''),'&',''),\"'\",\"\"),'#',''),'🍀',''),'ß','ss') as profile,\r\n   CASE \"${Monat:text}\"\r\n   WHEN \"Jahr\" THEN 0\r\n   ELSE SUM(page_impressions_unique)/COUNT(distinct time) END AS impressionsUnique\r\n FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` AS facebook\r\n JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles\r\n   ON facebook.profileId = profiles.facebookID\r\n WHERE profiles.LRA = \"$LRA\"\r\n   AND True\r\n   AND CASE \"${Monat:text}\"\r\n      WHEN \"Jahr\" THEN EXTRACT(YEAR FROM time) = $Jahr  \r\n      ELSE EXTRACT(DATE FROM time) >= DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 YEAR) AND EXTRACT(DATE FROM time) <= LAST_DAY(DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH), MONTH)\r\n      END\r\n GROUP BY profile, month_year\r\n), privous_months_top_8_profiles AS (\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique\r\n FROM privous_months_profiles\r\n WHERE profile IN ($query1)\r\n ), privous_months_rest AS (\r\n SELECT\r\n   month_year,\r\n   'Rest' AS profile,\r\n   SUM(impressionsUnique) AS impressionsUnique\r\n FROM privous_months_profiles\r\n WHERE profile NOT IN ($query1)\r\n GROUP BY month_year), privous_months_top_8_rest_profiles AS (\r\n  SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique\r\n FROM privous_months_top_8_profiles\r\n UNION ALL\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique\r\n FROM privous_months_rest\r\n ORDER BY month_year DESC, profile)\r\n--SELECT * FROM privous_months_top_8_rest_profiles\r\nSELECT\r\n*\r\nFROM (\r\n SELECT\r\n   DATE(CAST(SPLIT(month_year, '-')[OFFSET(1)] AS INT64), CAST(SPLIT(month_year, '-')[OFFSET(0)] AS INT64), 1) as month_year,\r\n   FORMAT_DATE('%%B %%Y', DATE(CAST(SPLIT(month_year, '-')[OFFSET(1)] AS INT64), CAST(SPLIT(month_year, '-')[OFFSET(0)] AS INT64), 1)) AS formatted_date,\r\n   profile,\r\n   ROUND(impressionsUnique) as impressionsUnique\r\n FROM filter_month_top_8_rest_profiles\r\n UNION ALL\r\n SELECT\r\n   DATE(CAST(SPLIT(month_year, '-')[OFFSET(1)] AS INT64), CAST(SPLIT(month_year, '-')[OFFSET(0)] AS INT64), 1) as month_year,\r\n   FORMAT_DATE('%%B %%Y', DATE(CAST(SPLIT(month_year, '-')[OFFSET(1)] AS INT64), CAST(SPLIT(month_year, '-')[OFFSET(0)] AS INT64), 1)) AS formatted_date,\r\n   profile,\r\n   ROUND(impressionsUnique) as impressionsUnique\r\n FROM privous_months_top_8_rest_profiles\r\n ORDER BY month_year DESC, profile\r\n)\r\nPIVOT (\r\n  SUM(impressionsUnique) FOR profile IN (%s)\r\n)\r\nORDER BY DATE(month_year) ASC\r\n\"\"\", profiles);\r\n\r\n\r\n\r\n",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transformations": [
          {
            "id": "groupBy",
            "options": {
              "fields": {
                "month": {
                  "aggregations": []
                }
              }
            }
          },
          {
            "id": "convertFieldType",
            "options": {
              "conversions": [
                {
                  "destinationType": "time",
                  "targetField": "month_year"
                }
              ],
              "fields": {}
            }
          },
          {
            "id": "filterFieldsByName",
            "options": {
              "include": {
                "pattern": "^(?!.*formatted_date).*$"
              }
            }
          }
        ],
        "transparent": true,
        "type": "barchart"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "palette-classic"
            },
            "custom": {
              "hideFrom": {
                "legend": false,
                "tooltip": false,
                "viz": false
              }
            },
            "mappings": [],
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "NDRBigband"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#FF6600",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRKultur"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#861C18",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRHamburg"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#9A1D2C",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRFernsehen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#034081",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Visite"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#F34307",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NeuesausBuettenwarder"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#909CC1",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRaufmLand"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#7AB86B",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Panorama"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#52B0ED",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRRadiophilharmonie"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#3AB0C1",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRElbphilharmonieOrchester"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#5BB9AB",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Schorse"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#C14C07",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InasNacht"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#BFBFBF",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "RuterausderSpassbeginnt"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#588FC0",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "WirsinddieFreeses"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#BD2C57",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRTalkShow"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#9D8760",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "DASimNDRFernsehen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#B7281E",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Sesamstrasse"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#EBD608",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRMecklenburgVorpommern"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#007282",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRSport"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#1453A1",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRInfo"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0075BD",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRNiedersachsen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#F27D00",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ZAPPDasMedienmagazin"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#54403E",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDR2"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#C53527",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NJOY"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#A0B21E",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "EurovisionSongContest"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#073372",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRde"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0D1755",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRSchleswigHolstein"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#437BD0",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "extra3"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#29C347",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Rest"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#7F7F7F",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Brisant"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#ff2302",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MeineSchlagerwelt"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#c4464e",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "UnserDorfhatWochenende"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#1b4062",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "BIWAKTV"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#cdaf7d",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Tierischtierisch"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#18b44f",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ECHT"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "b12b40",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "SputnikSpringbreak"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#d78f36",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRselbstbestimmt"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#dd7709",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSatkula"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#6fb218",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InallerFreundschaft"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#adbfaf",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "DasGipfeltreffen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#2b2a29",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSerbja"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#6aa412",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRInvestigativ"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#fb073a",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "DerstarkeOsten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0286db",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ElefantTigerCo"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#e4b320",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRJUMP"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#02e49a",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Riverboat"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#6c1e6a",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRGarten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#e9ffea",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Spasszone"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#3142d0",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "WissenschafftFakten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#1fa9ad",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRTHUERINGEN"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0061ae",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDR"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0061ae",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRKultur"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#f4ac04",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRAktuell"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#275c74",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRKlassik"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#8f1e94",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSPUTNIK"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#e74344",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "SportimOsten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#fb6e04",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MEDIEN360G"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#171c31",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSACHSEN"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#83ba35",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSACHSENANHALT"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#75b525",
                    "mode": "fixed"
                  }
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 13,
          "w": 8,
          "x": 16,
          "y": 12
        },
        "id": 56,
        "options": {
          "displayLabels": [
            "percent"
          ],
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "showLegend": true,
            "values": [
              "percent"
            ]
          },
          "pieType": "pie",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "values": true
          },
          "tooltip": {
            "mode": "single",
            "sort": "none"
          }
        },
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH filter_month_profiles as (SELECT\r\n   REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(profile,'-',''),' ',''),',',''),'ä','ae'),'Ä','Ae'),'ö','oe'),'Ö','Oe'),'ü','ue'),'Ü','Ue'),'.',''),'!',''),'&',''),\"'\",\"\"),'#',''),'🍀',''),'ß','ss') as profile,\r\n   SUM(page_impressions_unique) AS impressionsUnique,\r\n      CASE \"${Monat:text}\"\r\n      WHEN \"Jahr\" THEN \"year\"\r\n      ELSE CONCAT(EXTRACT(MONTH from time),'-',EXTRACT(YEAR from time)) \r\n      END\r\n    as month_year,\r\n    count(DISTINCT time) as days,\r\n FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` AS facebook\r\n JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles\r\n   ON facebook.profileId = profiles.facebookID\r\n WHERE profiles.LRA = \"$LRA\"\r\n      AND $Zeitraum \r\n       AND page_follows IS NOT NULL\r\n GROUP BY profile, month_year), filter_month_top_profiles as (\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique,\r\n   ROW_NUMBER() OVER (PARTITION BY month_year ORDER BY impressionsUnique DESC) AS profile_rank,\r\n   days\r\n FROM filter_month_profiles\r\n), filter_month_top_8_profiles AS (\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique,\r\n  days \r\n  FROM filter_month_top_profiles\r\n WHERE profile_rank <= 8\r\n ), filter_month_rest AS (\r\n SELECT\r\n   month_year,\r\n   'Rest' AS profile,\r\n   SUM(impressionsUnique) AS impressionsUnique, \r\n   MAX(days) as days,\r\n FROM filter_month_top_profiles\r\n WHERE profile_rank > 8\r\n GROUP BY month_year\r\n), filter_month_top_8_rest_profiles AS (\r\n  SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique,\r\n   days\r\n FROM filter_month_top_8_profiles\r\n UNION ALL\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   impressionsUnique, \r\n   days\r\n FROM filter_month_rest\r\n ORDER BY month_year DESC, profile\r\n)\r\nSELECT profile, ROUND(impressionsUnique/(days)) as impressionsUnique FROM filter_month_top_8_rest_profiles",
            "refId": "Top 8 profiles",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Anteil Top 8 + Rest | $Monat $Jahr",
        "transparent": true,
        "type": "piechart"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 26
        },
        "id": 8,
        "panels": [],
        "title": "Entwicklung: Interaktionen",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "dark-blue",
              "mode": "fixed"
            },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "auto",
              "fillOpacity": 70,
              "gradientMode": "hue",
              "hideFrom": {
                "legend": false,
                "tooltip": false,
                "viz": false
              },
              "lineWidth": 1,
              "scaleDistribution": {
                "type": "linear"
              },
              "thresholdsStyle": {
                "mode": "off"
              }
            },
            "decimals": 2,
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "month"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "time: MMM YY"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "interactionsMill"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Interaktionen (Mio.)"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "decimals",
                  "value": 1
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "month"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Monat"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 13,
          "w": 9,
          "x": 0,
          "y": 27
        },
        "id": 20,
        "options": {
          "barRadius": 0,
          "barWidth": 0.8,
          "fullHighlight": false,
          "groupWidth": 0.7,
          "legend": {
            "calcs": [],
            "displayMode": "list",
            "placement": "bottom",
            "showLegend": false
          },
          "orientation": "vertical",
          "showValue": "auto",
          "stacking": "none",
          "text": {
            "valueSize": 15
          },
          "tooltip": {
            "mode": "multi",
            "sort": "none"
          },
          "xField": "month",
          "xTickLabelRotation": -45,
          "xTickLabelSpacing": 0
        },
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH insights_values AS(SELECT\r\n  SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + \r\n  page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + \r\n  page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger +\r\n  page_positive_feedback_by_type_comment + page_positive_feedback_by_type_link,0))/1000000 as interactionsMill,\r\n\r\n  DATE(EXTRACT(YEAR from time),EXTRACT(MONTH from time), 1) as month\r\n  \r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n-- Daten des ausgewählten Zeitraums minus 1 Jahr\r\nWHERE CASE $Monat WHEN 13 THEN EXTRACT(YEAR FROM time) = $Jahr ELSE (DATE(EXTRACT(YEAR from time),EXTRACT(MONTH from time), 1) <= DATE($Jahr, $Monat, 1) AND DATE(EXTRACT(YEAR from time),EXTRACT(MONTH from time), 1)  >= DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 12 MONTH)) END\r\nGROUP BY month\r\nORDER BY month ASC),\r\nownposts_values AS(\r\n  SELECT\r\n  sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger + post_activity_by_action_type_share + post_activity_by_action_type_comment,0))/1000000 as interactionsMill,\r\n\r\n  DATE(EXTRACT(YEAR from time),EXTRACT(MONTH from time), 1) as month\r\n  \r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n-- Daten des ausgewählten Zeitraums minus 1 Jahr\r\nWHERE CASE $Monat WHEN 13 THEN EXTRACT(YEAR FROM time) = $Jahr ELSE (DATE(EXTRACT(YEAR from time),EXTRACT(MONTH from time), 1) <= DATE($Jahr, $Monat, 1) AND DATE(EXTRACT(YEAR from time),EXTRACT(MONTH from time), 1)  >= DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 12 MONTH)) END\r\nGROUP BY month\r\nORDER BY month ASC\r\n),\r\njoined_values AS(\r\n  SELECT insights_values.month as month, insights_values.interactionsMill as interactionsMillInsights, ownposts_values.interactionsMill as interactionsMillOwnPosts  FROM insights_values\r\n  JOIN ownposts_values\r\n  ON insights_values.month = ownposts_values.month\r\n)\r\nSELECT CASE\r\nWHEN month < DATE(2024,4,1) THEN interactionsMillInsights\r\nELSE interactionsMillOwnPosts END AS interactionsMill,\r\nmonth\r\nFROM joined_values\r\nORDER BY month ASC",
            "refId": "Summe Interaktionen",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Summe Interaktionen $LRA Profile in Mio.",
        "transparent": true,
        "type": "barchart"
      },
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 2,
          "w": 9,
          "x": 9,
          "y": 27
        },
        "id": 30,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "### Zusammensetzung Interaktionen | ${Monat:text}  ${Jahr} \n",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 2,
          "w": 6,
          "x": 18,
          "y": 27
        },
        "id": 94,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "### Interaktionen in Mio.\n",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "palette-classic"
            },
            "custom": {
              "hideFrom": {
                "legend": false,
                "tooltip": false,
                "viz": false
              }
            },
            "mappings": [],
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Reaktionen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "purple",
                    "mode": "fixed"
                  }
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 11,
          "w": 7,
          "x": 9,
          "y": 29
        },
        "id": 23,
        "options": {
          "displayLabels": [
            "percent"
          ],
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "showLegend": true,
            "values": [
              "percent"
            ]
          },
          "pieType": "pie",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "values": false
          },
          "tooltip": {
            "mode": "single",
            "sort": "none"
          }
        },
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nSUM(Reaktionen) as Reaktionen,\r\nSUM(Kommentare) as Kommentare,\r\nSUM(Shares) as Shares\r\nFROM(\r\nSELECT\r\n  $reactions as Reaktionen,\r\n\r\n  $comments as Kommentare,\r\n\r\n  $shares as Shares, --Zählen diese als shares?,\r\n  \r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset}${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nAND $interaction_Zeitraum\r\nUNION ALL\r\nSELECT \r\n$reactions_year_2024 as Reaktionen,\r\n\r\n$comments_year_2024 as Kommentare,\r\n\r\n$shares_year_2024 as Shares\r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024)\r\n",
            "refId": "Zusammensetzung Interaktionen",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "piechart"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "gridPos": {
          "h": 2,
          "w": 2,
          "x": 16,
          "y": 29
        },
        "id": 90,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "#f5f5f5",
              "mode": "fixed"
            },
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            }
          },
          "overrides": []
        },
        "gridPos": {
          "h": 2,
          "w": 6,
          "x": 18,
          "y": 29
        },
        "id": 69,
        "options": {
          "colorMode": "background",
          "graphMode": "area",
          "justifyMode": "auto",
          "orientation": "auto",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "/.*/",
            "values": false
          },
          "showPercentChange": false,
          "text": {
            "valueSize": 30
          },
          "textMode": "value",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CONCAT(REPEAT(\" \", $filled_size_headline - CHAR_LENGTH('Summe')), 'Summe')\r\nFROM(\r\nSELECT 'Summe' as Gesamt\r\n)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "type": "stat"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "gridPos": {
          "h": 3,
          "w": 2,
          "x": 16,
          "y": 31
        },
        "id": 91,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "## $Monat_abkuerzung\r\n## $Jahr",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CONCAT(REPEAT(\" \", $filled_size_headline - CHAR_LENGTH(CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))), CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))\r\nFROM(\r\nSELECT CONCAT(\"$Monat_abkuerzung\", \" $Jahr\") as Gesamt\r\n)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "#f5f5f5",
              "mode": "fixed"
            },
            "decimals": 3,
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "red"
                },
                {
                  "color": "green",
                  "value": 0
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "lm_interactions"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "${Month} ${Jahr}"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "lm_interactionsPerDay"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "decimals",
                  "value": 3
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 3,
          "w": 6,
          "x": 18,
          "y": 31
        },
        "id": 27,
        "options": {
          "colorMode": "value",
          "graphMode": "area",
          "justifyMode": "auto",
          "orientation": "vertical",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "values": false
          },
          "showPercentChange": false,
          "textMode": "value",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "  SELECT SUM(lm_interactions)/1000000 as lm_interactions,\r\n  FROM(\r\n  SELECT\r\n  ($reactions + $comments + $shares) as lm_interactions,\r\n  \r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset}${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  AND $interaction_Zeitraum\r\n  -- should this stay for facebookInsights????\r\n  --AND page_follows is not null\r\n  UNION ALL\r\n  SELECT \r\n  $reactions_year_2024 + $comments_year_2024 + $shares_year_2024 as lm_interactions,\r\n\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024)\r\n\r\n",
            "refId": "Interaktionen",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "stat"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "gridPos": {
          "h": 3,
          "w": 2,
          "x": 16,
          "y": 34
        },
        "id": 95,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "${Vergleich}",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CONCAT(REPEAT(\" \", $filled_size_headline - CHAR_LENGTH(CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))), CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))\r\nFROM(\r\nSELECT CONCAT(\"$Monat_abkuerzung\", \" $Jahr\") as Gesamt\r\n)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "decimals": 3,
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "red"
                },
                {
                  "color": "green",
                  "value": 0
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "diff_mil"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Zum Vormonat"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 0
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "diff_per_day"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 0
                },
                {
                  "id": "displayName",
                  "value": "Ø-Tag"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 3,
          "w": 6,
          "x": 18,
          "y": 34
        },
        "id": 61,
        "options": {
          "colorMode": "value",
          "graphMode": "area",
          "justifyMode": "auto",
          "orientation": "vertical",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "/.*/",
            "values": false
          },
          "showPercentChange": false,
          "textMode": "value",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "DECLARE Monat INT64;\r\nSET Monat = $Monat;\r\n\r\nIF Monat = 13 THEN \r\n  EXECUTE IMMEDIATE \"SELECT '' \";\r\nELSE \r\n  EXECUTE IMMEDIATE \"\"\"\r\n    WITH past_value_in_mil AS (\r\n      SELECT\r\n        ($reactions_last_month + $comments_last_month + $shares_last_month) / 1000000 AS past_sum_in_mil\r\n      FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset_last_month}${table_suffix}` AS facebook\r\n      JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = '$LRA')\r\n      WHERE EXTRACT(MONTH FROM time) = EXTRACT(MONTH FROM DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)) \r\n        AND EXTRACT(YEAR FROM time) = EXTRACT(YEAR FROM DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH))\r\n    ),\r\n    current_value_in_mil AS (\r\n      SELECT\r\n        ($reactions + $comments + $shares) / 1000000 AS current_sum_in_mil\r\n      FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset}${table_suffix}` AS facebook\r\n      JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = '$LRA')\r\n      WHERE EXTRACT(MONTH FROM time) = $Monat AND EXTRACT(YEAR FROM time) = $Jahr\r\n    )\r\n\r\n    SELECT (current_sum_in_mil / past_sum_in_mil - 1) * 100 AS diff_mil, \r\n    FROM past_value_in_mil, current_value_in_mil\r\n  \"\"\";\r\nEND IF;\r\n",
            "refId": "Interaktionen Vormonat",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "stat"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "gridPos": {
          "h": 3,
          "w": 2,
          "x": 16,
          "y": 37
        },
        "id": 96,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "## $Monat_abkuerzung\r\n## $LastJahr",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CONCAT(REPEAT(\" \", $filled_size_headline - CHAR_LENGTH(CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))), CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))\r\nFROM(\r\nSELECT CONCAT(\"$Monat_abkuerzung\", \" $Jahr\") as Gesamt\r\n)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "decimals": 3,
            "mappings": [],
            "noValue": "N/A",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "red"
                },
                {
                  "color": "green",
                  "value": 0
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "diff_mil"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Zum Vorjahresmonat"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 0
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "diff_per_day"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 0
                },
                {
                  "id": "displayName",
                  "value": "Ø-Tag"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 3,
          "w": 6,
          "x": 18,
          "y": 37
        },
        "id": 62,
        "options": {
          "colorMode": "value",
          "graphMode": "area",
          "justifyMode": "auto",
          "orientation": "vertical",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "values": false
          },
          "showPercentChange": false,
          "textMode": "value",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH past_value_in_mil AS(\r\n  SELECT SUM(lm_interactions)/1000000 as past_sum_in_mil,\r\n  FROM(\r\n  SELECT\r\n  ($reactions_last_year + $comments_last_year + $shares_last_year) as lm_interactions,\r\n  \r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset_last_year}${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  AND $interaction_last_year_Zeitraum\r\n  -- should this stay for facebookInsights????\r\n  --AND page_follows is not null\r\n  UNION ALL\r\n  SELECT \r\n  $reactions_year_2024 + $comments_year_2024 + $shares_year_2024 as lm_interactions,\r\n\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024)\r\n), current_value_in_mil AS(\r\n  SELECT SUM(lm_interactions)/1000000 as current_sum_in_mil,\r\n  FROM(\r\n  SELECT\r\n  ($reactions + $comments + $shares) as lm_interactions,\r\n  \r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset}${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  AND $interaction_Zeitraum\r\n  -- should this stay for facebookInsights????\r\n  --AND page_follows is not null\r\n  UNION ALL\r\n  SELECT \r\n  $reactions_year_2024 + $comments_year_2024 + $shares_year_2024 as lm_interactions,\r\n\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024)\r\n)\r\nSELECT (current_sum_in_mil/past_sum_in_mil - 1)*100 as diff_mil FROM past_value_in_mil, current_value_in_mil",
            "refId": "Interaktionen Vorjahr",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "stat"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 40
        },
        "id": 32,
        "panels": [],
        "title": "Entwicklung: 10 Sek. Videostarts",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "dark-blue",
              "mode": "fixed"
            },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "auto",
              "fillOpacity": 70,
              "gradientMode": "hue",
              "hideFrom": {
                "legend": false,
                "tooltip": false,
                "viz": false
              },
              "lineWidth": 1,
              "scaleDistribution": {
                "type": "linear"
              },
              "thresholdsStyle": {
                "mode": "off"
              }
            },
            "decimals": 2,
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "month"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "time: MMM YY"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10sMill"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Videostarts ab 10 Sek. (Mio.)"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "decimals",
                  "value": 1
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "month"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Monat"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 13,
          "w": 9,
          "x": 0,
          "y": 41
        },
        "id": 25,
        "options": {
          "barRadius": 0,
          "barWidth": 0.8,
          "fullHighlight": false,
          "groupWidth": 0.7,
          "legend": {
            "calcs": [],
            "displayMode": "list",
            "placement": "bottom",
            "showLegend": false
          },
          "orientation": "vertical",
          "showValue": "auto",
          "stacking": "none",
          "text": {
            "valueSize": 15
          },
          "tooltip": {
            "mode": "multi",
            "sort": "none"
          },
          "xField": "month",
          "xTickLabelRotation": -45,
          "xTickLabelSpacing": 0
        },
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\n  SUM(IFNULL(page_video_views_10s,0))/1000000 as videoViews10sMill,\r\n  DATE(EXTRACT(YEAR from time),EXTRACT(MONTH from time), 1) as month,\r\n \r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE CASE $Monat WHEN 13 THEN EXTRACT(YEAR FROM time) = $Jahr ELSE (DATE(EXTRACT(YEAR from time),EXTRACT(MONTH from time), 1) <= DATE($Jahr, $Monat, 1) AND DATE(EXTRACT(YEAR from time),EXTRACT(MONTH from time), 1)  >= DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 12 MONTH)) END\r\nGROUP BY month\r\nORDER BY month ASC",
            "refId": "Summe Videostarts (10 Sek.)",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Summe Videostarts (10 Sek.) $LRA Profile in Mio.",
        "transparent": true,
        "type": "barchart"
      },
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 2,
          "w": 9,
          "x": 9,
          "y": 41
        },
        "id": 33,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "### Anteil Videostarts (10 Sek.) Top 8 | ${Monat:text} ${Jahr}\n",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 2,
          "w": 6,
          "x": 18,
          "y": 41
        },
        "id": 99,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "### Videostarts in Mio.\n",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "palette-classic"
            },
            "custom": {
              "hideFrom": {
                "legend": false,
                "tooltip": false,
                "viz": false
              }
            },
            "mappings": [],
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "NDRBigband"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#FF6600",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRKultur"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#861C18",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRHamburg"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#9A1D2C",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRFernsehen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#034081",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Visite"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#F34307",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NeuesausBuettenwarder"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#909CC1",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRaufmLand"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#7AB86B",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Panorama"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#52B0ED",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRRadiophilharmonie"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#3AB0C1",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRElbphilharmonieOrchester"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#5BB9AB",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Schorse"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#C14C07",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InasNacht"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#BFBFBF",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "RuterausderSpassbeginnt"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#588FC0",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "WirsinddieFreeses"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#BD2C57",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRTalkShow"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#9D8760",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "DASimNDRFernsehen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#B7281E",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Sesamstrasse"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#EBD608",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRMecklenburgVorpommern"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#007282",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRSport"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#1453A1",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRInfo"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0075BD",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRNiedersachsen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#F27D00",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ZAPPDasMedienmagazin"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#54403E",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDR2"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#C53527",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NJOY"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#A0B21E",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "EurovisionSongContest"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#073372",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRde"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0D1755",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "NDRSchleswigHolstein"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#437BD0",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "extra3"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#29C347",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Rest"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#7F7F7F",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Brisant"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#ff2302",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MeineSchlagerwelt"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#c4464e",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "UnserDorfhatWochenende"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#1b4062",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "BIWAKTV"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#cdaf7d",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Tierischtierisch"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#18b44f",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ECHT"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "b12b40",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "SputnikSpringbreak"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#d78f36",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRselbstbestimmt"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#dd7709",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSatkula"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#6fb218",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InallerFreundschaft"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#adbfaf",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "DasGipfeltreffen"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#2b2a29",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSerbja"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#6aa412",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRInvestigativ"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#fb073a",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "DerstarkeOsten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0286db",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ElefantTigerCo"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#e4b320",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRJUMP"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#02e49a",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Riverboat"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#6c1e6a",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRGarten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#e9ffea",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Spasszone"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#3142d0",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "WissenschafftFakten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#1fa9ad",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRTHUERINGEN"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0061ae",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDR"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#0061ae",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRKultur"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#f4ac04",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRAktuell"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#275c74",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRKlassik"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#8f1e94",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSPUTNIK"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#e74344",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "SportimOsten"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#fb6e04",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MEDIEN360G"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#171c31",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSACHSEN"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#83ba35",
                    "mode": "fixed"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "MDRSACHSENANHALT"
              },
              "properties": [
                {
                  "id": "color",
                  "value": {
                    "fixedColor": "#75b525",
                    "mode": "fixed"
                  }
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 11,
          "w": 7,
          "x": 9,
          "y": 43
        },
        "id": 24,
        "options": {
          "displayLabels": [
            "percent"
          ],
          "legend": {
            "displayMode": "table",
            "placement": "right",
            "showLegend": true,
            "values": [
              "percent"
            ]
          },
          "pieType": "pie",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "values": true
          },
          "tooltip": {
            "mode": "single",
            "sort": "none"
          }
        },
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH filter_month_profiles as (SELECT\r\n   REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(profile,'-',''),' ',''),',',''),'ä','ae'),'Ä','Ae'),'ö','oe'),'Ö','Oe'),'ü','ue'),'Ü','Ue'),'.',''),'!',''),'&',''),\"'\",\"\"),'#',''),'🍀',''),'ß','ss') as profile,\r\n   SUM(IFNULL(page_video_views_10s,0)) as videoViews10s,\r\n   SUM(page_impressions_unique) AS impressionsUnique,\r\n      CASE \"${Monat:text}\"\r\n      WHEN \"Jahr\" THEN \"year\"\r\n      ELSE CONCAT(EXTRACT(MONTH from time),'-',EXTRACT(YEAR from time)) \r\n      END\r\n    as month_year,\r\n FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` AS facebook\r\n JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles\r\n   ON facebook.profileId = profiles.facebookID\r\n WHERE profiles.LRA = \"$LRA\"\r\n  AND  $Zeitraum\r\n GROUP BY profile, month_year), filter_month_top_profiles as (\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   videoViews10s,\r\n   ROW_NUMBER() OVER (PARTITION BY month_year ORDER BY videoViews10s DESC) AS profile_rank\r\n FROM filter_month_profiles\r\n), filter_month_top_8_profiles AS (\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   videoViews10s\r\n FROM filter_month_top_profiles\r\n WHERE profile_rank <= 8\r\n ), filter_month_rest AS (\r\n SELECT\r\n   month_year,\r\n   'Rest' AS profile,\r\n   SUM(videoViews10s) AS videoViews10s\r\n FROM filter_month_top_profiles\r\n WHERE profile_rank > 8\r\n GROUP BY month_year\r\n), filter_month_top_8_rest_profiles AS (\r\n  SELECT\r\n   month_year,\r\n   profile,\r\n   videoViews10s\r\n FROM filter_month_top_8_profiles\r\n UNION ALL\r\n SELECT\r\n   month_year,\r\n   profile,\r\n   videoViews10s\r\n FROM filter_month_rest\r\n ORDER BY month_year DESC, profile\r\n)\r\nSELECT profile, videoViews10s FROM filter_month_top_8_rest_profiles\r\n\r\n\r\n\r\n",
            "refId": "Anteil Videostarts",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "piechart"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "gridPos": {
          "h": 2,
          "w": 2,
          "x": 16,
          "y": 43
        },
        "id": 98,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "#f5f5f5",
              "mode": "fixed"
            },
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            }
          },
          "overrides": []
        },
        "gridPos": {
          "h": 2,
          "w": 3,
          "x": 18,
          "y": 43
        },
        "id": 73,
        "options": {
          "colorMode": "background",
          "graphMode": "area",
          "justifyMode": "auto",
          "orientation": "auto",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "/.*/",
            "values": false
          },
          "showPercentChange": false,
          "text": {
            "valueSize": 30
          },
          "textMode": "value",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CONCAT(REPEAT(\" \", $filled_size_headline - CHAR_LENGTH('Summe')), 'Summe')\r\nFROM(\r\nSELECT 'Summe' as Gesamt\r\n)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "type": "stat"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "#f5f5f5",
              "mode": "fixed"
            },
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            }
          },
          "overrides": []
        },
        "gridPos": {
          "h": 2,
          "w": 3,
          "x": 21,
          "y": 43
        },
        "id": 75,
        "options": {
          "colorMode": "background",
          "graphMode": "area",
          "justifyMode": "auto",
          "orientation": "auto",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "/.*/",
            "values": false
          },
          "showPercentChange": false,
          "text": {
            "valueSize": 30
          },
          "textMode": "value",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CONCAT(REPEAT(\" \", $filled_size_headline - CHAR_LENGTH('Ø Pro Tag')), 'Ø Pro Tag')\r\nFROM(\r\nSELECT 'Ø Pro Tag' as Gesamt\r\n)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "type": "stat"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "gridPos": {
          "h": 3,
          "w": 2,
          "x": 16,
          "y": 45
        },
        "id": 97,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "## $Monat_abkuerzung\r\n## $Jahr",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CONCAT(REPEAT(\" \", $filled_size_headline - CHAR_LENGTH(CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))), CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))\r\nFROM(\r\nSELECT CONCAT(\"$Monat_abkuerzung\", \" $Jahr\") as Gesamt\r\n)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "#f5f5f5",
              "mode": "fixed"
            },
            "decimals": 3,
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10sMill"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Videostarts in Mio."
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "decimals",
                  "value": 1
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10sMillPerDay"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Ø-Tag"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "decimals",
                  "value": 3
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 3,
          "w": 6,
          "x": 18,
          "y": 45
        },
        "id": 28,
        "options": {
          "colorMode": "value",
          "graphMode": "area",
          "justifyMode": "auto",
          "orientation": "vertical",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "values": false
          },
          "showPercentChange": false,
          "textMode": "value",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nvideoViews10sMill,\r\nvideoViews10sMill/(days) as videoViews10sMillPerDay\r\nFROM\r\n(SELECT\r\nSUM(IFNULL(page_video_views_10s,0))/1000000 as videoViews10sMill,\r\nCOUNT(distinct time) as days,\r\n\r\n \r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE True\r\nAND $Zeitraum\r\n)",
            "refId": "Videostarts",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "stat"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "gridPos": {
          "h": 3,
          "w": 2,
          "x": 16,
          "y": 48
        },
        "id": 100,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "${Vergleich}",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CONCAT(REPEAT(\" \", $filled_size_headline - CHAR_LENGTH(CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))), CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))\r\nFROM(\r\nSELECT CONCAT(\"$Monat_abkuerzung\", \" $Jahr\") as Gesamt\r\n)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "decimals": 3,
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "red"
                },
                {
                  "color": "green",
                  "value": 0
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "diff_mil"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Zum Vormonat."
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 0
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "diff_per_day"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Ø-Tag"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 0
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 3,
          "w": 6,
          "x": 18,
          "y": 48
        },
        "id": 65,
        "options": {
          "colorMode": "value",
          "graphMode": "area",
          "justifyMode": "auto",
          "orientation": "vertical",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "/.*/",
            "values": false
          },
          "showPercentChange": false,
          "textMode": "value",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH past_value_in_mil AS (\r\n  SELECT\r\n  SUM(IFNULL(page_video_views_10s,0))/1000000 as past_sum_in_mil,\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE True\r\n  AND CASE $Monat\r\n  WHEN 13 THEN True\r\n  ELSE EXTRACT(MONTH from time) = EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) AND EXTRACT(YEAR from time) = EXTRACT(YEAR from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) END\r\n), past_value_per_day AS (\r\n  SELECT past_sum_in_mil/$number_of_days_last_month as past_sum_per_day\r\n  FROM past_value_in_mil\r\n), current_value_in_mil AS(\r\n  SELECT\r\n  SUM(IFNULL(page_video_views_10s,0))/1000000 as current_sum_in_mil,\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE True\r\n  AND EXTRACT(MONTH from time) = $Monat AND EXTRACT(YEAR from time) = $Jahr\r\n), current_value_per_day AS(\r\n  SELECT current_sum_in_mil/$number_of_days as current_sum_per_day\r\n  FROM current_value_in_mil\r\n)\r\nSELECT (current_sum_in_mil/past_sum_in_mil - 1)*100 as diff_mil, (current_sum_per_day/past_sum_per_day - 1)*100 as diff_per_day FROM past_value_in_mil, current_value_in_mil, current_value_per_day, past_value_per_day",
            "refId": "Interaktionen Vormonat",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "stat"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "gridPos": {
          "h": 3,
          "w": 2,
          "x": 16,
          "y": 51
        },
        "id": 101,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "## $Monat_abkuerzung\r\n## $LastJahr",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CONCAT(REPEAT(\" \", $filled_size_headline - CHAR_LENGTH(CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))), CONCAT(\"$Monat_abkuerzung\", \" $Jahr\"))\r\nFROM(\r\nSELECT CONCAT(\"$Monat_abkuerzung\", \" $Jahr\") as Gesamt\r\n)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "decimals": 3,
            "mappings": [],
            "noValue": "N/A",
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "red"
                },
                {
                  "color": "green",
                  "value": 0
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "diff_mil"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Zum Vorjahresmonat"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 0
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "diff_per_day"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 0
                },
                {
                  "id": "displayName",
                  "value": "Ø-Tag"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 3,
          "w": 6,
          "x": 18,
          "y": 51
        },
        "id": 67,
        "options": {
          "colorMode": "value",
          "graphMode": "area",
          "justifyMode": "auto",
          "orientation": "vertical",
          "percentChangeColorMode": "standard",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "values": false
          },
          "showPercentChange": false,
          "textMode": "value",
          "wideLayout": true
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH past_value_in_mil AS (\r\n  SELECT\r\n  SUM(IFNULL(page_video_views_10s,0))/1000000 as past_sum_in_mil,\r\n  COUNT(DISTINCT time) as time,\r\n  FROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE True\r\n  AND  CASE \"${Monat:text}\" WHEN \"Jahr\" THEN EXTRACT(YEAR from time) = $Jahr -1 ELSE EXTRACT(MONTH from time) = $Monat AND EXTRACT(YEAR from time) = $Jahr-1 END\r\n), past_value_per_day AS (\r\n  --SELECT past_sum_in_mil/(DATE_DIFF(LAST_DAY(DATE_SUB(DATE($Jahr,$Monat,1),INTERVAL 1 YEAR),MONTH),DATE_SUB(DATE($Jahr,$Monat,1),INTERVAL 1 YEAR),DAY) + 1) as past_sum_per_day\r\n  SELECT past_sum_in_mil/time as past_sum_per_day\r\n  FROM past_value_in_mil\r\n), current_value_in_mil AS(\r\n  SELECT\r\n  SUM(IFNULL(page_video_views_10s,0))/1000000 as current_sum_in_mil,\r\n  COUNT(DISTINCT time) as time,\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE True\r\n  AND $Zeitraum\r\n), current_value_per_day AS(\r\n  SELECT current_sum_in_mil/(time) as current_sum_per_day\r\n  FROM current_value_in_mil\r\n)\r\nSELECT (current_sum_in_mil/past_sum_in_mil - 1)*100 as diff_mil, (current_sum_per_day/past_sum_per_day - 1)*100 as diff_per_day FROM past_value_in_mil, current_value_in_mil, current_value_per_day, past_value_per_day",
            "refId": "Interaktionen Vorjahr",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "transparent": true,
        "type": "stat"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 54
        },
        "id": 12,
        "panels": [],
        "title": "Aktive Nutzer & Potenzielle Reichweite |  ${Monat} ${Jahr}",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "dark-blue",
              "mode": "fixed"
            },
            "mappings": [],
            "min": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "engaged_users_PerDay"
              },
              "properties": [
                {
                  "id": "displayName"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 24,
          "w": 11,
          "x": 0,
          "y": 55
        },
        "id": 18,
        "options": {
          "displayMode": "gradient",
          "maxVizHeight": 300,
          "minVizHeight": 20,
          "minVizWidth": 0,
          "namePlacement": "auto",
          "orientation": "horizontal",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "limit": 100,
            "values": true
          },
          "showUnfilled": false,
          "sizing": "auto",
          "valueMode": "color"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "\r\n  SELECT COALESCE(CAST(ROUND(SAFE_DIVIDE(SUM(engaged_users),SUM(num_day_or_post))) as INT64),0) as engaged_users_PerDay,\r\n  profile as Profil\r\n  FROM(\r\n\r\n  SELECT\r\n  $aktive_nutzer_record as engaged_users,\r\n  $aktive_nutzer_post_or_day as num_day_or_post,\r\n  profile\r\n  \r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset}${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  AND $interaction_Zeitraum\r\n  AND $aktive_nutzer_condition\r\n  GROUP BY profile\r\n\r\n  UNION ALL\r\n  SELECT\r\n  $aktive_nutzer_record_year_2024 as engaged_users,\r\n  $aktive_nutzer_year_2024 as num_day_or_post,\r\n  profile\r\n\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024\r\n  AND post_impressions_unique IS NOT NULL\r\n  GROUP BY profile)\r\n  GROUP BY profile\r\n  ORDER BY engaged_users_PerDay desc",
            "refId": "Aktive Nutzer Tagesmittel",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Ø Aktive Nutzer $post_or_tag | $Monat $Jahr",
        "transparent": true,
        "type": "bargauge"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "dark-blue",
              "mode": "fixed"
            },
            "mappings": [],
            "min": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "impressions_unique_PerDay"
              },
              "properties": [
                {
                  "id": "displayName"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 24,
          "w": 13,
          "x": 11,
          "y": 55
        },
        "id": 35,
        "options": {
          "displayMode": "gradient",
          "maxVizHeight": 300,
          "minVizHeight": 20,
          "minVizWidth": 0,
          "namePlacement": "auto",
          "orientation": "horizontal",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "limit": 100,
            "values": true
          },
          "showUnfilled": false,
          "sizing": "auto",
          "valueMode": "color"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCAST(ROUND(SUM(page_impressions_unique)/(COUNT(facebook.time))) as INT64) as impressions_unique_PerDay ,\r\nprofile as Profil\r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND $Zeitraum\r\nAND page_follows is not null\r\nGROUP BY profile\r\nORDER BY impressions_unique_PerDay desc\r\n",
            "refId": "Potenzielle Reichweite im Tagesmittel",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Ø Potenzielle Reichweite pro Tag | $Monat $Jahr",
        "transparent": true,
        "type": "bargauge"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 79
        },
        "id": 14,
        "panels": [],
        "title": "Follower | ${Monat} ${Jahr}",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "dark-blue",
              "mode": "fixed"
            },
            "mappings": [],
            "min": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "followers"
              },
              "properties": [
                {
                  "id": "displayName"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 28,
          "w": 16,
          "x": 0,
          "y": 80
        },
        "id": 34,
        "options": {
          "displayMode": "gradient",
          "maxVizHeight": 300,
          "minVizHeight": 20,
          "minVizWidth": 0,
          "namePlacement": "auto",
          "orientation": "horizontal",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "limit": 100,
            "values": true
          },
          "showUnfilled": false,
          "sizing": "auto",
          "valueMode": "color"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nprofile as Profil,\r\npage_follows as followers,\r\ntime\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE True\r\nAND time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\n            WHERE $Zeitraum AND page_follows IS not null AND page_follows > 1000)\r\n\r\n\r\nORDER BY followers desc",
            "refId": "Follower",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Follower | Stichtag: $Stichtag",
        "transparent": true,
        "type": "bargauge"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "red",
              "mode": "thresholds"
            },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "auto",
              "fillOpacity": 80,
              "gradientMode": "hue",
              "hideFrom": {
                "legend": false,
                "tooltip": false,
                "viz": false
              },
              "lineWidth": 1,
              "scaleDistribution": {
                "type": "linear"
              },
              "thresholdsStyle": {
                "mode": "off"
              }
            },
            "decimals": 2,
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "red"
                },
                {
                  "color": "green",
                  "value": 0
                }
              ]
            },
            "unit": "percent"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "FollowerVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Follower Veränderung"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 28,
          "w": 8,
          "x": 16,
          "y": 80
        },
        "id": 60,
        "options": {
          "barRadius": 0,
          "barWidth": 0.7,
          "colorByField": "FollowerVeraenderung",
          "fullHighlight": false,
          "groupWidth": 0.7,
          "legend": {
            "calcs": [],
            "displayMode": "list",
            "placement": "bottom",
            "showLegend": false
          },
          "orientation": "horizontal",
          "showValue": "always",
          "stacking": "none",
          "text": {
            "valueSize": 15
          },
          "tooltip": {
            "mode": "multi",
            "sort": "none"
          },
          "xField": "Profil",
          "xTickLabelRotation": 0,
          "xTickLabelSpacing": 0
        },
        "pluginVersion": "9.2.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT \r\nlm.Profil,\r\n(lm_follower/llm_follower - 1)*100 as FollowerVeraenderung\r\nFROM\r\n(SELECT\r\npage_follows lm_follower,\r\nprofile as Profil\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\n            WHERE $Zeitraum and page_follows is not null AND page_follows >1000)\r\n\r\nORDER BY page_follows desc) as lm\r\nLEFT JOIN\r\n(SELECT\r\npage_follows as llm_follower,\r\nprofile as Profil\r\nFROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\n            WHERE CASE \"${Monat:text}\" WHEN \"Jahr\" THEN EXTRACT(YEAR from time) = $Jahr -1 ELSE EXTRACT(MONTH from time) = EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) AND EXTRACT(YEAR from time) = EXTRACT(YEAR from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) END)\r\n\r\nORDER BY page_follows desc) as llm ON llm.Profil = lm.Profil\r\nORDER BY lm.lm_follower DESC",
            "refId": "Follower-Veränderung",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Veränderung zum ${Vormonat} in %",
        "transparent": true,
        "type": "barchart"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 108
        },
        "id": 16,
        "panels": [],
        "title": "Videostarts |  ${Monat} ${Jahr}",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "dark-blue",
              "mode": "fixed"
            },
            "mappings": [],
            "min": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10s"
              },
              "properties": [
                {
                  "id": "displayName"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 23,
          "w": 12,
          "x": 0,
          "y": 109
        },
        "id": 36,
        "options": {
          "displayMode": "gradient",
          "maxVizHeight": 300,
          "minVizHeight": 20,
          "minVizWidth": 0,
          "namePlacement": "auto",
          "orientation": "horizontal",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "limit": 100,
            "values": true
          },
          "showUnfilled": false,
          "sizing": "auto",
          "valueMode": "color"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nprofile as Profil,\r\nSUM(page_video_views_10s) as videoViews10s\r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\n\r\nAND $Zeitraum\r\nGROUP BY profile\r\nORDER BY videoViews10s desc\r\n",
            "refId": "Videostarts ab 10 Sek.",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Videostarts (10 Sek.)",
        "transparent": true,
        "type": "bargauge"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "dark-blue",
              "mode": "fixed"
            },
            "mappings": [],
            "min": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": []
        },
        "gridPos": {
          "h": 23,
          "w": 12,
          "x": 12,
          "y": 109
        },
        "id": 37,
        "options": {
          "displayMode": "gradient",
          "maxVizHeight": 300,
          "minVizHeight": 20,
          "minVizWidth": 0,
          "namePlacement": "auto",
          "orientation": "horizontal",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "limit": 100,
            "values": true
          },
          "showUnfilled": false,
          "sizing": "auto",
          "valueMode": "color"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nSUM(page_video_views) as videoViews3s,\r\nprofile\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE True\r\n\r\nAND $Zeitraum\r\nGROUP BY profile\r\nORDER BY videoViews3s desc\r\n",
            "refId": "Videostarts ab 3s",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Videostarts (3 Sek.)",
        "transparent": true,
        "type": "bargauge"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 132
        },
        "id": 2,
        "panels": [],
        "title": "ARD Facebook Score $LRA |  ${Monat} ${Jahr}",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "blue",
              "mode": "fixed"
            },
            "mappings": [],
            "min": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "ARD_Facebook_Score"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 24,
          "w": 15,
          "x": 0,
          "y": 133
        },
        "id": 4,
        "options": {
          "displayMode": "gradient",
          "maxVizHeight": 300,
          "minVizHeight": 20,
          "minVizWidth": 0,
          "namePlacement": "auto",
          "orientation": "horizontal",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "limit": 100,
            "values": true
          },
          "showUnfilled": false,
          "sizing": "auto",
          "valueMode": "color"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "(SELECT \r\na.profile,\r\nROUND(a.followers/1000 + b.interactions/10) as ARD_Facebook_Score\r\n\r\nFROM\r\n(SELECT \r\nprofile,\r\nfollowers\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")  \r\n  WHERE True\r\nAND time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n            WHERE $Zeitraum)\r\n  GROUP BY profile, followers) as a,\r\n  \r\n(SELECT \r\n(ROUND (AVG(ownPostsLikes + ownPostsLove + ownPostsWow + ownPostsHaha + ownPostsSad + ownPostsAngry + ownPostsShares + ownPostsComments))) AS interactions,\r\nprofile\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE True\r\n  AND $Zeitraum\r\n  GROUP BY profile\r\n  ) as b\r\n  WHERE a.profile = b.profile\r\n  ORDER BY ARD_Facebook_Score DESC)\r\n",
            "refId": "ARD Facebook Score",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Facebook Score | $Monat $Jahr",
        "transparent": true,
        "type": "bargauge"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "blue",
              "mode": "thresholds"
            },
            "custom": {
              "axisBorderShow": false,
              "axisCenteredZero": false,
              "axisColorMode": "text",
              "axisLabel": "",
              "axisPlacement": "hidden",
              "fillOpacity": 80,
              "gradientMode": "hue",
              "hideFrom": {
                "legend": false,
                "tooltip": false,
                "viz": false
              },
              "lineWidth": 1,
              "scaleDistribution": {
                "type": "linear"
              },
              "thresholdsStyle": {
                "mode": "off"
              }
            },
            "decimals": 2,
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "red"
                },
                {
                  "color": "green",
                  "value": 0
                }
              ]
            },
            "unit": "percent"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Profil"
              },
              "properties": [
                {
                  "id": "custom.axisPlacement",
                  "value": "left"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ARDScore_Veraenderung"
              },
              "properties": [
                {
                  "id": "decimals",
                  "value": 0
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 24,
          "w": 9,
          "x": 15,
          "y": 133
        },
        "id": 63,
        "options": {
          "barRadius": 0,
          "barWidth": 0.7,
          "colorByField": "ARDScore_Veraenderung",
          "fullHighlight": false,
          "groupWidth": 0.7,
          "legend": {
            "calcs": [],
            "displayMode": "list",
            "placement": "bottom",
            "showLegend": false
          },
          "orientation": "horizontal",
          "showValue": "auto",
          "stacking": "none",
          "text": {
            "valueSize": 15
          },
          "tooltip": {
            "mode": "single",
            "sort": "none"
          },
          "xField": "Profil",
          "xTickLabelMaxLength": 30,
          "xTickLabelRotation": 0,
          "xTickLabelSpacing": 0
        },
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\n  lm.Profil as Profil,\r\n  (lm.ARD_Facebook_Score / llm.ARD_Facebook_Score - 1) * 100 as ARDScore_Veraenderung\r\nFROM\r\n(\r\n    SELECT\r\n      a.profile as Profil,\r\n      ROUND(a.followers / 1000 + b.interactions / 10) as ARD_Facebook_Score\r\n    FROM\r\n      (\r\n        SELECT\r\n          profile,\r\n          followers\r\n        FROM\r\n          `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n          JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n            facebook.profileId = profiles.facebookID\r\n            AND profiles.LRA = \"$LRA\"\r\n          )\r\n        WHERE\r\n          True\r\n          AND time = (\r\n            SELECT\r\n              MAX(time)\r\n            FROM\r\n              `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n            WHERE\r\n              $Zeitraum\r\n          )\r\n        GROUP BY\r\n          profile,\r\n          followers\r\n      ) as a,\r\n      (\r\n        SELECT\r\n          (\r\n            ROUND (\r\n              AVG(\r\n                ownPostsLikes + ownPostsLove + ownPostsWow + ownPostsHaha + ownPostsSad + ownPostsAngry + ownPostsShares + ownPostsComments\r\n              )\r\n            )\r\n          ) AS interactions,\r\n          profile\r\n        FROM\r\n          `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n          JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n            facebook.profileId = profiles.facebookID\r\n            AND profiles.LRA = \"$LRA\"\r\n          )\r\n        WHERE\r\n          True\r\n          AND $Zeitraum\r\n        GROUP BY\r\n          profile\r\n      ) as b\r\n    WHERE\r\n      a.profile = b.profile\r\n    ORDER BY\r\n      ARD_Facebook_Score DESC\r\n  ) as lm\r\n  LEFT JOIN (\r\n    SELECT\r\n      a.profile as Profil,\r\n      ROUND(a.followers / 1000 + b.interactions / 10) as ARD_Facebook_Score\r\n    FROM\r\n      (\r\n        SELECT\r\n          profile,\r\n          followers\r\n        FROM\r\n          `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebook${comp_table_suffix}` as facebook\r\n          JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n            facebook.profileId = profiles.facebookID\r\n            AND profiles.LRA = \"$LRA\"\r\n          )\r\n        WHERE\r\n          True\r\n          AND time = (\r\n            SELECT\r\n              MAX(time)\r\n            FROM\r\n              `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebook${comp_table_suffix}` as facebook\r\n            WHERE\r\n              CASE\r\n                \"${Monat:text}\"\r\n                WHEN \"Jahr\" THEN EXTRACT(\r\n                  YEAR\r\n                  from\r\n                    time\r\n                ) = $Jahr -1\r\n                ELSE (EXTRACT(\r\n                  MONTH\r\n                  from\r\n                    time\r\n                ) = EXTRACT(\r\n                  MONTH\r\n                  from\r\n                    DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n                )\r\n                AND EXTRACT(\r\n                  YEAR\r\n                  from\r\n                    time\r\n                ) = EXTRACT(\r\n                  YEAR\r\n                  from\r\n                    DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n                )\r\n              )END ) \r\n            GROUP BY\r\n              profile,\r\n              followers\r\n          ) as a,\r\n          (\r\n            SELECT\r\n              (\r\n                ROUND (\r\n                  AVG(\r\n                    ownPostsLikes + ownPostsLove + ownPostsWow + ownPostsHaha + ownPostsSad + ownPostsAngry + ownPostsShares + ownPostsComments\r\n                  )\r\n                )\r\n              ) AS interactions,\r\n              profile\r\n            FROM\r\n              `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebook${comp_table_suffix}` as facebook\r\n              JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n                facebook.profileId = profiles.facebookID\r\n                AND profiles.LRA = \"$LRA\"\r\n              )\r\n            WHERE\r\n              True\r\n              AND CASE \"${Monat:text}\" WHEN \"Jahr\" THEN EXTRACT(year from time) = $Jahr -1 ELSE (EXTRACT(\r\n                MONTH\r\n                from\r\n                  time\r\n              ) = EXTRACT(\r\n                MONTH\r\n                from\r\n                  DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n              )\r\n              AND EXTRACT(\r\n                YEAR\r\n                from\r\n                  time\r\n              ) = EXTRACT(\r\n                YEAR\r\n                from\r\n                  DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n              ))END\r\n            GROUP BY\r\n              profile\r\n          ) as b\r\n        WHERE\r\n          a.profile = b.profile\r\n        ORDER BY\r\n          ARD_Facebook_Score DESC\r\n      ) as llm ON lm.Profil = llm.Profil\r\n    ORDER BY\r\n      lm.ARD_Facebook_Score DESC",
            "refId": "ARD Facebook Score",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "zum $Vormonat",
        "transparent": true,
        "type": "barchart"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "mappings": [],
            "min": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            }
          },
          "overrides": []
        },
        "gridPos": {
          "h": 5,
          "w": 12,
          "x": 0,
          "y": 157
        },
        "id": 77,
        "options": {
          "displayMode": "gradient",
          "maxVizHeight": 300,
          "minVizHeight": 20,
          "minVizWidth": 0,
          "namePlacement": "auto",
          "orientation": "horizontal",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "limit": 100,
            "values": true
          },
          "showUnfilled": false,
          "sizing": "auto",
          "valueMode": "color"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "(SELECT \r\na.profile,\r\nCASE\r\nWHEN a.profile = \"NDR Hamburg\" THEN ROUND((a.followers/1000 + b.interactions/10)*0.64516129)\r\nWHEN a.profile = \"NDR Niedersachsen\" THEN ROUND((a.followers/1000 + b.interactions/10)*0.14714538)\r\nWHEN a.profile = \"NDR Schleswig-Holstein\" THEN ROUND((a.followers/1000 + b.interactions/10)*0.40420372)\r\nWHEN a.profile = \"NDR Mecklenburg-Vorpommern\" THEN ROUND((a.followers/1000 + b.interactions/10)*0.71942446) END as ARD_Facebook_Score\r\n\r\nFROM\r\n(SELECT \r\nprofile,\r\nfollowers\r\n  FROM `ndr-code-bi-dashboard.Quintly.facebook` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")  \r\n  WHERE True\r\nAND time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n            WHERE $Zeitraum)\r\n  GROUP BY profile, followers) as a,\r\n  \r\n(SELECT \r\n(ROUND (AVG(ownPostsLikes + ownPostsLove + ownPostsWow + ownPostsHaha + ownPostsSad + ownPostsAngry + ownPostsShares + ownPostsComments))) AS interactions,\r\nprofile\r\n  FROM `ndr-code-bi-dashboard.Quintly.facebook` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE True\r\n  AND $Zeitraum\r\n  GROUP BY profile\r\n  ) as b\r\n  WHERE a.profile = b.profile AND a.profile IN UNNEST([\"NDR Hamburg\", \"NDR Niedersachsen\", \"NDR Schleswig-Holstein\", \"NDR Mecklenburg-Vorpommern\"])\r\n  ORDER BY ARD_Facebook_Score DESC)",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "ARD Facebook Score regional - Länder",
        "transparent": true,
        "type": "bargauge"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 162
        },
        "id": 39,
        "panels": [],
        "title": "Interaktionen |  ${Month} ${Jahr}",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "dark-blue",
              "mode": "fixed"
            },
            "mappings": [],
            "min": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "InteraktionenProPost"
              },
              "properties": [
                {
                  "id": "displayName"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 24,
          "w": 15,
          "x": 0,
          "y": 163
        },
        "id": 40,
        "options": {
          "displayMode": "gradient",
          "maxVizHeight": 300,
          "minVizHeight": 20,
          "minVizWidth": 0,
          "namePlacement": "auto",
          "orientation": "horizontal",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "limit": 100,
            "values": true
          },
          "showUnfilled": false,
          "sizing": "auto",
          "valueMode": "color"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "  SELECT profile as Profil, SUM(Interaktionen) as InteraktionenProPost,\r\n  FROM(\r\n  SELECT\r\n  ($reactions + $comments + $shares) as Interaktionen,\r\n  profile\r\n  \r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset}${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  AND $interaction_Zeitraum\r\n  GROUP BY profile\r\n\r\n\r\n  UNION ALL\r\n  SELECT \r\n  $reactions_year_2024 + $comments_year_2024 + $shares_year_2024 as Interaktionen,\r\n  profile\r\n\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024\r\n  GROUP BY profile)\r\n  GROUP By profile\r\n  ORDER BY InteraktionenProPost DESC\r\n\r\n",
            "refId": "Videostarts ab 10 Sek.",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Interaktionen | $Monat $Jahr",
        "transparent": true,
        "type": "bargauge"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "fixedColor": "#f5f5f5",
              "mode": "fixed"
            },
            "mappings": [],
            "min": 1,
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            },
            "unit": "locale"
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "AnzahlPosts"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Anzahl Posts"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 24,
          "w": 9,
          "x": 15,
          "y": 163
        },
        "id": 41,
        "options": {
          "displayMode": "gradient",
          "maxVizHeight": 300,
          "minVizHeight": 20,
          "minVizWidth": 0,
          "namePlacement": "auto",
          "orientation": "horizontal",
          "reduceOptions": {
            "calcs": [
              "lastNotNull"
            ],
            "fields": "",
            "limit": 100,
            "values": true
          },
          "showUnfilled": false,
          "sizing": "auto",
          "valueMode": "color"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH interaktionenProPost AS (SELECT \r\nprofile as Profil,\r\nsum(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + \r\n  page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + \r\n  page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger +\r\n  page_positive_feedback_by_type_comment + page_positive_feedback_by_type_link) as Interaktionen\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE True\r\nAND $Zeitraum\r\nGROUP by profile)\r\n-- Interaktionen pro Post und Anzahl Posts\r\nSELECT Profil, anzahlPosts FROM(\r\nSELECT\r\nt2.Profil,\r\nSUM(anzahlPosts) as anzahlPosts,\r\nMAX(t2.Interaktionen) as Interaktionen\r\n\r\nFROM\r\n(SELECT \r\nprofile as Profil,\r\nCOUNT(DISTINCT externalId) as anzahlPosts,\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE True\r\nAND $Zeitraum\r\nGROUP BY profile\r\nUNION ALL\r\nSELECT\r\nprofile as Profil,\r\nCOUNT(DISTINCT externalId) as anzahlPosts\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsExpiredPosts${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE True\r\nAND $Zeitraum\r\nGROUP BY profile) as t1\r\nJOIN (SELECT \r\nProfil,\r\nInteraktionen from interaktionenProPost) as t2 ON t1.Profil = t2.Profil\r\nGROUP BY t2.Profil\r\n--ORDER BY CAST(ROUND(Interaktionen/(DATE_DIFF(LAST_DAY(DATE($Jahr,$Monat,1),MONTH),DATE($Jahr,$Monat,1),DAY) + 1)) AS INT64)  DESC\r\n)\r\nORDER by Interaktionen desc\r\n",
            "refId": "Videostarts ab 10 Sek.",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Anzahl Posts | $Monat $Jahr",
        "transparent": true,
        "type": "bargauge"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 187
        },
        "id": 47,
        "panels": [],
        "title": "Top Posts nach Interaktionen |  ${Month} ${Jahr}",
        "type": "row"
      },
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 3,
          "w": 7,
          "x": 17,
          "y": 188
        },
        "id": 87,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "<p style=\"text-align: right\"><font size=\"2\">Legende: &nbsp;🖼️ = Bild &nbsp;&nbsp; 🎥 = Video &nbsp;&nbsp; 🔗 = Link &nbsp;&nbsp; 📕 = Album &nbsp;&nbsp; 📄 = Status </font><font size=\"6\"> </font>",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "custom": {
              "align": "auto",
              "cellOptions": {
                "type": "auto"
              },
              "filterable": true,
              "inspect": false
            },
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Interaktionen"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.width",
                  "value": 120
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Reaktionen"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.width",
                  "value": 120
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Kommentare"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.width",
                  "value": 121
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Shares"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.width",
                  "value": 124
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Post"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 791
                },
                {
                  "id": "links",
                  "value": [
                    {
                      "targetBlank": true,
                      "title": "${__data.fields.link}",
                      "url": "${__data.fields.link}"
                    }
                  ]
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Typ"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 62
                },
                {
                  "id": "mappings",
                  "value": [
                    {
                      "options": {
                        "Album": {
                          "index": 3,
                          "text": "📕"
                        },
                        "Link": {
                          "index": 2,
                          "text": "🔗"
                        },
                        "Photo": {
                          "index": 0,
                          "text": "🖼️"
                        },
                        "Status": {
                          "index": 4,
                          "text": "📄"
                        },
                        "Video": {
                          "index": 1,
                          "text": "🎥"
                        }
                      },
                      "type": "value"
                    }
                  ]
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "PostDatum"
              },
              "properties": [
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.width",
                  "value": 150
                },
                {
                  "id": "unit",
                  "value": "time: DD.MM.YY | HH:mm \\U\\h\\r "
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Profil"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 245
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "link"
              },
              "properties": [
                {
                  "id": "custom.hidden",
                  "value": true
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Videostarts ab 10 Sek."
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "displayName",
                  "value": "10s Views"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.width",
                  "value": 120
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 18,
          "w": 24,
          "x": 0,
          "y": 191
        },
        "id": 45,
        "options": {
          "cellHeight": "sm",
          "footer": {
            "countRows": false,
            "enablePagination": true,
            "fields": "",
            "reducer": [
              "sum"
            ],
            "show": false
          },
          "showHeader": true,
          "sortBy": []
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "-- TODO: Left Join mit facebookInsightsOwnVideos für Spalte 10s views\r\n\r\nSELECT \r\nprofile as Profil,\r\nfacebook.time as PostDatum,\r\nmessage as Post,\r\nfacebook.link,\r\ntype as Typ,\r\npost_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ \r\n  post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + \r\n  post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger + \r\n  post_activity_by_action_type_share + post_activity_by_action_type_comment as Interaktionen,\r\n\r\npost_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ \r\n  post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + \r\n  post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger as Reaktionen,\r\n\r\n  post_activity_by_action_type_comment as Kommentare,\r\n\r\n  post_activity_by_action_type_share as Shares,\r\n  total_video_10s_views\r\n  \r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nLEFT JOIN `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnVideos${table_suffix}`as videos ON facebook.objectId = videos.externalId\r\nWHERE True\r\nAND CASE WHEN facebook.objectId = videos.externalId THEN True\r\n                     ELSE TRUE END\r\n\r\nAND CASE \"${Monat:text}\"\r\n    WHEN \"Jahr\" THEN EXTRACT(YEAR from facebook.time) = $Jahr\r\n    ELSE EXTRACT(MONTH from facebook.time) = $Monat AND EXTRACT(YEAR from facebook.time) = $Jahr\r\n    END\r\nORDER BY Interaktionen DESC\r\nLIMIT 100",
            "refId": "Top Posts nach Interaktionen",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Top Posts nach Interaktionen |  ${Monat} ${Jahr}",
        "transformations": [
          {
            "id": "organize",
            "options": {
              "excludeByName": {},
              "indexByName": {},
              "renameByName": {
                "total_video_10s_views": "Videostarts ab 10 Sek."
              }
            }
          }
        ],
        "transparent": true,
        "type": "table"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 209
        },
        "id": 49,
        "panels": [],
        "title": "Top One Post je Profil |  ${Month} ${Jahr}",
        "type": "row"
      },
      {
        "datasource": {
          "type": "postgres",
          "uid": "5RzC0pR4k"
        },
        "gridPos": {
          "h": 3,
          "w": 7,
          "x": 17,
          "y": 210
        },
        "id": 85,
        "options": {
          "code": {
            "language": "plaintext",
            "showLineNumbers": false,
            "showMiniMap": false
          },
          "content": "<p style=\"text-align: right\"><font size=\"2\">Legende: &nbsp;🖼️ = Bild &nbsp;&nbsp; 🎥 = Video &nbsp;&nbsp; 🔗 = Link &nbsp;&nbsp; 📕 = Album &nbsp;&nbsp; 📄 = Status </font><font size=\"6\"> </font>",
          "mode": "markdown"
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "postgres",
              "uid": "5RzC0pR4k"
            },
            "format": "time_series",
            "group": [],
            "metricColumn": "none",
            "rawQuery": false,
            "rawSql": "SELECT\n  \"time\" AS \"time\",\n  post_video_view_time\nFROM facebookinsightsownposts\nWHERE\n  $__timeFilter(\"time\")\nORDER BY 1",
            "refId": "A",
            "select": [
              [
                {
                  "params": [
                    "post_video_view_time"
                  ],
                  "type": "column"
                }
              ]
            ],
            "table": "facebookinsightsownposts",
            "timeColumn": "\"time\"",
            "timeColumnType": "timestamp",
            "where": [
              {
                "name": "$__timeFilter",
                "params": [],
                "type": "macro"
              }
            ]
          }
        ],
        "transparent": true,
        "type": "text"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "custom": {
              "align": "auto",
              "cellOptions": {
                "type": "auto"
              },
              "filterable": true,
              "inspect": false
            },
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "green"
                },
                {
                  "color": "red",
                  "value": 80
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Interaktionen"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.width",
                  "value": 121
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Reaktionen"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.width",
                  "value": 123
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Kommentare"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.width",
                  "value": 120
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Shares"
              },
              "properties": [
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.width",
                  "value": 129
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Post"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 728
                },
                {
                  "id": "links",
                  "value": [
                    {
                      "targetBlank": true,
                      "title": "${__data.fields.link}",
                      "url": "${__data.fields.link}"
                    }
                  ]
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Typ"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 62
                },
                {
                  "id": "mappings",
                  "value": [
                    {
                      "options": {
                        "Album": {
                          "index": 3,
                          "text": "📕"
                        },
                        "Link": {
                          "index": 2,
                          "text": "🔗"
                        },
                        "Photo": {
                          "index": 0,
                          "text": "🖼️"
                        },
                        "Status": {
                          "index": 4,
                          "text": "📄"
                        },
                        "Video": {
                          "index": 1,
                          "text": "🎥"
                        }
                      },
                      "type": "value"
                    }
                  ]
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "PostDatum"
              },
              "properties": [
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.width",
                  "value": 150
                },
                {
                  "id": "unit",
                  "value": "time: DD.MM.YY | HH:mm \\U\\h\\r"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "profile"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 300
                },
                {
                  "id": "displayName",
                  "value": "Profil"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "link"
              },
              "properties": [
                {
                  "id": "custom.hidden",
                  "value": true
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "PostDatum"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Postdatum"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "total_video_10s_views"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "10s Views"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.width",
                  "value": 120
                },
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 18,
          "w": 24,
          "x": 0,
          "y": 213
        },
        "id": 52,
        "options": {
          "cellHeight": "sm",
          "footer": {
            "countRows": false,
            "enablePagination": true,
            "fields": "",
            "reducer": [
              "sum"
            ],
            "show": false
          },
          "showHeader": true,
          "sortBy": []
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT DISTINCT\r\n  profile,\r\n  PostDatum,\r\n  Post,\r\n  link,\r\n  Typ,\r\n  Interaktionen,\r\n  Reaktionen,\r\n  Kommentare,\r\n  Shares,\r\n  total_video_10s_views \r\nFROM (\r\n  SELECT \r\n    profiles.profile,\r\n    facebook.time as PostDatum,\r\n    message as Post,\r\n    facebook.link,\r\n    type as Typ,\r\n    post_reactions_by_type_total_like + post_reactions_by_type_total_love + \r\n      post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + \r\n      post_reactions_by_type_total_sorry  + post_reactions_by_type_total_anger + \r\n      post_activity_by_action_type_share + post_activity_by_action_type_comment as Interaktionen,\r\n    post_reactions_by_type_total_like + post_reactions_by_type_total_love + \r\n      post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + \r\n      post_reactions_by_type_total_sorry  + post_reactions_by_type_total_anger as Reaktionen,\r\n    post_activity_by_action_type_comment as Kommentare,\r\n    post_activity_by_action_type_share as Shares,\r\n    total_video_10s_views,\r\n    ROW_NUMBER() OVER (PARTITION BY profiles.facebookID ORDER BY \r\n      post_reactions_by_type_total_like + post_reactions_by_type_total_love + \r\n      post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + \r\n      post_reactions_by_type_total_sorry  + post_reactions_by_type_total_anger + \r\n      post_activity_by_action_type_share + post_activity_by_action_type_comment DESC) as row_num\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  LEFT JOIN `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnVideos${table_suffix}` as videos ON facebook.objectId = videos.externalId\r\n  WHERE True\r\n AND CASE WHEN facebook.objectId = videos.externalId THEN True\r\n                     ELSE TRUE END\r\n\r\nAND CASE \"${Monat:text}\"\r\n    WHEN \"Jahr\" THEN EXTRACT(YEAR from facebook.time) = $Jahr\r\n    ELSE EXTRACT(MONTH from facebook.time) = $Monat AND EXTRACT(YEAR from facebook.time) = $Jahr\r\n    END\r\n\r\n  \r\n) as subquery\r\nWHERE row_num = 1\r\nORDER BY Interaktionen DESC\r\n",
            "refId": "Top One Post je Profil",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "title": "Top One Post je Profil |  ${Monat} ${Jahr}",
        "transparent": true,
        "type": "table"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 231
        },
        "id": 83,
        "panels": [],
        "title": "Zusammenfassung aller Profile | $Monat $Jahr",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "custom": {
              "align": "left",
              "cellOptions": {
                "type": "auto"
              },
              "filterable": true,
              "inspect": false
            },
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "red"
                },
                {
                  "color": "green",
                  "value": 0
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Profil"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Profil"
                },
                {
                  "id": "custom.width",
                  "value": 200
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "followers"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Follower"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "FollowerVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "FollowerVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Anzahlposts"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Anzahl Posts"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "AktiveNutzer"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Ø Aktive Nutzer ${post_or_tag}"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 195
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "AktiveNutzerVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "AktiveNutzerVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InteraktionenVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InteraktionenVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "PotenzielleReichweite"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Ø Potenzielle Reichweite pro Tag"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 255
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "PotenzielleReichweiteVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "PotenzielleReichweiteVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10s"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Videostarts (10 Sek.)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 180
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10sVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10sVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews3s"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Videostarts (3 Sek.)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 180
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews3sVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews3sVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ARD_facebook_score"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "ARD Facebook Score"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 180
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ARDScore_VeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ARDScore_Veraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Interaktionen"
              },
              "properties": [
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 17,
          "w": 24,
          "x": 0,
          "y": 232
        },
        "id": 81,
        "options": {
          "cellHeight": "sm",
          "footer": {
            "countRows": false,
            "enablePagination": true,
            "fields": "",
            "reducer": [
              "sum"
            ],
            "show": false
          },
          "frameIndex": 0,
          "showHeader": true,
          "sortBy": []
        },
        "pluginVersion": "11.1.3",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH followers as (\r\n  SELECT \r\nlm.Profil,\r\nlm_follower as followers,\r\nlm_follower-llm_follower as FollowerVeraenderungAbsolut,\r\n(SAFE_DIVIDE(lm_follower,llm_follower)-1)*100 as FollowerVeraenderung\r\nFROM\r\n(SELECT\r\npage_follows lm_follower,\r\nprofile as Profil\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\n            WHERE $Zeitraum AND page_follows is not null AND page_follows > 1000)\r\n\r\nORDER BY page_follows desc) as lm\r\nLEFT JOIN\r\n(SELECT\r\npage_follows as llm_follower,\r\nprofile as Profil\r\nFROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\n            WHERE \r\n             CASE \"${Monat:text}\"\r\n               WHEN \"Jahr\" THEN EXTRACT(YEAR from facebook.time) = $Jahr - 1\r\n               ELSE EXTRACT(MONTH from time) = EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) AND EXTRACT(YEAR from time) = EXTRACT(YEAR from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH))\r\n               END\r\n               AND page_follows > 1000)\r\n\r\nORDER BY page_follows desc) as llm ON llm.Profil = lm.Profil\r\nORDER BY lm.lm_follower DESC\r\n),anzahl_posts as (\r\n  SELECT\r\nProfil,\r\nSUM(anzahlPosts) as anzahlPosts,\r\nFROM\r\n(SELECT \r\nprofile as Profil,\r\nCOUNT(DISTINCT externalId) as anzahlPosts\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE True\r\nAND $Zeitraum\r\nGROUP BY profile\r\nUNION ALL\r\nSELECT\r\nprofile as Profil,\r\nCOUNT(DISTINCT externalId) as anzahlPosts,\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsExpiredPosts${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\nWHERE True\r\nAND $Zeitraum\r\nGROUP BY profile)\r\nGROUP BY Profil\r\n), aktive_nutzer AS(\r\nWITH aktive_nutzer_last_month AS(\r\nSELECT\r\nCAST(ROUND(SAFE_DIVIDE($aktive_nutzer_record_last_month,$aktive_nutzer_post_or_day_last_month)) as INT64) AS aktive_nutzer,\r\n\tprofile\r\n      FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset_last_month}${table_suffix}` AS facebook\r\n      JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = '$LRA')\r\n      WHERE EXTRACT(MONTH FROM time) = EXTRACT(MONTH FROM DATE_SUB(DATE($Jahr, LEAST($Monat,12), 1), INTERVAL 1 MONTH)) \r\n        AND EXTRACT(YEAR FROM time) = EXTRACT(YEAR FROM DATE_SUB(DATE($Jahr, LEAST($Monat,12), 1), INTERVAL 1 MONTH))\r\nAND $aktive_nutzer_condition_last_month\r\nGROUP BY profile\r\n),\r\naktive_nutzer_current_month AS(\r\nSELECT CAST(ROUND(SAFE_DIVIDE(SUM(engaged_users),SUM(num_day_or_post))) as INT64) as aktive_nutzer,\r\n  profile\r\n  FROM(\r\n\r\n  SELECT\r\n  $aktive_nutzer_record as engaged_users,\r\n  $aktive_nutzer_post_or_day as num_day_or_post,\r\n  profile\r\n  \r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset}${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  AND $interaction_Zeitraum\r\n  AND $aktive_nutzer_condition\r\n  GROUP BY profile\r\n\r\n  UNION ALL\r\n  SELECT\r\n  $aktive_nutzer_record_year_2024 as engaged_users,\r\n  $aktive_nutzer_year_2024 as num_day_or_post,\r\n  profile\r\n\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024\r\n  AND post_impressions_unique IS NOT NULL\r\n  GROUP BY profile)\r\n  GROUP BY profile\r\n),\r\naktive_nutzer_year AS(\r\nSELECT CAST(ROUND(SAFE_DIVIDE(SUM(engaged_users),SUM(num_day_or_post))) as INT64) as aktive_nutzer,\r\nprofile\r\n  FROM(\r\n\r\n  SELECT\r\n  $aktive_nutzer_record_last_year as engaged_users,\r\n  $aktive_nutzer_post_or_day_last_year as num_day_or_post,\r\nprofile\r\n  \r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset_last_year}${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  AND $interaction_last_year_Zeitraum\r\n  AND $aktive_nutzer_condition_last_year\r\n  group by profile\r\n\r\n\r\n  UNION ALL\r\n  SELECT\r\n  $aktive_nutzer_record_year_2024 as engaged_users,\r\n  $aktive_nutzer_year_2024 as num_day_or_post,\r\n  profile\r\n\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024\r\n  AND post_impressions_unique IS NOT NULL\r\n  GROUP BY profile)\r\n  GROUP BY profile\r\n), joined_aktive_nutzer AS (\r\nSELECT aktive_nutzer_current_month.profile AS Profil,\r\n   aktive_nutzer_current_month.aktive_nutzer AS lm_aktive_nutzer,\r\n   $zusammenfassung_dataset_aktive_nutzer.aktive_nutzer AS llm_aktive_nutzer\r\n   FROM aktive_nutzer_current_month\r\n   LEFT JOIN $zusammenfassung_dataset_aktive_nutzer\r\n   ON aktive_nutzer_current_month.profile = $zusammenfassung_dataset_aktive_nutzer.profile\r\n)\r\nSELECT\r\nProfil,\r\nlm_aktive_nutzer as AktiveNutzer,\r\nlm_aktive_nutzer-llm_aktive_nutzer as AktiveNutzerVeraenderungAbsolut,\r\n(SAFE_DIVIDE(lm_aktive_nutzer,llm_aktive_nutzer)-1) * 100 as AktiveNutzerVeraenderung,\r\nFROM joined_aktive_nutzer), interaktionen as (\r\nWITH interactions_last_month AS(\r\nSELECT \r\n$reactions_last_month + $comments_last_month + $shares_last_month AS interactions,\r\nprofile\r\n      FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset_last_month}${table_suffix}` AS facebook\r\n      JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = '$LRA')\r\n      WHERE EXTRACT(MONTH FROM time) = EXTRACT(MONTH FROM DATE_SUB(DATE($Jahr, LEAST($Monat,12), 1), INTERVAL 1 MONTH)) \r\n        AND EXTRACT(YEAR FROM time) = EXTRACT(YEAR FROM DATE_SUB(DATE($Jahr, LEAST($Monat,12), 1), INTERVAL 1 MONTH))\r\nGROUP BY profile\r\n),\r\ninteractions_current_month AS(\r\nSELECT SUM(lm_interactions) as interactions,\r\nprofile\r\n  FROM(\r\n  SELECT\r\n  ($reactions + $comments + $shares) as lm_interactions,\r\nprofile\r\n  \r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset}${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  AND $interaction_Zeitraum\r\ngroup by profile\r\n  UNION ALL\r\n  SELECT \r\n  $reactions_year_2024 + $comments_year_2024 + $shares_year_2024 as lm_interactions,\r\nprofile\r\n\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024\r\ngroup by profile)\r\ngroup by profile\r\n),\r\ninteractions_year AS(\r\nSELECT SUM(lm_interactions) as interactions,\r\nprofile\r\n  FROM(\r\n  SELECT\r\n  ($reactions_last_year + $comments_last_year + $shares_last_year) as lm_interactions,\r\nprofile\r\n  \r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.${interaction_dataset_last_year}${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  AND $interaction_last_year_Zeitraum\r\n  group by profile\r\n  UNION ALL\r\n  SELECT \r\n  $reactions_year_2024 + $comments_year_2024 + $shares_year_2024 as lm_interactions,\r\nprofile\r\n\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE EXTRACT(MONTH from time) >= 4 AND EXTRACT(MONTH from time) <= 12 AND EXTRACT(YEAR from time) = 2024\r\ngroup by profile)\r\ngroup by profile\r\n),\r\ninteractions_joined AS(\r\n   SELECT interactions_current_month.profile AS Profil,\r\n   interactions_current_month.interactions AS lm_interactions,\r\n   $zusammenfassung_dataset.interactions AS llm_interactions\r\n   FROM interactions_current_month \r\n   LEFT JOIN $zusammenfassung_dataset\r\n   ON interactions_current_month.profile = $zusammenfassung_dataset.profile\r\n)\r\nSELECT \r\nProfil,\r\nlm_interactions as Interaktionen,\r\nlm_interactions - llm_interactions as InteraktionenVeraenderungAbsolut,\r\n(SAFE_DIVIDE(lm_interactions,llm_interactions)-1)*100 as InteraktionenVeraenderung,\r\nFROM\r\ninteractions_joined), potenzielle_reichweite as (\r\nSELECT\r\nlm.Profil,\r\nlm_potenzielle_reichweite as PotenzielleReichweite,\r\nlm_potenzielle_reichweite - llm_potenzielle_reichweite as PotenzielleReichweiteVeraenderungAbsolut,\r\n(SAFE_DIVIDE(lm_potenzielle_reichweite,llm_potenzielle_reichweite)-1)*100 as PotenzielleReichweiteVeraenderung\r\nFROM\r\n(SELECT\r\nprofile as Profil,\r\nCAST(ROUND(SUM(page_impressions_unique)/(COUNT(time))) as INT64) as lm_potenzielle_reichweite\r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND page_follows is not null\r\nAND $Zeitraum\r\nGROUP BY profile\r\nORDER BY lm_potenzielle_reichweite desc\r\n) as lm\r\nLEFT JOIN\r\n(SELECT\r\nprofile as Profil,\r\nCAST(ROUND(SUM(page_impressions_unique)/COUNT(time)) as INT64) as llm_potenzielle_reichweite\r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND page_follows is not null\r\n\r\nAND \r\n             CASE \"${Monat:text}\"\r\n               WHEN \"Jahr\" THEN EXTRACT(YEAR from facebook.time) = $Jahr - 1\r\n               ELSE EXTRACT(MONTH from time) = EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) AND EXTRACT(YEAR from time) = EXTRACT(YEAR from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH))\r\n               END \r\nGROUP BY profile\r\nORDER BY llm_potenzielle_reichweite desc\r\n) as llm ON llm.Profil = lm.Profil\r\nORDER BY lm_potenzielle_reichweite DESC\r\n), video_start as (\r\nSELECT\r\nlm.Profil,\r\nlm_videoViews10s as videoViews10s,\r\nlm_videoViews10s - llm_videoViews10s as videoViews10sVeraenderungAbsolut,\r\n(SAFE_DIVIDE(lm_videoViews10s,llm_videoViews10s)-1)*100 as videoViews10sVeraenderung,\r\nlm_videoViews3s as videoViews3s,\r\nlm_videoViews3s - llm_videoViews3s as videoViews3sVeraenderungAbsolut,\r\n(SAFE_DIVIDE(lm_videoViews3s,llm_videoViews3s)-1)*100 as videoViews3sVeraenderung,\r\nFROM\r\n(SELECT\r\nSUM(page_video_views_10s) as lm_videoViews10s,\r\nSUM(page_video_views) as lm_videoViews3s,\r\nprofile as Profil\r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND page_follows is not null\r\n\r\nAND $Zeitraum\r\nGROUP BY profile\r\nORDER BY lm_videoViews10s, lm_videoViews3s DESC\r\n) as lm\r\nLEFT JOIN\r\n(SELECT\r\nprofile as Profil,\r\nSUM(page_video_views_10s) as llm_videoViews10s,\r\nSUM(page_video_views) as llm_videoViews3s\r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND page_follows is not null\r\nAND   \r\n             CASE \"${Monat:text}\"\r\n               WHEN \"Jahr\" THEN EXTRACT(YEAR from facebook.time) = $Jahr - 1\r\n               ELSE EXTRACT(MONTH from time) = EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) AND EXTRACT(YEAR from time) = EXTRACT(YEAR from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH))\r\n               END\r\nGROUP BY profile\r\nORDER BY llm_videoViews10s, llm_videoViews3s DESC\r\n) as llm ON llm.Profil = lm.Profil\r\nORDER BY lm.lm_videoViews10s, lm.lm_videoViews3s DESC\r\n), ard_facebook_score as (\r\nSELECT\r\nlm.Profil as Profil,\r\nlm.ARD_Facebook_Score as ARD_facebook_score,\r\nlm.ARD_Facebook_Score-llm.ARD_Facebook_Score as ARDScore_VeraenderungAbsolut,\r\n(SAFE_DIVIDE(lm.ARD_Facebook_Score,llm.ARD_Facebook_Score)-1)*100 as ARDScore_Veraenderung\r\n\r\nFROM(SELECT \r\na.profile as Profil,\r\nROUND(a.followers/1000 + b.interactions/10) as ARD_Facebook_Score\r\n\r\nFROM\r\n(SELECT \r\nprofile,\r\nfollowers\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")  \r\n  WHERE True\r\nAND time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n            WHERE $Zeitraum and followers is not null)\r\n  GROUP BY profile, followers) as a,\r\n  \r\n(SELECT \r\n(ROUND (AVG(ownPostsLikes + ownPostsLove + ownPostsWow + ownPostsHaha + ownPostsSad + ownPostsAngry + ownPostsShares + ownPostsComments))) AS interactions,\r\nprofile\r\n  FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE True\r\n  AND $Zeitraum\r\n  GROUP BY profile\r\n  ) as b\r\n  WHERE a.profile = b.profile\r\n  ORDER BY ARD_Facebook_Score DESC) as lm\r\n  LEFT JOIN\r\n  (SELECT \r\na.profile as Profil,\r\nROUND(a.followers/1000 + b.interactions/10) as ARD_Facebook_Score\r\n\r\nFROM\r\n(SELECT \r\nprofile,\r\nfollowers\r\n  FROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebook${comp_table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\") \r\n  WHERE True\r\nAND time = (SELECT MAX(time) FROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebook${comp_table_suffix}` as facebook\r\n             WHERE \r\n             CASE \"${Monat:text}\"\r\n               WHEN \"Jahr\" THEN EXTRACT(YEAR from facebook.time) = $Jahr - 1\r\n               ELSE EXTRACT(MONTH from time) = EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) AND EXTRACT(YEAR from time) = EXTRACT(YEAR from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH))\r\n               END\r\n               AND followers is not null)\r\n  GROUP BY profile, followers) as a,\r\n  \r\n(SELECT \r\n(ROUND (AVG(ownPostsLikes + ownPostsLove + ownPostsWow + ownPostsHaha + ownPostsSad + ownPostsAngry + ownPostsShares + ownPostsComments))) AS interactions,\r\nprofile\r\n  FROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebook${comp_table_suffix}` as facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n  WHERE True\r\n   AND \r\n             CASE \"${Monat:text}\"\r\n               WHEN \"Jahr\" THEN EXTRACT(YEAR from facebook.time) = $Jahr - 1\r\n               ELSE EXTRACT(MONTH from time) = EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) AND EXTRACT(YEAR from time) = EXTRACT(YEAR from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH))\r\n               END\r\n  GROUP BY profile\r\n  ) as b\r\n  WHERE a.profile = b.profile\r\n  ORDER BY ARD_Facebook_Score DESC) as llm\r\n  ON lm.Profil = llm.Profil\r\n  ORDER BY lm.ARD_Facebook_Score DESC\r\n)\r\nSELECT followers.Profil,followers.followers, followers.FollowerVeraenderungAbsolut, followers.FollowerVeraenderung,anzahl_posts.Anzahlposts,\r\naktive_nutzer.AktiveNutzer, aktive_nutzer.AktiveNutzerVeraenderungAbsolut, aktive_nutzer.AktiveNutzerVeraenderung,\r\ninteraktionen.Interaktionen, interaktionen.InteraktionenVeraenderungAbsolut, interaktionen.InteraktionenVeraenderung,\r\npotenzielle_reichweite.PotenzielleReichweite, potenzielle_reichweite.PotenzielleReichweiteVeraenderungAbsolut, potenzielle_reichweite.PotenzielleReichweiteVeraenderung,\r\nvideo_start.videoViews10s, video_start.videoViews10sVeraenderungAbsolut, video_start.videoViews10sVeraenderung, video_start.videoViews3s, video_start.videoViews3sVeraenderungAbsolut, video_start.videoViews3sVeraenderung,\r\nard_facebook_score.ARD_facebook_score, ard_facebook_score.ARDScore_VeraenderungAbsolut, ard_facebook_score.ARDScore_Veraenderung FROM followers \r\nLEFT JOIN anzahl_posts ON followers.Profil = anzahl_posts.Profil\r\nLEFT JOIN aktive_nutzer ON followers.Profil = aktive_nutzer.Profil\r\nLEFT JOIN interaktionen ON followers.Profil = interaktionen.Profil\r\nLEFT JOIN potenzielle_reichweite ON followers.Profil = potenzielle_reichweite.Profil\r\nLEFT JOIN video_start ON followers.Profil = video_start.Profil\r\nLEFT JOIN ard_facebook_score ON followers.Profil = ard_facebook_score.Profil\r\nORDER BY Profil DESC",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "type": "table"
      },
      {
        "collapsed": false,
        "gridPos": {
          "h": 1,
          "w": 24,
          "x": 0,
          "y": 249
        },
        "id": 109,
        "panels": [],
        "title": "Zusammenfassung aller Profile auf Tagesebene | $Monat $Jahr",
        "type": "row"
      },
      {
        "datasource": {
          "type": "grafana-bigquery-datasource",
          "uid": "qUaUqEk4k"
        },
        "fieldConfig": {
          "defaults": {
            "color": {
              "mode": "thresholds"
            },
            "custom": {
              "align": "left",
              "cellOptions": {
                "type": "auto"
              },
              "filterable": true,
              "inspect": false
            },
            "mappings": [],
            "thresholds": {
              "mode": "absolute",
              "steps": [
                {
                  "color": "red"
                },
                {
                  "color": "green",
                  "value": 0
                }
              ]
            }
          },
          "overrides": [
            {
              "matcher": {
                "id": "byName",
                "options": "Profil"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Profil"
                },
                {
                  "id": "custom.width",
                  "value": 200
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "followers"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Follower"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "FollowerVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "FollowerVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Anzahlposts"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Anzahl Posts"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "AktiveNutzer"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Ø Aktive Nutzer pro Tag"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 185
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "AktiveNutzerVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "AktiveNutzerVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InteraktionenVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "InteraktionenVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "PotenzielleReichweite"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Ø Potenzielle Reichweite pro Tag"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 255
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "PotenzielleReichweiteVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "PotenzielleReichweiteVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10s"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Ø Videostarts (10 Sek.) pro Tag"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 180
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10sVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews10sVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews3s"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Videostarts (3 Sek.)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 180
                },
                {
                  "id": "displayName",
                  "value": "Ø Videostarts (3 Sek.) pro Tag"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews3sVeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "videoViews3sVeraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ARD_facebook_score"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "ARD Facebook Score"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 180
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ARDScore_VeraenderungAbsolut"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (absolut)"
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "custom.minWidth",
                  "value": 160
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "ARDScore_Veraenderung"
              },
              "properties": [
                {
                  "id": "displayName",
                  "value": "Änderung (in %)"
                },
                {
                  "id": "unit",
                  "value": "percent"
                },
                {
                  "id": "decimals",
                  "value": 2
                },
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "custom.cellOptions",
                  "value": {
                    "type": "color-text"
                  }
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Interaktionen"
              },
              "properties": [
                {
                  "id": "custom.align",
                  "value": "center"
                },
                {
                  "id": "unit",
                  "value": "locale"
                },
                {
                  "id": "displayName",
                  "value": "Ø Interaktionen pro Tag"
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Ø Videostarts (10 Sek.) pro Tag"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 239
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Ø Potenzielle Reichweite pro Tag"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 245
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Ø Interaktionen pro Tag"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 184
                }
              ]
            },
            {
              "matcher": {
                "id": "byName",
                "options": "Ø Videostarts (3 Sek.) pro Tag"
              },
              "properties": [
                {
                  "id": "custom.width",
                  "value": 233
                }
              ]
            }
          ]
        },
        "gridPos": {
          "h": 17,
          "w": 24,
          "x": 0,
          "y": 250
        },
        "id": 111,
        "options": {
          "cellHeight": "sm",
          "footer": {
            "countRows": false,
            "enablePagination": true,
            "fields": "",
            "reducer": [
              "sum"
            ],
            "show": false
          },
          "frameIndex": 0,
          "showHeader": true,
          "sortBy": []
        },
        "pluginVersion": "11.1.1",
        "targets": [
          {
            "datasource": {
              "type": "grafana-bigquery-datasource",
              "uid": "qUaUqEk4k"
            },
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH followers as (\r\n  SELECT\r\n    lm.Profil,\r\n    lm_follower as followers,\r\n    lm_follower - llm_follower as FollowerVeraenderungAbsolut,\r\n    (SAFE_DIVIDE(lm_follower, llm_follower) -1) * 100 as FollowerVeraenderung\r\n  FROM\r\n    (\r\n      SELECT\r\n        page_follows lm_follower,\r\n        profile as Profil\r\n      FROM\r\n        `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\n        JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n          facebook.profileId = profiles.facebookID\r\n          AND profiles.LRA = \"$LRA\"\r\n        )\r\n      WHERE\r\n        True\r\n        AND time = (\r\n          SELECT\r\n            \t\r\n\t\r\n\t\r\nMAX(time)\r\n          FROM\r\n            `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\n          WHERE\r\n            $Zeitraum\r\n            AND page_follows is not null AND page_follows > 1000\r\n        )\r\n      ORDER BY\r\n        page_follows desc\r\n    ) as lm\r\n    LEFT JOIN (\r\n      SELECT\r\n        page_follows as llm_follower,\r\n        profile as Profil\r\n      FROM\r\n        `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\n        JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n          facebook.profileId = profiles.facebookID\r\n          AND profiles.LRA = \"$LRA\"\r\n        )\r\n      WHERE\r\n        True\r\n        AND time = (\r\n          SELECT\r\n            \t\r\n\t\r\n\t\r\nMAX(time)\r\n          FROM\r\n            `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\n          WHERE\r\n            page_follows is not null\r\n            and CASE\r\n              ${Monat}\r\n              WHEN 13 THEN EXTRACT(\r\n                YEAR\r\n                FROM\r\n                  time\r\n              ) = $Jahr -1\r\n              ELSE (\r\n                EXTRACT(\r\n                  MONTH\r\n                  from\r\n                    time\r\n                ) = EXTRACT(\r\n                  MONTH\r\n                  from\r\n                    DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n                )\r\n                AND EXTRACT(\r\n                  YEAR\r\n                  from\r\n                    time\r\n                ) = EXTRACT(\r\n                  YEAR\r\n                  from\r\n                    DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n                )\r\n              )\r\n            END AND page_follows > 1000\r\n        )\r\n      ORDER BY\r\n        page_follows desc\r\n    ) as llm ON llm.Profil = lm.Profil\r\n  ORDER BY\r\n    lm.lm_follower DESC\r\n),\r\nanzahl_posts as (\r\n  SELECT\r\n    Profil,\r\n    SUM(anzahlPosts) as anzahlPosts,\r\n  FROM\r\n    (\r\n      SELECT\r\n        profile as Profil,\r\n        COUNT(DISTINCT externalId) as anzahlPosts\r\n      FROM\r\n        `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsOwnPosts${table_suffix}` as facebook\r\n        JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n          facebook.profileId = profiles.facebookID\r\n          AND profiles.LRA = \"$LRA\"\r\n        )\r\n      WHERE\r\n        True\r\n        AND $Zeitraum\r\n      GROUP BY\r\n        profile\r\n      UNION\r\n      ALL\r\n      SELECT\r\n        profile as Profil,\r\n        COUNT(DISTINCT externalId) as anzahlPosts,\r\n      FROM\r\n        `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsightsExpiredPosts${table_suffix}` as facebook\r\n        JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n          facebook.profileId = profiles.facebookID\r\n          AND profiles.LRA = \"$LRA\"\r\n        )\r\n      WHERE\r\n        True\r\n        AND $Zeitraum\r\n      GROUP BY\r\n        profile\r\n    )\r\n  GROUP BY\r\n    Profil\r\n), potenzielle_reichweite as (\r\nSELECT\r\nlm.Profil,\r\nlm_potenzielle_reichweite as PotenzielleReichweite,\r\nlm_potenzielle_reichweite - llm_potenzielle_reichweite as PotenzielleReichweiteVeraenderungAbsolut,\r\n(SAFE_DIVIDE(lm_potenzielle_reichweite,llm_potenzielle_reichweite)-1)*100 as PotenzielleReichweiteVeraenderung\r\nFROM\r\n(SELECT\r\nprofile as Profil,\r\nCAST(ROUND(SUM(page_impressions_unique)/(COUNT(time))) as INT64) as lm_potenzielle_reichweite\r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND page_follows is not null\r\nAND $Zeitraum\r\nGROUP BY profile\r\nORDER BY lm_potenzielle_reichweite desc\r\n) as lm\r\nLEFT JOIN\r\n(SELECT\r\nprofile as Profil,\r\nCAST(ROUND(SUM(page_impressions_unique)/COUNT(time)) as INT64) as llm_potenzielle_reichweite\r\n\r\nFROM `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\nJOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (facebook.profileId = profiles.facebookID AND profiles.LRA = \"$LRA\")\r\n\r\nWHERE True\r\nAND page_follows is not null\r\n\r\nAND \r\n             CASE \"${Monat:text}\"\r\n               WHEN \"Jahr\" THEN EXTRACT(YEAR from facebook.time) = $Jahr - 1\r\n               ELSE EXTRACT(MONTH from time) = EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH)) AND EXTRACT(YEAR from time) = EXTRACT(YEAR from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH))\r\n               END \r\nGROUP BY profile\r\nORDER BY llm_potenzielle_reichweite desc\r\n) as llm ON llm.Profil = lm.Profil\r\nORDER BY lm_potenzielle_reichweite DESC\r\n),\r\nvideo_start as (\r\n  SELECT\r\n    lm.Profil,\r\n    lm_videoViews10s as videoViews10s,\r\n    lm_videoViews10s - llm_videoViews10s as videoViews10sVeraenderungAbsolut,\r\n    (\r\n      SAFE_DIVIDE(lm_videoViews10s, llm_videoViews10s) -1\r\n    ) * 100 as videoViews10sVeraenderung,\r\n    lm_videoViews3s as videoViews3s,\r\n    lm_videoViews3s - llm_videoViews3s as videoViews3sVeraenderungAbsolut,\r\n    (SAFE_DIVIDE(lm_videoViews3s, llm_videoViews3s) -1) * 100 as videoViews3sVeraenderung,\r\n  FROM\r\n    (\r\n      SELECT\r\n        CAST(\r\n          ROUND(SUM(page_video_views_10s) / COUNT(time)) as INT64\r\n        ) as lm_videoViews10s,\r\n        CAST(\r\n          ROUND(SUM(page_video_views) / COUNT(time)) as INT64\r\n        ) as lm_videoViews3s,\r\n        profile as Profil\r\n      FROM\r\n        `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\r\n        JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n          facebook.profileId = profiles.facebookID\r\n          AND profiles.LRA = \"$LRA\"\r\n        )\r\n      WHERE\r\n        True\r\n        AND page_follows is not null\r\n        AND $Zeitraum\r\n      GROUP BY\r\n        profile\r\n      ORDER BY\r\n        lm_videoViews10s,\r\n        lm_videoViews3s DESC\r\n    ) as lm\r\n    LEFT JOIN (\r\n      SELECT\r\n        profile as Profil,\r\n        CAST(\r\n          ROUND(SUM(page_video_views_10s) / COUNT(time)) as INT64\r\n        ) as llm_videoViews10s,\r\n        CAST(\r\n          ROUND(SUM(page_video_views) / COUNT(time)) as INT64\r\n        ) as llm_videoViews3s\r\n      FROM\r\n        `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebookInsights${comp_table_suffix}` as facebook\r\n        JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n          facebook.profileId = profiles.facebookID\r\n          AND profiles.LRA = \"$LRA\"\r\n        )\r\n      WHERE\r\n        True\r\n        AND page_follows is not null\r\n        AND CASE\r\n          ${Monat}\r\n          WHEN 13 THEN EXTRACT(\r\n            YEAR\r\n            FROM\r\n              time\r\n          ) = $Jahr -1\r\n          ELSE (\r\n            EXTRACT(\r\n              MONTH\r\n              from\r\n                time\r\n            ) = EXTRACT(\r\n              MONTH\r\n              from\r\n                DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n            )\r\n            AND EXTRACT(\r\n              YEAR\r\n              from\r\n                time\r\n            ) = EXTRACT(\r\n              YEAR\r\n              from\r\n                DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n            )\r\n          )\r\n        END\r\n      GROUP BY\r\n        profile\r\n      ORDER BY\r\n        llm_videoViews10s,\r\n        llm_videoViews3s DESC\r\n    ) as llm ON llm.Profil = lm.Profil\r\n  ORDER BY\r\n    lm.lm_videoViews10s,\r\n    lm.lm_videoViews3s DESC\r\n),\r\nard_facebook_score as (\r\n  SELECT\r\n    lm.Profil as Profil,\r\n    lm.ARD_Facebook_Score as ARD_facebook_score,\r\n    lm.ARD_Facebook_Score - llm.ARD_Facebook_Score as ARDScore_VeraenderungAbsolut,\r\n    (\r\n      SAFE_DIVIDE(lm.ARD_Facebook_Score, llm.ARD_Facebook_Score) -1\r\n    ) * 100 as ARDScore_Veraenderung\r\n  FROM\r\n(\r\n      SELECT\r\n        a.profile as Profil,\r\n        ROUND(a.followers / 1000 + b.interactions / 10) as ARD_Facebook_Score\r\n      FROM\r\n        (\r\n          SELECT\r\n            profile,\r\n            followers\r\n          FROM\r\n            `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n            JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n              facebook.profileId = profiles.facebookID\r\n              AND profiles.LRA = \"$LRA\"\r\n            )\r\n          WHERE\r\n            True\r\n            AND time = (\r\n              SELECT\r\n                \t\r\n\t\r\n\t\r\nMAX(time)\r\n              FROM\r\n                `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n              WHERE\r\n                $Zeitraum\r\n                AND followers is not null\r\n            )\r\n          GROUP BY\r\n            profile,\r\n            followers\r\n        ) as a,\r\n        (\r\n          SELECT\r\n            (\r\n              ROUND (\r\n                AVG(\r\n                  ownPostsLikes + ownPostsLove + ownPostsWow + ownPostsHaha + ownPostsSad + ownPostsAngry + ownPostsShares + ownPostsComments\r\n                )\r\n              )\r\n            ) AS interactions,\r\n            profile\r\n          FROM\r\n            `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebook${table_suffix}` as facebook\r\n            JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n              facebook.profileId = profiles.facebookID\r\n              AND profiles.LRA = \"$LRA\"\r\n            )\r\n          WHERE\r\n            True\r\n            AND $Zeitraum\r\n            AND followers is not null\r\n          GROUP BY\r\n            profile\r\n        ) as b\r\n      WHERE\r\n        a.profile = b.profile\r\n      ORDER BY\r\n        ARD_Facebook_Score DESC\r\n    ) as lm\r\n    LEFT JOIN (\r\n      SELECT\r\n        a.profile as Profil,\r\n        ROUND(a.followers / 1000 + b.interactions / 10) as ARD_Facebook_Score\r\n      FROM\r\n        (\r\n          SELECT\r\n            profile,\r\n            followers\r\n          FROM\r\n            `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebook${comp_table_suffix}` as facebook\r\n            JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n              facebook.profileId = profiles.facebookID\r\n              AND profiles.LRA = \"$LRA\"\r\n            )\r\n          WHERE\r\n            True\r\n            AND time = (\r\n              SELECT\r\n                \t\r\n\t\r\n\t\r\nMAX(time)\r\n              FROM\r\n                `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebook${comp_table_suffix}` as facebook\r\n              WHERE\r\n                followers is not null\r\n                and CASE\r\n                  ${Monat}\r\n                  WHEN 13 THEN EXTRACT(\r\n                    YEAR\r\n                    FROM\r\n                      time\r\n                  ) = $Jahr -1\r\n                  ELSE (\r\n                    EXTRACT(\r\n                      MONTH\r\n                      from\r\n                        time\r\n                    ) = EXTRACT(\r\n                      MONTH\r\n                      from\r\n                        DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n                    )\r\n                    AND EXTRACT(\r\n                      YEAR\r\n                      from\r\n                        time\r\n                    ) = EXTRACT(\r\n                      YEAR\r\n                      from\r\n                        DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n                    )\r\n                  )\r\n                END\r\n            )\r\n          GROUP BY\r\n            profile,\r\n            followers\r\n        ) as a,\r\n        (\r\n          SELECT\r\n            (\r\n              ROUND (\r\n                AVG(\r\n                  ownPostsLikes + ownPostsLove + ownPostsWow + ownPostsHaha + ownPostsSad + ownPostsAngry + ownPostsShares + ownPostsComments\r\n                )\r\n              )\r\n            ) AS interactions,\r\n            profile\r\n          FROM\r\n            `ndr-code-bi-dashboard.Quintly${comp_dataset_suffix}.facebook${comp_table_suffix}` as facebook\r\n            JOIN `ndr-code-bi-dashboard.Quintly.profiles` as profiles ON (\r\n              facebook.profileId = profiles.facebookID\r\n              AND profiles.LRA = \"$LRA\"\r\n            )\r\n          WHERE\r\n            True\r\n            AND followers is not null\r\n            AND CASE\r\n              ${Monat}\r\n              WHEN 13 THEN EXTRACT(\r\n                YEAR\r\n                FROM\r\n                  time\r\n              ) = $Jahr -1\r\n              ELSE (\r\n                EXTRACT(\r\n                  MONTH\r\n                  from\r\n                    time\r\n                ) = EXTRACT(\r\n                  MONTH\r\n                  from\r\n                    DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n                )\r\n                AND EXTRACT(\r\n                  YEAR\r\n                  from\r\n                    time\r\n                ) = EXTRACT(\r\n                  YEAR\r\n                  from\r\n                    DATE_SUB(DATE($Jahr, $Monat, 1), INTERVAL 1 MONTH)\r\n                )\r\n              )\r\n            END\r\n          GROUP BY\r\n            profile\r\n        ) as b\r\n      WHERE\r\n        a.profile = b.profile\r\n      ORDER BY\r\n        ARD_Facebook_Score DESC\r\n    ) as llm ON lm.Profil = llm.Profil\r\n  ORDER BY\r\n    lm.ARD_Facebook_Score DESC\r\n)\r\nSELECT\r\n  followers.Profil,\r\n  followers.followers,\r\n  followers.FollowerVeraenderungAbsolut,\r\n  followers.FollowerVeraenderung,\r\n  anzahl_posts.Anzahlposts,\r\n  potenzielle_reichweite.PotenzielleReichweite,\r\n  potenzielle_reichweite.PotenzielleReichweiteVeraenderungAbsolut,\r\n  potenzielle_reichweite.PotenzielleReichweiteVeraenderung,\r\n  video_start.videoViews10s,\r\n  video_start.videoViews10sVeraenderungAbsolut,\r\n  video_start.videoViews10sVeraenderung,\r\n  video_start.videoViews3s,\r\n  video_start.videoViews3sVeraenderungAbsolut,\r\n  video_start.videoViews3sVeraenderung,\r\n  ard_facebook_score.ARD_facebook_score,\r\n  ard_facebook_score.ARDScore_VeraenderungAbsolut,\r\n  ard_facebook_score.ARDScore_Veraenderung\r\nFROM\r\n  followers\r\n  LEFT JOIN anzahl_posts ON followers.Profil = anzahl_posts.Profil\r\n  LEFT JOIN potenzielle_reichweite ON followers.Profil = potenzielle_reichweite.Profil\r\n  LEFT JOIN video_start ON followers.Profil = video_start.Profil\r\n  LEFT JOIN ard_facebook_score ON followers.Profil = ard_facebook_score.Profil\r\n  ORDER BY Profil DESC",
            "refId": "A",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          }
        ],
        "type": "table"
      }
    ],
    "refresh": false,
    "schemaVersion": 39,
    "tags": [],
    "templating": {
      "list": [
        {
          "current": {
            "selected": false,
            "text": "NDR",
            "value": "NDR"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 0,
          "includeAll": false,
          "multi": false,
          "name": "LRA",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT a.LRA\r\nFROM (\r\nSELECT \"MDR\" as LRA\r\nUNION DISTINCT\r\nSELECT \"NDR\"\r\nUNION DISTINCT\r\nSELECT \"KiKa\"\r\n) as a\r\nORDER BY (\r\n  CASE\r\n    WHEN REGEXP_CONTAINS(LOWER(\"${__user.email}\"), LOWER(a.LRA))\r\n    THEN 1\r\n    ELSE 0\r\n  END\r\n) DESC",
            "refId": "tempvar",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": false,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": true,
            "text": "August",
            "value": "8"
          },
          "hide": 0,
          "includeAll": false,
          "multi": false,
          "name": "Monat",
          "options": [
            {
              "selected": false,
              "text": "Januar",
              "value": "1"
            },
            {
              "selected": false,
              "text": "Februar",
              "value": "2"
            },
            {
              "selected": false,
              "text": "März",
              "value": "3"
            },
            {
              "selected": false,
              "text": "April",
              "value": "4"
            },
            {
              "selected": false,
              "text": "Mai",
              "value": "5"
            },
            {
              "selected": false,
              "text": "Juni",
              "value": "6"
            },
            {
              "selected": false,
              "text": "Juli",
              "value": "7"
            },
            {
              "selected": true,
              "text": "August",
              "value": "8"
            },
            {
              "selected": false,
              "text": "September",
              "value": "9"
            },
            {
              "selected": false,
              "text": "Oktober",
              "value": "10"
            },
            {
              "selected": false,
              "text": "November",
              "value": "11"
            },
            {
              "selected": false,
              "text": "Dezember",
              "value": "12"
            },
            {
              "selected": false,
              "text": "Jahr",
              "value": "13"
            }
          ],
          "query": "Januar : 1, Februar :  2, März : 3, April : 4, Mai : 5, Juni : 6, Juli : 7, August : 8, September : 9, Oktober : 10, November : 11, Dezember : 12, Jahr :  13",
          "queryValue": "",
          "skipUrlSync": true,
          "type": "custom"
        },
        {
          "current": {
            "selected": false,
            "text": "2024",
            "value": "2024"
          },
          "hide": 0,
          "includeAll": false,
          "multi": false,
          "name": "Jahr",
          "options": [
            {
              "selected": false,
              "text": "2022",
              "value": "2022"
            },
            {
              "selected": false,
              "text": "2023",
              "value": "2023"
            },
            {
              "selected": true,
              "text": "2024",
              "value": "2024"
            }
          ],
          "query": "2022 : 2022, 2023 : 2023, 2024 : 2024",
          "queryValue": "",
          "skipUrlSync": false,
          "type": "custom"
        },
        {
          "current": {
            "selected": false,
            "text": "Juli",
            "value": "Juli"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "lastMonth",
          "options": [],
          "query": {
            "dataset": "Quintly",
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH))\r\nWHEN 1 THEN \"Januar\"\r\nWHEN 2 THEN \"Februar\"\r\nWHEN 3 THEN \"März\"\r\nWHEN 4 THEN \"April\"\r\nWHEN 5 THEN \"Mai\"\r\nWHEN 6 THEN \"Juni\"\r\nWHEN 7 THEN \"Juli\"\r\nWHEN 8 THEN \"August\"\r\nWHEN 9 THEN \"September\"\r\nWHEN 10 THEN \"Oktober\"\r\nWHEN 11 THEN \"November\"\r\nWHEN 12 THEN \"Dezember\"\r\nEND\r\n",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            },
            "table": "facebook"
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "Aug 24",
            "value": "Aug 24"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "lastMonthShort",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "\r\n\r\nSELECT\r\nCONCAT(\r\nCASE EXTRACT(MONTH FROM lastMonth)\r\nWHEN 1 THEN \"Jan\"\r\nWHEN 2 THEN \"Feb\"\r\nWHEN 3 THEN \"Mrz\"\r\nWHEN 4 THEN \"Apr\"\r\nWHEN 5 THEN \"Mai\"\r\nWHEN 6 THEN \"Jun\"\r\nWHEN 7 THEN \"Jul\"\r\nWHEN 8 THEN \"Aug\"\r\nWHEN 9 THEN \"Sep\"\r\nWHEN 10 THEN \"Okt\"\r\nWHEN 11 THEN \"Nov\"\r\nWHEN 12 THEN \"Dez\"\r\nEND, FORMAT_DATE(\" %y\", lastMonth))\r\n\r\nFROM\r\n(SELECT DATE_SUB(CAST(DATE_TRUNC(MAX(last_update), MONTH) AS DATE), INTERVAL 1 MONTH) as lastMonth FROM `ndr-code-bi-dashboard.Quintly.facebook`)",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "01.12.23",
            "value": "01.12.23"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "description": "Zeigt den frühsten Eintrag des Feldes last_update in der Datenbank",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "earliestLastUpdate",
          "options": [],
          "query": {
            "dataset": "Quintly",
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "--SELECT FORMAT_TIMESTAMP(\"%d.%m.%y | %H:%M:%S Uhr\",last_update) FROM \r\nSELECT FORMAT_TIMESTAMP(\"%d.%m.%y\",last_update) FROM \r\n(SELECT last_update FROM `ndr-code-bi-dashboard.Quintly.facebook`\r\nUNION ALL\r\nSELECT last_update FROM `ndr-code-bi-dashboard.Quintly.facebookInsights`\r\nUNION ALL\r\nSELECT last_update FROM `ndr-code-bi-dashboard.Quintly.facebookInsightsOwnPosts`\r\nUNION ALL\r\nSELECT last_update FROM `ndr-code-bi-dashboard.Quintly.facebookInsightsOwnVideos`)\r\n ORDER BY last_update LIMIT 1 ",
            "sql": {
              "columns": [
                {
                  "parameters": [
                    {
                      "name": "last_update",
                      "type": "functionParameter"
                    }
                  ],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 1,
              "orderBy": {
                "property": {
                  "name": "last_update",
                  "type": "string"
                },
                "type": "property"
              }
            },
            "table": "facebook"
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "48",
            "value": "48"
          },
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "filled_size_headline",
          "options": [
            {
              "selected": true,
              "text": "48",
              "value": "48"
            }
          ],
          "query": "48",
          "skipUrlSync": false,
          "type": "custom"
        },
        {
          "current": {
            "selected": false,
            "text": "'NDRNiedersachsen', 'NJOY', 'NDRHamburg', 'NDRde', 'extra3', 'NDRSchleswigHolstein', 'NDRSport', 'NDRTalkShow', 'NDRHamburg', 'NDRNiedersachsen', 'NDR2', 'NDRde', 'extra3', 'NDRSport', 'NJOY', 'NDRSchleswigHolstein', 'NDRNiedersachsen', 'NDRHamburg', 'NJOY', 'NDR2', 'NDRFernsehen', 'NDRSport', 'extra3', 'NDRde', 'NDRHamburg', 'NDRNiedersachsen', 'NDRSchleswigHolstein', 'NDR2', 'DAS!imNDRFernsehen', 'NDRSport', 'NDRKultur', 'extra3', 'NDRNiedersachsen', 'NJOY', 'NDR2', 'NDRHamburg', 'extra3', 'NDRFernsehen', 'NDRde', 'NDRSchleswigHolstein', 'NJOY', 'NDRNiedersachsen', 'NDRHamburg', 'extra3', 'NDRTalkShow', 'NDR2', 'DAS!imNDRFernsehen', 'NDRde', 'NDRNiedersachsen', 'NDRHamburg', 'extra3', 'NDRSchleswigHolstein', 'NDRde', 'NDRSport', 'DAS!imNDRFernsehen', 'NDR2', 'NJOY', 'NDRNiedersachsen', 'NDRHamburg', 'extra3', 'NDRTalkShow', 'NDRde', 'NDRSport', 'DAS!imNDRFernsehen', 'NDRNiedersachsen', 'NDRSchleswigHolstein', 'NDRHamburg', 'DAS!imNDRFernsehen', 'extra3', 'NDRde', 'NJOY', 'NDRSport', 'NJOY', 'NDRNiedersachsen', 'NDRHamburg', 'extra3', 'DAS!imNDRFernsehen', 'NDRSport', 'NDRde', 'NDRKultur', 'NJOY', 'NDRNiedersachsen', 'NDR2', 'NDRHamburg', 'NDRTalkShow', 'DAS!imNDRFernsehen', 'NDRFernsehen', 'extra3', 'NDR2', 'NDRNiedersachsen', 'NDRHamburg', 'NJOY', 'NDRde', 'NDRFernsehen', 'extra3', 'NDRSport'",
            "value": "'NDRNiedersachsen', 'NJOY', 'NDRHamburg', 'NDRde', 'extra3', 'NDRSchleswigHolstein', 'NDRSport', 'NDRTalkShow', 'NDRHamburg', 'NDRNiedersachsen', 'NDR2', 'NDRde', 'extra3', 'NDRSport', 'NJOY', 'NDRSchleswigHolstein', 'NDRNiedersachsen', 'NDRHamburg', 'NJOY', 'NDR2', 'NDRFernsehen', 'NDRSport', 'extra3', 'NDRde', 'NDRHamburg', 'NDRNiedersachsen', 'NDRSchleswigHolstein', 'NDR2', 'DAS!imNDRFernsehen', 'NDRSport', 'NDRKultur', 'extra3', 'NDRNiedersachsen', 'NJOY', 'NDR2', 'NDRHamburg', 'extra3', 'NDRFernsehen', 'NDRde', 'NDRSchleswigHolstein', 'NJOY', 'NDRNiedersachsen', 'NDRHamburg', 'extra3', 'NDRTalkShow', 'NDR2', 'DAS!imNDRFernsehen', 'NDRde', 'NDRNiedersachsen', 'NDRHamburg', 'extra3', 'NDRSchleswigHolstein', 'NDRde', 'NDRSport', 'DAS!imNDRFernsehen', 'NDR2', 'NJOY', 'NDRNiedersachsen', 'NDRHamburg', 'extra3', 'NDRTalkShow', 'NDRde', 'NDRSport', 'DAS!imNDRFernsehen', 'NDRNiedersachsen', 'NDRSchleswigHolstein', 'NDRHamburg', 'DAS!imNDRFernsehen', 'extra3', 'NDRde', 'NJOY', 'NDRSport', 'NJOY', 'NDRNiedersachsen', 'NDRHamburg', 'extra3', 'DAS!imNDRFernsehen', 'NDRSport', 'NDRde', 'NDRKultur', 'NJOY', 'NDRNiedersachsen', 'NDR2', 'NDRHamburg', 'NDRTalkShow', 'DAS!imNDRFernsehen', 'NDRFernsehen', 'extra3', 'NDR2', 'NDRNiedersachsen', 'NDRHamburg', 'NJOY', 'NDRde', 'NDRFernsehen', 'extra3', 'NDRSport'"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "profiles",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH monthly_engaged_users AS (\r\n  SELECT \r\n    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(profile,'-',''),' ',''),',',''),'ä','ae'),'Ä','Ae'),'ö','oe'),'Ö','Oe'),'ü','ue'),'Ü','Ue'),'.',''),'','') as profile, \r\n    SUM(page_engaged_users) AS engagedUsers,\r\n    EXTRACT(MONTH FROM time) AS month,\r\n  FROM `ndr-code-bi-dashboard.Quintly.facebookInsights` AS facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles \r\n    ON facebook.profileId = profiles.facebookID\r\n  WHERE profiles.LRA = \"$LRA\"\r\n    AND last_update IN (\r\n      SELECT MAX(last_update) \r\n      FROM `ndr-code-bi-dashboard.Quintly.facebookInsights` AS facebook\r\n      JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles \r\n        ON facebook.profileId = profiles.facebookID\r\n      WHERE profiles.LRA = \"$LRA\"\r\n    )\r\n    AND EXTRACT(DATE FROM time) >= DATE($Jahr - 2, $Monat, 1) \r\n    AND EXTRACT(DATE FROM time) <= LAST_DAY(DATE($Jahr, $Monat, 1), MONTH)\r\n  GROUP BY profile, month\r\n), top_profiles AS (\r\n  SELECT \r\n    month,\r\n    profile,\r\n    engagedUsers,\r\n    ROW_NUMBER() OVER (PARTITION BY month ORDER BY engagedUsers DESC) AS profile_rank\r\n  FROM monthly_engaged_users\r\n)\r\n  SELECT \r\n    STRING_AGG(CONCAT(\"'\", profile, \"'\"), ', ')\r\n  FROM top_profiles\r\n  WHERE profile_rank <= 8",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "'Rest', 'NDRRadiophilharmonie', 'WirsinddieFreeses', 'NDRaufmLand', 'DASimNDRFernsehen', 'NeuesausBuettenwarder', 'NDRTalkShow', 'EurovisionSongContest', 'NDRFernsehen'",
            "value": "'Rest', 'NDRRadiophilharmonie', 'WirsinddieFreeses', 'NDRaufmLand', 'DASimNDRFernsehen', 'NeuesausBuettenwarder', 'NDRTalkShow', 'EurovisionSongContest', 'NDRFernsehen'"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "query0",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH filter_month_profiles as (SELECT\r\n    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(profile,'-',''),' ',''),',',''),'ä','ae'),'Ä','Ae'),'ö','oe'),'Ö','Oe'),'ü','ue'),'Ü','Ue'),'.',''),'!',''),'&',''),\"'\",\"\"),'#',''),'🍀',''),'ß','ss') as profile, \r\n    SUM(page_engaged_users) AS engagedUsers,\r\n       CASE \"${Monat:text}\"\r\n      WHEN \"Jahr\" THEN \"year\"\r\n      ELSE CONCAT(EXTRACT(MONTH from time),'-',EXTRACT(YEAR from time)) \r\n      END\r\n    as month_year,\r\n  FROM `ndr-code-bi-dashboard.Quintly.facebookInsights` AS facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles \r\n    ON facebook.profileId = profiles.facebookID\r\n  WHERE profiles.LRA = \"$LRA\"\r\n  AND  $Zeitraum\r\n  GROUP BY profile, month_year), filter_month_top_profiles as (\r\n  SELECT \r\n    month_year,\r\n    profile,\r\n    engagedUsers,\r\n    ROW_NUMBER() OVER (PARTITION BY month_year ORDER BY engagedUsers DESC) AS profile_rank\r\n  FROM filter_month_profiles\r\n), filter_month_top_8_profiles AS (\r\n  SELECT \r\n    month_year,\r\n    profile,\r\n    engagedUsers\r\n  FROM filter_month_top_profiles\r\n  WHERE profile_rank <= 8 \r\n  ), filter_month_rest AS (\r\n  SELECT \r\n    month_year,\r\n    'Rest' AS profile,\r\n    SUM(engagedUsers) AS engagedUsers\r\n  FROM filter_month_top_profiles\r\n  WHERE profile_rank > 8\r\n  GROUP BY month_year\r\n), filter_month_top_8_rest_profiles AS (\r\n   SELECT \r\n    month_year,\r\n    profile,\r\n    engagedUsers\r\n  FROM filter_month_top_8_profiles\r\n  UNION ALL\r\n  SELECT \r\n    month_year,\r\n    profile,\r\n    engagedUsers\r\n  FROM filter_month_rest\r\n  ORDER BY month_year DESC, profile\r\n) SELECT STRING_AGG(DISTINCT CONCAT(\"'\", profile, \"'\"), ', ') FROM filter_month_top_8_rest_profiles\r\n",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "'NDRde', 'NDRMecklenburgVorpommern', 'NDRNiedersachsen', 'Rest', 'NJOY', 'NDRSport', 'NDRSchleswigHolstein', 'NDRFernsehen', 'NDRHamburg'",
            "value": "'NDRde', 'NDRMecklenburgVorpommern', 'NDRNiedersachsen', 'Rest', 'NJOY', 'NDRSport', 'NDRSchleswigHolstein', 'NDRFernsehen', 'NDRHamburg'"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "query1",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH filter_month_profiles as (SELECT\r\n    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(profile,'-',''),' ',''),',',''),'ä','ae'),'Ä','Ae'),'ö','oe'),'Ö','Oe'),'ü','ue'),'Ü','Ue'),'.',''),'!',''),'&',''),\"'\",\"\"),'#',''),'🍀',''),'ß','ss') as profile, \r\n    SUM(page_impressions_unique) AS impressionsUnique,\r\n       CASE \"${Monat:text}\"\r\n      WHEN \"Jahr\" THEN \"year\"\r\n      ELSE CONCAT(EXTRACT(MONTH from time),'-',EXTRACT(YEAR from time)) \r\n      END\r\n    as month_year,\r\n  FROM `ndr-code-bi-dashboard.Quintly.facebookInsights` AS facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles \r\n    ON facebook.profileId = profiles.facebookID\r\n  WHERE profiles.LRA = \"$LRA\"\r\n    AND $Zeitraum\r\n  GROUP BY profile, month_year), filter_month_top_profiles as (\r\n  SELECT \r\n    month_year,\r\n    profile,\r\n    impressionsUnique,\r\n    ROW_NUMBER() OVER (PARTITION BY month_year ORDER BY impressionsUnique DESC) AS profile_rank\r\n  FROM filter_month_profiles\r\n), filter_month_top_8_profiles AS (\r\n  SELECT \r\n    month_year,\r\n    profile,\r\n    impressionsUnique\r\n  FROM filter_month_top_profiles\r\n  WHERE profile_rank <= 8 \r\n  ), filter_month_rest AS (\r\n  SELECT \r\n    month_year,\r\n    'Rest' AS profile,\r\n    SUM(impressionsUnique) AS impressionsUnique\r\n  FROM filter_month_top_profiles\r\n  WHERE profile_rank > 8\r\n  GROUP BY month_year\r\n), filter_month_top_8_rest_profiles AS (\r\n   SELECT \r\n    month_year,\r\n    profile,\r\n    impressionsUnique\r\n  FROM filter_month_top_8_profiles\r\n  UNION ALL\r\n  SELECT \r\n    month_year,\r\n    profile,\r\n    impressionsUnique\r\n  FROM filter_month_rest\r\n  ORDER BY month_year DESC, profile\r\n) SELECT STRING_AGG(DISTINCT CONCAT(\"'\", profile, \"'\"), ', ') FROM filter_month_top_8_rest_profiles",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "'DASimNDRFernsehen', 'NDRRadiophilharmonie', 'WirsinddieFreeses', 'NDRTalkShow', 'NDRFernsehen', 'NDRaufmLand', 'EurovisionSongContest', 'NeuesausBuettenwarder'",
            "value": "'DASimNDRFernsehen', 'NDRRadiophilharmonie', 'WirsinddieFreeses', 'NDRTalkShow', 'NDRFernsehen', 'NDRaufmLand', 'EurovisionSongContest', 'NeuesausBuettenwarder'"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "top_8_profiles",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH filter_month_profiles as (\r\n  SELECT\r\n    REPLACE(\r\n      REPLACE(\r\n        REPLACE(\r\n          REPLACE(\r\n            REPLACE(\r\n              REPLACE(\r\n                REPLACE(\r\n                  REPLACE(\r\n                    REPLACE(\r\n                      REPLACE(\r\n                        REPLACE(\r\n                          REPLACE(\r\n                            REPLACE(\r\n                              REPLACE(REPLACE(REPLACE(profile, '-', ''), ' ', ''), ',', ''),\r\n                              'ä',\r\n                              'ae'\r\n                            ),\r\n                            'Ä',\r\n                            'Ae'\r\n                          ),\r\n                          'ö',\r\n                          'oe'\r\n                        ),\r\n                        'Ö',\r\n                        'Oe'\r\n                      ),\r\n                      'ü',\r\n                      'ue'\r\n                    ),\r\n                    'Ü',\r\n                    'Ue'\r\n                  ),\r\n                  '.',\r\n                  ''\r\n                ),\r\n                '!',\r\n                ''\r\n              ),\r\n              '&',\r\n              ''\r\n            ),\r\n            \"'\",\r\n            \"\"\r\n          ),\r\n          '#',\r\n          ''\r\n        ),\r\n        '🍀',\r\n        ''\r\n      ),\r\n      'ß',\r\n      'ss'\r\n    ) as profile,\r\n    SUM(page_engaged_users) AS engagedUsers,\r\n    FORMAT_DATE('%m-%Y', time) AS month_year\r\n  FROM\r\n    `ndr-code-bi-dashboard.Quintly.facebookInsights` AS facebook\r\n    JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles ON facebook.profileId = profiles.facebookID\r\n  WHERE\r\n    profiles.LRA = \"$LRA\"\r\n    AND $Zeitraum\r\n  GROUP BY\r\n    profile,\r\n    month_year\r\n),\r\nfilter_month_top_profiles as (\r\n  SELECT\r\n    month_year,\r\n    profile,\r\n    engagedUsers,\r\n    ROW_NUMBER() OVER (\r\n      PARTITION BY month_year\r\n      ORDER BY\r\n        engagedUsers DESC\r\n    ) AS profile_rank\r\n  FROM\r\n    filter_month_profiles\r\n)\r\nSELECT\r\n  STRING_AGG(DISTINCT CONCAT(\"'\", profile, \"'\"), ', ')\r\nFROM\r\n  filter_month_top_profiles\r\nWHERE\r\n  profile_rank <= 8",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "August",
            "value": "August"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "Month",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE $Monat\r\nWHEN 1 THEN \"Januar\"\r\nWHEN 2 THEN \"Februar\"\r\nWHEN 3 THEN \"März\"\r\nWHEN 4 THEN \"April\"\r\nWHEN 5 THEN \"Mai\"\r\nWHEN 6 THEN \"Juni\"\r\nWHEN 7 THEN \"Juli\"\r\nWHEN 8 THEN \"August\"\r\nWHEN 9 THEN \"September\"\r\nWHEN 10 THEN \"Oktober\"\r\nWHEN 11 THEN \"November\"\r\nWHEN 12 THEN \"Dezember\"\r\nWHEN 13 THEN \"\"\r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "'NDRFernsehen', 'NJOY', 'NDRSchleswigHolstein', 'NDRMecklenburgVorpommern', 'NDRNiedersachsen', 'NDRde', 'NDRHamburg', 'NDRSport'",
            "value": "'NDRFernsehen', 'NJOY', 'NDRSchleswigHolstein', 'NDRMecklenburgVorpommern', 'NDRNiedersachsen', 'NDRde', 'NDRHamburg', 'NDRSport'"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "top_8_profiles_impressionUnique",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH filter_month_profiles as (SELECT\r\n    REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(REPLACE(profile,'-',''),' ',''),',',''),'ä','ae'),'Ä','Ae'),'ö','oe'),'Ö','Oe'),'ü','ue'),'Ü','Ue'),'.',''),'!',''),'&',''),\"'\",\"\"),'#',''),'🍀',''),'ß','ss') as profile, \r\n    SUM(page_impressions_unique) AS impressionsUnique,\r\n    CONCAT(EXTRACT(MONTH from time),'-',EXTRACT(YEAR from time)) as month_year\r\n  FROM `ndr-code-bi-dashboard.Quintly.facebookInsights` AS facebook\r\n  JOIN `ndr-code-bi-dashboard.Quintly.profiles` AS profiles \r\n    ON facebook.profileId = profiles.facebookID\r\n  WHERE profiles.LRA = \"$LRA\"\r\n  AND   $Zeitraum\r\n  GROUP BY profile, month_year), filter_month_top_profiles as (\r\n  SELECT \r\n    month_year,\r\n    profile,\r\n    impressionsUnique,\r\n    ROW_NUMBER() OVER (PARTITION BY month_year ORDER BY impressionsUnique DESC) AS profile_rank\r\n  FROM filter_month_profiles\r\n)\r\nSELECT \r\n    STRING_AGG(DISTINCT CONCAT(\"'\", profile, \"'\"), ', ')\r\n  FROM filter_month_top_profiles\r\n  WHERE profile_rank <= 8",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "September",
            "value": "September"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "Month_1",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE $Monat\r\nWHEN 13 THEN \"Januar\"\r\nWHEN 12 THEN \"Januar\"\r\nWHEN 1 THEN \"Februar\"\r\nWHEN 2 THEN \"März\"\r\nWHEN 3 THEN \"April\"\r\nWHEN 4 THEN \"Mai\"\r\nWHEN 5 THEN \"Juni\"\r\nWHEN 6 THEN \"Juli\"\r\nWHEN 7 THEN \"August\"\r\nWHEN 8 THEN \"September\"\r\nWHEN 9 THEN \"Oktober\"\r\nWHEN 10 THEN \"November\"\r\nWHEN 11 THEN \"Dezember\"\r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "31",
            "value": "31"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "Day_number",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT \n      CASE \"$dataset_suffix\"\n      WHEN \"\" THEN CONCAT(EXTRACT(DAY FROM CURRENT_DATE),\".\",EXTRACT(MONTH FROM CURRENT_DATE))\n      ELSE\n       CAST(EXTRACT(DAY from LAST_DAY(DATE($Jahr,$Monat,1),MONTH)) AS STRING)\n       END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "Aug.",
            "value": "Aug."
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "Monat_abkuerzung",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE $Monat\r\nWHEN 1 THEN \"Jan.\"\r\nWHEN 2 THEN \"Feb.\"\r\nWHEN 3 THEN \"März\"\r\nWHEN 4 THEN \"Apr.\"\r\nWHEN 5 THEN \"Mai\"\r\nWHEN 6 THEN \"Juni\"\r\nWHEN 7 THEN \"Juli\"\r\nWHEN 8 THEN \"Aug.\"\r\nWHEN 9 THEN \"Sep.\"\r\nWHEN 10 THEN \"Okt.\"\r\nWHEN 11 THEN \"Nov.\"\r\nWHEN 12 THEN CASE \"${Monat:text}\" WHEN \"Jahr\" THEN \"Jahr\" ELSE \"Dez.\" END\r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "Juli",
            "value": "Juli"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "LastMonat_abkuerzung",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE EXTRACT(MONTH from DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH))\r\nWHEN 1 THEN \"Jan.\"\r\nWHEN 2 THEN \"Feb.\"\r\nWHEN 3 THEN \"März\"\r\nWHEN 4 THEN \"Apr.\"\r\nWHEN 5 THEN \"Mai\"\r\nWHEN 6 THEN \"Juni\"\r\nWHEN 7 THEN \"Juli\"\r\nWHEN 8 THEN \"Aug.\"\r\nWHEN 9 THEN \"Sep.\"\r\nWHEN 10 THEN \"Okt.\"\r\nWHEN 11 THEN \"Nov.\"\r\nWHEN 12 THEN \"Dez.\"\r\nWHEN 13 THEN \"\"\r\nEND\r\n",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "2023",
            "value": "2023"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "LastJahr",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CAST($Jahr - 1 AS STRING)",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "2024",
            "value": "2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "YearFromLastMonth",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CAST(EXTRACT(YEAR from DATE_SUB(DATE($Jahr,$Monat,1),INTERVAL 1 MONTH)) AS STRING)",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "Quintly_final_2024_8",
            "value": "Quintly_final_2024_8"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "dataset",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE\r\nWHEN $Monat = 13 AND CURRENT_DATE() < DATE($Jahr + 1, 1, 7) THEN \"Quintly\"\r\nWHEN $Jahr < 2021 THEN \"Quintly\"\r\nWHEN $Monat = 13 AND CURRENT_DATE() > DATE($Jahr, 1, 7) THEN CONCAT(\"Quintly_final_\",CAST($Jahr AS STRING))\r\nWHEN CURRENT_DATE() < DATE_ADD(DATE($Jahr,$Monat,8),INTERVAL 1 MONTH) THEN \"Quintly\"\r\nWHEN LAST_DAY(DATE($Jahr,$Monat,1)) <= DATE(2023,12,31) THEN \"Quintly\"\r\nELSE CONCAT(\"Quintly_final_\",CAST($Jahr AS STRING),\"_\", CAST($Monat AS STRING)) END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "EXTRACT(MONTH from time) = 8 AND EXTRACT(YEAR from time) = 2024",
            "value": "EXTRACT(MONTH from time) = 8 AND EXTRACT(YEAR from time) = 2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "Zeitraum",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT \n    CASE \"${Monat:text}\"\n    WHEN \"Jahr\" THEN \"EXTRACT(YEAR FROM time) = $Jahr\"\n    ELSE \"EXTRACT(MONTH from time) = $Monat AND EXTRACT(YEAR from time) = $Jahr\"\n    END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "Vormonat ",
            "value": "Vormonat "
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "Vormonat",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "   SELECT CASE \"${Monat:text}\"\n      WHEN \"Jahr\" THEN \"Vorjahr\"\n      ELSE \"Vormonat \"\n      END\n    as month_year",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "07. September 2024",
            "value": "07. September 2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "Datenstand",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE \"$dataset_suffix\"\n            WHEN \"\" THEN CAST(CURRENT_DATE() as STRING)\n            ELSE \"07. ${Month_1} ${Jahr}\"\n            END\n",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "## Juli  \n ## 2024",
            "value": "## Juli  \n ## 2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "Vergleich",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE \"$dataset_suffix\"\n            WHEN \"\" THEN \"## Vormonat\"\n            ELSE \"## $LastMonat_abkuerzung  \\n ## $YearFromLastMonth\"\n            END\n",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "31.8.2024",
            "value": "31.8.2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "Stichtag",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH max_time AS (SELECT MAX(time) as time FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\n            WHERE $Zeitraum AND page_follows IS not null)\nSELECT CONCAT(EXTRACT(DAY FROM time),\".\", EXTRACT(MONTH FROM time),\".\", EXTRACT(YEAR FROM time)) FROM max_time",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "0",
            "value": "0"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "number_of_days_year_2024",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"COUNT(distinct EXTRACT (DATE from time))\" \r\nELSE \"0\"\r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "Quintly_final_2024_8",
            "value": "Quintly_final_2024_8"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "comp_dataset",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE\r\nWHEN $Monat = 13 AND CURRENT_DATE() < DATE($Jahr + 1, 1, 7) THEN \"Quintly\"\r\nWHEN $Jahr < 2023 THEN \"Quintly\"\r\nWHEN $Monat = 13 AND CURRENT_DATE() > DATE($Jahr, 1, 7) THEN CONCAT(\"Quintly_final_\",CAST($Jahr -1 AS STRING))\r\nWHEN CURRENT_DATE() < DATE_ADD(DATE($Jahr,$Monat,8),INTERVAL 1 MONTH) THEN \"Quintly\"\r\nWHEN LAST_DAY(DATE($Jahr,$Monat,1)) <= DATE(2023,12,31) THEN \"Quintly\"\r\nELSE CONCAT(\"Quintly_final_\",CAST($Jahr AS STRING),\"_\", CAST($Monat AS STRING)) END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "07.7.2024",
            "value": "07.7.2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "stichtagmonat",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE \r\nWHEN ($Monat = 13 AND DATE($Jahr+1, 1, 7) > CURRENT_DATE()) THEN FORMAT_DATE('%d.%m.%Y', CURRENT_DATE())\r\nWHEN $Monat = 13 THEN CONCAT(\"07.01.\",CAST($Jahr+1 AS STRING))\r\nWHEN DATE_ADD(DATE($Jahr,$Monat,7), INTERVAL 1 MONTH) > CURRENT_DATE() THEN FORMAT_DATE('%d.%m.%Y', CURRENT_DATE())\r\nELSE \r\nCASE $Monat\r\nWHEN 12 THEN CONCAT(\"07.01.\",CAST($Jahr+1 AS STRING))\r\nELSE PARSE_DATE('%d.%m.%Y', CONCAT('07.', LPAD(CAST($Monat + 1 AS STRING), 2, '0'), '.', CAST($Jahr AS STRING)))\r\nEND",
            "refId": "tempvar",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "31",
            "value": "31"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "number_of_days_last_month",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE $Monat\r\nWHEN 13 THEN CAST(1 AS STRING)\r\nELSE CAST(EXTRACT(DAY FROM LAST_DAY(DATE_SUB(DATE($Jahr,$Monat,1),INTERVAL 1 MONTH),MONTH)) AS STRING) END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "31",
            "value": "31"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "number_of_days",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CAST(number_of_days AS STRING) FROM( \r\nSELECT CASE\r\n\"${Monat:text}\"\r\nWHEN \"Jahr\" THEN (DATE_DIFF(LAST_DAY(DATE($Jahr,12,31),MONTH),DATE($Jahr,1,1),DAY) + 1)\r\nELSE EXTRACT(DAY FROM LAST_DAY(DATE($Jahr,$Monat,1),MONTH)) END AS number_of_days)",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "31.8.2024",
            "value": "31.8.2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "stichtag_follower",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "WITH max_time AS (SELECT MAX(time) as time FROM `ndr-code-bi-dashboard.Quintly${dataset_suffix}.facebookInsights${table_suffix}` as facebook\n            WHERE $Zeitraum AND page_follows IS not null AND page_follows >1000)\nSELECT CONCAT(EXTRACT(DAY FROM time),\".\", EXTRACT(MONTH FROM time),\".\", EXTRACT(YEAR FROM time)) FROM max_time",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger,0))",
            "value": "sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger,0))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "reactions",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr < 2024 THEN \"SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))\"\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))\"\r\nWHEN $Monat = 13 AND $Jahr > 2024 THEN \"sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger,0))\"\r\nWHEN DATE($Jahr,$Monat,1) < DATE(2024,4,1) THEN \"SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))\"\r\nELSE \"sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger,0))\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(IFNULL(post_activity_by_action_type_comment, 0))",
            "value": "SUM(IFNULL(post_activity_by_action_type_comment, 0))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "comments",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr < 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_comment, 0))\"\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_comment, 0))\"\r\nWHEN $Monat = 13 AND $Jahr > 2024 THEN \"SUM(IFNULL(post_activity_by_action_type_comment, 0))\" \r\nWHEN DATE($Jahr,$Monat,1) < DATE(2024,4,1) THEN \"SUM(IFNULL(page_positive_feedback_by_type_comment, 0))\"\r\nELSE \"SUM(IFNULL(post_activity_by_action_type_comment, 0))\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(IFNULL(post_activity_by_action_type_share, 0))",
            "value": "SUM(IFNULL(post_activity_by_action_type_share, 0))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "shares",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr < 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_link, 0))\"\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_link, 0))\"\r\nWHEN $Monat = 13 AND $Jahr > 2024 THEN \"SUM(IFNULL(post_activity_by_action_type_share, 0))\" \r\nWHEN DATE($Jahr,$Monat,1) < DATE(2024,4,1) THEN \"SUM(IFNULL(page_positive_feedback_by_type_link, 0))\"\r\nELSE \"SUM(IFNULL(post_activity_by_action_type_share, 0))\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "facebookInsightsOwnPosts",
            "value": "facebookInsightsOwnPosts"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "interaction_dataset",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr < 2024 THEN \"facebookInsights\"\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"facebookInsights\"\r\nWHEN $Monat = 13 AND $Jahr > 2024 THEN \"facebookInsightsOwnPosts\"\r\nWHEN DATE($Jahr,$Monat,1) < DATE(2024,4,1) THEN \"facebookInsights\"\r\nELSE \"facebookInsightsOwnPosts\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger,0))",
            "value": "sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger,0))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "reactions_last_month",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))\"\r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH) < DATE(2024,4,1) THEN \"SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))\"\r\nELSE \"sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger,0))\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(IFNULL(post_activity_by_action_type_comment, 0))",
            "value": "SUM(IFNULL(post_activity_by_action_type_comment, 0))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "comments_last_month",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_comment, 0))\"\r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH) < DATE(2024,4,1) THEN \"SUM(IFNULL(page_positive_feedback_by_type_comment, 0))\"\r\nELSE \"SUM(IFNULL(post_activity_by_action_type_comment, 0))\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(IFNULL(post_activity_by_action_type_share, 0))",
            "value": "SUM(IFNULL(post_activity_by_action_type_share, 0))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "shares_last_month",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_link, 0))\"\r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH) < DATE(2024,4,1) THEN \"SUM(IFNULL(page_positive_feedback_by_type_link, 0))\"\r\nELSE \"SUM(IFNULL(post_activity_by_action_type_share, 0))\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "facebookInsightsOwnPosts",
            "value": "facebookInsightsOwnPosts"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "interaction_dataset_last_month",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"facebookInsights\"\r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH) < DATE(2024,4,1) THEN \"facebookInsights\"\r\nELSE \"facebookInsightsOwnPosts\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))",
            "value": "SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "reactions_last_year",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND ($Jahr - 1) < 2024 THEN \"SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) = 2024 THEN \"SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) > 2024 THEN \"sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger ,0))\" \r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 YEAR) < DATE(2024,4,1) THEN \"SUM(IFNULL(page_actions_post_reactions_total_like + page_actions_post_reactions_total_love + page_actions_post_reactions_total_wow + page_actions_post_reactions_total_haha + page_actions_post_reactions_total_sorry + page_actions_post_reactions_total_anger,0))\"\r\nELSE \"sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger,0))\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(IFNULL(page_positive_feedback_by_type_comment, 0))",
            "value": "SUM(IFNULL(page_positive_feedback_by_type_comment, 0))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "comments_last_year",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND ($Jahr - 1) < 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_comment, 0))\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) = 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_comment, 0))\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) > 2024 THEN \"SUM(IFNULL(post_activity_by_action_type_comment, 0))\"\r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 YEAR) < DATE(2024,4,1) THEN \"SUM(IFNULL(page_positive_feedback_by_type_comment, 0))\"\r\nELSE \"SUM(IFNULL(post_activity_by_action_type_comment, 0))\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(IFNULL(page_positive_feedback_by_type_link, 0))",
            "value": "SUM(IFNULL(page_positive_feedback_by_type_link, 0))"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "shares_last_year",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND ($Jahr - 1) < 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_link, 0))\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) = 2024 THEN \"SUM(IFNULL(page_positive_feedback_by_type_link, 0))\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) > 2024 THEN \"SUM(IFNULL(post_activity_by_action_type_share, 0))\" \r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 YEAR) < DATE(2024,4,1) THEN \"SUM(IFNULL(page_positive_feedback_by_type_link, 0))\"\r\nELSE \"SUM(IFNULL(post_activity_by_action_type_share, 0))\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "facebookInsights",
            "value": "facebookInsights"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "interaction_dataset_last_year",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND ($Jahr - 1) < 2024 THEN \"facebookInsights\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) = 2024 THEN \"facebookInsights\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) > 2024 THEN \"facebookInsightsOwnPosts\"\r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 YEAR) < DATE(2024,4,1) THEN \"facebookInsights\"\r\nELSE \"facebookInsightsOwnPosts\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "EXTRACT(MONTH from time) = 8 AND EXTRACT(YEAR from time) = 2024",
            "value": "EXTRACT(MONTH from time) = 8 AND EXTRACT(YEAR from time) = 2024"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "interaction_Zeitraum",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\n    WHEN $Monat = 13 AND $Jahr = 2024 THEN \"EXTRACT(MONTH from time) >= 1 AND EXTRACT(MONTH from time) <= 3 AND EXTRACT(YEAR from time) = $Jahr\"\n    WHEN $Monat = 13 THEN \"EXTRACT(YEAR FROM time) = $Jahr\"\n    ELSE \"EXTRACT(MONTH from time) = $Monat AND EXTRACT(YEAR from time) = $Jahr\"\n    END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "0",
            "value": "0"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "reactions_year_2024",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"sum(IFNULL(post_reactions_by_type_total_like\t+ post_reactions_by_type_total_love\t+ post_reactions_by_type_total_wow + post_reactions_by_type_total_haha + post_reactions_by_type_total_sorry\t+ post_reactions_by_type_total_anger ,0))\" \r\nELSE \"0\"\r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "0",
            "value": "0"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "comments_year_2024",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(IFNULL(post_activity_by_action_type_comment, 0))\" \r\nELSE \"0\"\r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "0",
            "value": "0"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "shares_year_2024",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(IFNULL(post_activity_by_action_type_share, 0))\" \r\nELSE \"0\"\r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "EXTRACT(MONTH from time) = 8 AND EXTRACT(YEAR from time) = (2024 - 1)",
            "value": "EXTRACT(MONTH from time) = 8 AND EXTRACT(YEAR from time) = (2024 - 1)"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "interaction_last_year_Zeitraum",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\n    WHEN $Monat = 13 AND ($Jahr-1) = 2024 THEN \"EXTRACT(MONTH from time) >= 1 AND EXTRACT(MONTH from time) <= 3 AND EXTRACT(YEAR from time) = ($Jahr - 1)\"\n    WHEN $Monat = 13 THEN \"EXTRACT(YEAR FROM time) = ($Jahr - 1)\"\n    ELSE \"EXTRACT(MONTH from time) = $Monat AND EXTRACT(YEAR from time) = ($Jahr - 1)\"\n    END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "COUNT(DISTINCT externalId)",
            "value": "COUNT(DISTINCT externalId)"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_post_or_day",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr < 2024 THEN \"COUNT(facebook.time)\"\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"COUNT(facebook.time)\"\r\nWHEN $Monat = 13 AND $Jahr > 2024 THEN \"COUNT(DISTINCT externalId)\" \r\nWHEN DATE($Jahr,$Monat,1) < DATE(2024,4,1) THEN \"COUNT(facebook.time)\"\r\nELSE \"COUNT(DISTINCT externalId)\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "0",
            "value": "0"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_year_2024",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"COUNT(DISTINCT externalId)\"\r\nELSE \"0\"\r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "post_impressions_unique IS NOT NULL",
            "value": "post_impressions_unique IS NOT NULL"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_condition",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr < 2024 THEN \"page_follows IS NOT NULL\"\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"page_follows IS NOT NULL\"\r\nWHEN $Monat = 13 AND $Jahr > 2024 THEN \"post_impressions_unique IS NOT NULL\" \r\nWHEN DATE($Jahr,$Monat,1) < DATE(2024,4,1) THEN \"page_follows IS NOT NULL\"\r\nELSE \"post_impressions_unique IS NOT NULL\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "pro Post",
            "value": "pro Post"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "post_or_tag",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr < 2024 THEN \"pro Tag\"\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"\"\r\nWHEN $Monat = 13 AND $Jahr > 2024 THEN \"pro Post\" \r\nWHEN DATE($Jahr,$Monat,1) < DATE(2024,4,1) THEN \"pro Tag\"\r\nELSE \"pro Post\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(post_engaged_users)",
            "value": "SUM(post_engaged_users)"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_record",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr < 2024 THEN \"SUM(page_engaged_users)\"\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(page_engaged_users)\"\r\nWHEN $Monat = 13 AND $Jahr > 2024 THEN \"SUM(post_engaged_users)\" \r\nWHEN DATE($Jahr,$Monat,1) < DATE(2024,4,1) THEN \"SUM(page_engaged_users)\"\r\nELSE \"SUM(post_engaged_users)\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "0",
            "value": "0"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_record_year_2024",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(post_engaged_users)\"\r\nELSE \"0\"\r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "interactions_last_month",
            "value": "interactions_last_month"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "zusammenfassung_dataset",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 THEN \"interactions_year\"\r\nELSE \"interactions_last_month\" END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(post_engaged_users)",
            "value": "SUM(post_engaged_users)"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_record_last_month",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"SUM(page_engaged_users)\" \r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH) < DATE(2024,4,1) THEN \"SUM(page_engaged_users)\"\r\nELSE \"SUM(post_engaged_users)\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "post_impressions_unique IS NOT NULL",
            "value": "post_impressions_unique IS NOT NULL"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_condition_last_month",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"page_follows IS NOT NULL\"\r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH) < DATE(2024,4,1) THEN \"page_follows IS NOT NULL\"\r\nELSE \"post_impressions_unique IS NOT NULL\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "COUNT(DISTINCT externalId)",
            "value": "COUNT(DISTINCT externalId)"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_post_or_day_last_month",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND $Jahr = 2024 THEN \"COUNT(facebook.time)\" \r\nWHEN DATE_SUB(DATE($Jahr,$Monat,1), INTERVAL 1 MONTH) < DATE(2024,4,1) THEN \"COUNT(facebook.time)\"\r\nELSE \"COUNT(DISTINCT externalId)\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "SUM(page_engaged_users)",
            "value": "SUM(page_engaged_users)"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_record_last_year",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND ($Jahr-1) < 2024 THEN \"SUM(page_engaged_users)\"\r\nWHEN $Monat = 13 AND ($Jahr-1) = 2024 THEN \"SUM(page_engaged_users)\"\r\nWHEN $Monat = 13 AND ($Jahr-1) > 2024 THEN \"SUM(post_engaged_users)\" \r\nWHEN DATE($Jahr-1,$Monat,1) < DATE(2024,4,1) THEN \"SUM(page_engaged_users)\"\r\nELSE \"SUM(post_engaged_users)\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "COUNT(facebook.time)",
            "value": "COUNT(facebook.time)"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_post_or_day_last_year",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND ($Jahr-1) < 2024 THEN \"COUNT(facebook.time)\"\r\nWHEN $Monat = 13 AND ($Jahr-1) = 2024 THEN \"COUNT(facebook.time)\"\r\nWHEN $Monat = 13 AND ($Jahr-1) > 2024 THEN \"COUNT(DISTINCT externalId)\" \r\nWHEN DATE($Jahr-1,$Monat,1) < DATE(2024,4,1) THEN \"COUNT(facebook.time)\"\r\nELSE \"COUNT(DISTINCT externalId)\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "page_follows IS NOT NULL",
            "value": "page_follows IS NOT NULL"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "aktive_nutzer_condition_last_year",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 AND ($Jahr - 1) < 2024 THEN \"page_follows IS NOT NULL\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) = 2024 THEN \"page_follows IS NOT NULL\"\r\nWHEN $Monat = 13 AND ($Jahr - 1) > 2024 THEN \"post_impressions_unique IS NOT NULL\" \r\nWHEN DATE($Jahr-1,$Monat,1) < DATE(2024,4,1) THEN \"page_follows IS NOT NULL\"\r\nELSE \"post_impressions_unique IS NOT NULL\" \r\nEND",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "aktive_nutzer_last_month",
            "value": "aktive_nutzer_last_month"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "zusammenfassung_dataset_aktive_nutzer",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT CASE\r\nWHEN $Monat = 13 THEN \"aktive_nutzer_year\"\r\nELSE \"aktive_nutzer_last_month\" END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "_final_2024_8",
            "value": "_final_2024_8"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "table_suffix",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE\r\nWHEN $Monat = 13 AND CURRENT_DATE() < DATE($Jahr + 1, 1, 7) THEN \"\"\r\nWHEN $Jahr < 2021 THEN \"\"\r\nWHEN $Monat = 13 AND CURRENT_DATE() > DATE($Jahr, 1, 7) THEN CONCAT(\"_final_\",CAST($Jahr AS STRING))\r\nWHEN CURRENT_DATE() < DATE_ADD(DATE($Jahr,$Monat,8),INTERVAL 1 MONTH) THEN \"\"\r\nWHEN LAST_DAY(DATE($Jahr,$Monat,1)) <= DATE(2023,12,31) THEN \"\"\r\nELSE CONCAT(\"_final_\",CAST($Jahr AS STRING),\"_\", CAST($Monat AS STRING)) END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "_frozen",
            "value": "_frozen"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "dataset_suffix",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE\r\nWHEN $Monat = 13 AND CURRENT_DATE() < DATE($Jahr + 1, 1, 7) THEN \"\"\r\nWHEN $Jahr < 2021 THEN \"\"\r\nWHEN $Monat = 13 AND CURRENT_DATE() > DATE($Jahr, 1, 7) THEN \"_frozen\"\r\nWHEN CURRENT_DATE() < DATE_ADD(DATE($Jahr,$Monat,8),INTERVAL 1 MONTH) THEN \"\"\r\nWHEN LAST_DAY(DATE($Jahr,$Monat,1)) <= DATE(2023,12,31) THEN \"\"\r\nELSE \"_frozen\" END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "_final_2024_8",
            "value": "_final_2024_8"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "comp_table_suffix",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE\r\nWHEN $Monat = 13 AND CURRENT_DATE() < DATE($Jahr + 1, 1, 7) THEN \"\"\r\nWHEN $Jahr < 2023 THEN \"\"\r\nWHEN $Monat = 13 AND CURRENT_DATE() > DATE($Jahr, 1, 7) THEN CONCAT(\"_final_\",CAST($Jahr -1 AS STRING))\r\nWHEN CURRENT_DATE() < DATE_ADD(DATE($Jahr,$Monat,8),INTERVAL 1 MONTH) THEN \"\"\r\nWHEN LAST_DAY(DATE($Jahr,$Monat,1)) <= DATE(2023,12,31) THEN \"\"\r\nELSE CONCAT(\"_final_\",CAST($Jahr AS STRING),\"_\", CAST($Monat AS STRING)) END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        },
        {
          "current": {
            "selected": false,
            "text": "_frozen",
            "value": "_frozen"
          },
          "datasource": {
            "type": "grafana-bigquery-datasource",
            "uid": "qUaUqEk4k"
          },
          "definition": "",
          "hide": 2,
          "includeAll": false,
          "multi": false,
          "name": "comp_dataset_suffix",
          "options": [],
          "query": {
            "editorMode": "code",
            "format": 1,
            "location": "europe-west3",
            "project": "ndr-code-bi-dashboard",
            "rawQuery": true,
            "rawSql": "SELECT\r\nCASE\r\nWHEN $Monat = 13 AND CURRENT_DATE() < DATE($Jahr + 1, 1, 7) THEN \"\"\r\nWHEN $Jahr < 2023 THEN \"\"\r\nWHEN $Monat = 13 AND CURRENT_DATE() > DATE($Jahr, 1, 7) THEN \"_frozen\"\r\nWHEN CURRENT_DATE() < DATE_ADD(DATE($Jahr,$Monat,8),INTERVAL 1 MONTH) THEN \"\"\r\nWHEN LAST_DAY(DATE($Jahr,$Monat,1)) <= DATE(2023,12,31) THEN \"\"\r\nELSE \"_frozen\" END",
            "sql": {
              "columns": [
                {
                  "parameters": [],
                  "type": "function"
                }
              ],
              "groupBy": [
                {
                  "property": {
                    "type": "string"
                  },
                  "type": "groupBy"
                }
              ],
              "limit": 50
            }
          },
          "refresh": 1,
          "regex": "",
          "skipUrlSync": true,
          "sort": 0,
          "type": "query"
        }
      ]
    },
    "time": {
      "from": "now-6h",
      "to": "now"
    },
    "timepicker": {
      "hidden": true
    },
    "timezone": "",
    "title": "Social Media Report Facebook",
    "uid": "GvktNpPIz",
    "version": 14,
    "weekStart": ""
  }
}
